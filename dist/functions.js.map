{"version":3,"file":"functions.js","mappings":"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","sources":["webpack://excel-custom-functions/./src/api/types.ts","webpack://excel-custom-functions/./src/api/agents.ts","webpack://excel-custom-functions/./src/utils/logger.ts","webpack://excel-custom-functions/./src/api/format.ts","webpack://excel-custom-functions/./src/api/octagonApi.ts","webpack://excel-custom-functions/./src/functions/functions.ts"],"sourcesContent":["/**\n * Octagon API TypeScript Interfaces\n * These interfaces define the contract between our Excel Add-in and the Octagon API.\n */\n\n// ==================== COMMON API TYPES ====================\n\n// Common API response structure\nexport interface ApiResponse<T> {\n  success: boolean;\n  data?: T;\n  error?: string;\n}\n\n// ==================== OPENAI COMPATIBLE TYPES ====================\n\n// OpenAI-style message structure\nexport interface ChatMessage {\n  role: \"system\" | \"user\" | \"assistant\";\n  content: string;\n}\n\n// OpenAI-style choice structure\nexport interface StreamChoice {\n  index: number;\n  message: ChatMessage;\n  finish_reason: \"stop\" | \"length\" | \"function_call\" | \"content_filter\" | null;\n}\n\n// OpenAI-style usage statistics\nexport interface StreamUsage {\n  prompt_tokens: number;\n  completion_tokens: number;\n  total_tokens: number;\n}\n\n// OpenAI-style responses endpoint response\nexport interface StreamResponse {\n  id: string;\n  object: \"responses\";\n  created: number;\n  model: string;\n  choices: StreamChoice[];\n  usage?: StreamUsage;\n  // Adding new fields for Octagon specific response structure\n  content?: string;\n  output?: any[];\n  rawResponse?: any;\n  status?: string;\n  text?: any;\n}\n\n// ==================== AGENT TYPES ====================\n\nexport enum AgentType {\n  OctagonAgent = \"octagon-agent\",\n}\n\n// ==================== REQUEST/RESPONSE TYPES ====================\n\nexport interface AgentRequest {\n  model: string;\n  input: string;\n  max_tokens?: number;\n  text?: { format: { type: string } };\n}\n\n// Detailed agent response with content and structured data\nexport interface AgentResponse {\n  content: string;\n  // Additional fields that might be in the Octagon API response\n  model?: string;\n  created?: number;\n  id?: string;\n  [key: string]: any; // Allow for additional unknown properties\n}\n\n// ==================== UTILITY TYPES ====================\n\n// Type aliases for common data structures\nexport type Option<T = string> = { value: T; label: string };\nexport type Maybe<T> = T | null | undefined;\n\nexport type OutputFormat = \"raw\" | \"table\" | \"cell\";\n\n// ==================== EXCEL INTEGRATION TYPES ====================\n\n// Excel table formatting options\nexport interface ExcelTableOptions {\n  hasHeaders?: boolean;\n  showTotals?: boolean;\n  tableName?: string;\n  tableStyle?: string;\n}\n\n// Excel insertion result\nexport interface ExcelInsertionResult {\n  success: boolean;\n  rowsInserted: number;\n  columnsInserted: number;\n  range?: string;\n  error?: string;\n}\n\n// ==================== ERROR HANDLING TYPES ====================\n\n// Standardized error response\nexport interface ErrorResponse {\n  error: {\n    code: string;\n    message: string;\n    type: \"api_error\" | \"rate_limit_exceeded\" | \"invalid_request\" | \"authentication_error\";\n    param?: string;\n  };\n}\n","/**\n * Octagon API Agents Definitions\n * These interfaces define the available agents in Excel Add-in\n */\n\nimport { AgentType } from \"./types\";\n\ninterface AgentInfo {\n  id: AgentType;\n  displayName: string;\n  excelFormulaName: string;\n  description: string;\n  category: AgentCategory;\n  examplePrompt?: string;\n  usageExamples?: UsageExample[];\n}\n\ninterface UsageExample {\n  topic: string;\n  prompt: string;\n}\n\nenum AgentCategory {\n  MarketIntelligence = \"Market Intelligence\",\n}\n\nexport const OCTAGON_AGENTS: AgentInfo[] = [\n  {\n    id: AgentType.OctagonAgent,\n    displayName: \"Octagon Agent\",\n    excelFormulaName: \"OCTAGON.AGENT\",\n    description:\n      \"Public and Private market intelligence agent that optimally routes requests to appropriate specialized agents\",\n    category: AgentCategory.MarketIntelligence,\n    usageExamples: [\n      {\n        topic: \"Financial Metrics Analysis\",\n        prompt:\n          '=OCTAGON.AGENT(\"Retrieve year-over-year growth in key income-statement items for AAPL, limited to 5 records and filtered by period FY.\")',\n      },\n      {\n        topic: \"SEC Filing Analysis\",\n        prompt:\n          '=OCTAGON.AGENT(\"Analyze the latest 10-K filing for AAPL and extract key financial metrics and risk factors.\")',\n      },\n      {\n        topic: \"Stock Performance\",\n        prompt:\n          '=OCTAGON.AGENT(\"Retrieve the daily closing prices for AAPL over the last 30 days.\")',\n      },\n      {\n        topic: \"Earnings Call Insights\",\n        prompt:\n          '=OCTAGON.AGENT(\"Analyze AAPL\\'s latest earnings call transcript and extract key insights about future guidance.\")',\n      },\n      {\n        topic: \"Company Overview\",\n        prompt:\n          '=OCTAGON.AGENT(\"Provide a comprehensive overview of Stripe, including its business model and key metrics.\")',\n      },\n      {\n        topic: \"Funding History\",\n        prompt:\n          '=OCTAGON.AGENT(\"Retrieve the funding history for Stripe, including all rounds and investors.\")',\n      },\n      {\n        topic: \"M&A Activity\",\n        prompt: '=OCTAGON.AGENT(\"List all M&A transactions involving Stripe in the last 2 years.\")',\n      },\n      {\n        topic: \"Investor Profile\",\n        prompt:\n          '=OCTAGON.AGENT(\"Provide a detailed profile of Sequoia Capital\\'s investment strategy and portfolio.\")',\n      },\n      {\n        topic: \"Debt Analysis\",\n        prompt:\n          '=OCTAGON.AGENT(\"Analyze Stripe\\'s debt financing history and current debt structure.\")',\n      },\n      {\n        topic: \"Institutional Holdings\",\n        prompt:\n          '=OCTAGON.AGENT(\"Retrieve the most recent Form 13F and related filings submitted by institutional investors.\")',\n      },\n    ],\n  },\n];\n","/**\n * Logging utility for Octagon Excel Add-in\n * This module provides centralized logging functionality with different log levels\n * to help debug issues during development and production.\n */\n\n// Log levels\nexport enum LogLevel {\n  DEBUG = 'DEBUG',\n  INFO = 'INFO',\n  WARN = 'WARN',\n  ERROR = 'ERROR'\n}\n\n// Current log level - can be adjusted based on environment\nlet currentLogLevel: LogLevel = \n  process.env.NODE_ENV === 'production' ? LogLevel.ERROR : LogLevel.DEBUG;\n\n// Log level priority (used to determine if a message should be logged)\nconst logLevelPriority: Record<LogLevel, number> = {\n  [LogLevel.DEBUG]: 0,\n  [LogLevel.INFO]: 1,\n  [LogLevel.WARN]: 2,\n  [LogLevel.ERROR]: 3\n};\n\n/**\n * Main logging function that handles all log levels\n */\nexport function log(level: LogLevel, message: string, data?: any): void {\n  // Only log if the current level priority is less than or equal to the message level\n  if (logLevelPriority[level] >= logLevelPriority[currentLogLevel]) {\n    const timestamp = new Date().toISOString();\n    const formattedMessage = `[${timestamp}] [${level}] ${message}`;\n\n    switch (level) {\n      case LogLevel.DEBUG:\n        console.debug(formattedMessage, data || '');\n        break;\n      case LogLevel.INFO:\n        console.info(formattedMessage, data || '');\n        break;\n      case LogLevel.WARN:\n        console.warn(formattedMessage, data || '');\n        break;\n      case LogLevel.ERROR:\n        console.error(formattedMessage, data || '');\n        break;\n    }\n  }\n}\n\n/**\n * Set the current log level\n */\nexport function setLogLevel(level: LogLevel): void {\n  currentLogLevel = level;\n  log(LogLevel.INFO, `Log level set to ${level}`);\n}\n\n/**\n * Get all logs stored in session storage\n */\nexport function getLogs(): any[] {\n  try {\n    return JSON.parse(sessionStorage.getItem('octagon_logs') || '[]');\n  } catch (e) {\n    console.error('[Logger] Error retrieving logs from sessionStorage:', e);\n    return [];\n  }\n}\n\n/**\n * Clear all logs in session storage\n */\nexport function clearLogs(): void {\n  try {\n    sessionStorage.removeItem('octagon_logs');\n  } catch (e) {\n    // Log the error instead of silently failing\n    console.error('[Logger] Error clearing logs from sessionStorage:', e);\n  }\n}\n\n// Convenience methods for each log level\nexport const debug = (message: string, data?: any) => log(LogLevel.DEBUG, message, data);\nexport const info = (message: string, data?: any) => log(LogLevel.INFO, message, data);\nexport const warn = (message: string, data?: any) => log(LogLevel.WARN, message, data);\nexport const error = (message: string, data?: any) => log(LogLevel.ERROR, message, data);\n\n// Export a default logger object\nexport default {\n  debug,\n  info,\n  warn,\n  error,\n  setLogLevel,\n  getLogs,\n  clearLogs\n};","import Logger from \"../utils/logger\";\nimport type { OutputFormat } from \"./types\";\n\nconst RAW_TEXT = {\n  format: { type: \"text\" },\n};\n\nconst TABLE_FORMAT = {\n  format: {\n    type: \"json_schema\",\n    strict: true,\n    name: \"TableFormat\",\n    schema: {\n      properties: {\n        data: {\n          description:\n            \"Nested list of values for multiple spreadsheet cells. Outer list represents rows, inner list represents columns. Each element in the inner list is a cell value.\",\n          items: { items: { anyOf: [{ type: \"number\" }, { type: \"string\" }] }, type: \"array\" },\n          type: \"array\",\n        },\n      },\n      required: [\"data\"],\n      title: \"ExcelFormat\",\n      type: \"object\",\n      additionalProperties: false,\n    },\n  },\n};\n\nconst SINGLE_CELL_FORMAT = {\n  format: {\n    type: \"json_schema\",\n    strict: true,\n    name: \"SingleCellFormat\",\n    schema: {\n      properties: {\n        data: {\n          anyOf: [{ type: \"number\" }, { type: \"string\" }],\n          description: \"Single value of a spreadsheet cell\",\n          title: \"Data\",\n        },\n      },\n      required: [\"data\"],\n      title: \"ExcelCell\",\n      type: \"object\",\n      additionalProperties: false,\n    },\n  },\n};\n\nconst formatMap: Record<OutputFormat, { format: { type: string } }> = {\n  raw: RAW_TEXT,\n  table: TABLE_FORMAT,\n  cell: SINGLE_CELL_FORMAT,\n};\n\nexport function getTextFormat(format: string): { format: { type: string } } {\n  const textFormat = formatMap[format];\n  if (!textFormat) {\n    Logger.error(`Invalid format: ${format}`);\n    throw new CustomFunctions.Error(\n      CustomFunctions.ErrorCode.invalidValue,\n      'Invalid format. Please use \"raw\", \"table\", or \"cell\"'\n    );\n  }\n\n  return textFormat;\n}\n\nexport function parseTextFormat(\n  content: string,\n  format: OutputFormat\n): Array<Array<string | number>> {\n  // Default response is a single row with a single cell containing \"No response content\"\n  const defaultResponse = [[\"No response content\"]];\n\n  try {\n    if (format == \"table\") {\n      return JSON.parse(content).data ?? defaultResponse;\n    } else if (format == \"cell\") {\n      const data = JSON.parse(content).data;\n      return data !== undefined ? [[data]] : defaultResponse;\n    } else {\n      return [[content]];\n    }\n  } catch (error) {\n    // Fallback if content is not valid JSON for table and single cell format\n    Logger.error(\"Error parsing text format:\", { error, content, format });\n    return defaultResponse;\n  }\n}\n","/**\n * Octagon API Service Defintions\n * This service handles all communication with the Octagon API using OpenAI-compatible endpoints.\n * It provides methods to query agents using the chat/completions pattern.\n */\n\nimport Logger from \"../utils/logger\";\nimport { getTextFormat, parseTextFormat } from \"./format\";\nimport { AgentRequest, AgentResponse, AgentType, OutputFormat } from \"./types\";\n\n// API Configuration\nconst DEFAULT_API_URL = \"https://api-gateway.octagonagents.com\";\n\n// Storage key constants (used with OfficeRuntime.storage)\nconst API_KEY_STORAGE_NAME = \"octagon_api_key\";\n\n/**\n * OctagonApiService class handles all API interactions\n */\nexport class OctagonApiService {\n  private apiKey: string | null = null;\n  private apiUrl: string;\n\n  constructor(apiUrl: string = DEFAULT_API_URL) {\n    this.apiUrl = apiUrl;\n    // Don't automatically initialize in constructor to avoid race conditions\n    // Instead, require explicit initialization after Office.onReady\n  }\n\n  /**\n   * Set the API key for authentication\n   */\n  public async setApiKey(apiKey: string): Promise<void> {\n    const trimmedKey = apiKey.trim() || null;\n    this.apiKey = trimmedKey;\n\n    if (!trimmedKey) {\n      Logger.warn(\"Attempted to set an empty API key; clearing stored key instead\");\n      await this.clearApiKey();\n      return;\n    }\n\n    // Save the API key to OfficeRuntime.storage\n    try {\n      await OfficeRuntime.storage.setItem(API_KEY_STORAGE_NAME, trimmedKey);\n      Logger.debug(\"API key saved to OfficeRuntime.storage\");\n    } catch (error) {\n      Logger.error(\"Failed to save API key to OfficeRuntime.storage\", error);\n    }\n  }\n\n  /**\n   * Call an Octagon agent with a prompt\n   *\n   * @param agentId - The ID of the agent to call\n   * @param prompt - The prompt to send to the agent\n   * @returns A promise that resolves to the agent's response\n   */\n  public async callAgent(\n    model: string,\n    prompt: string,\n    format: string\n  ): Promise<Array<Array<string | number>>> {\n    Logger.debug(`callAgent invoked with model: ${model}, prompt: ${prompt.substring(0, 50)}...`);\n\n    // Validate the prompt\n    if (!prompt || prompt.trim() === \"\") {\n      throw new Error(\"Please provide a valid prompt\");\n    }\n\n    // Ensure add-in has been authenticated\n    if (!(await this.isAuthenticated())) {\n      Logger.error(\"API request failed: Not authenticated\");\n      throw new Error(\"Not authenticated. Please set your API key first.\");\n    }\n\n    const response = await this.createResponse({\n      model,\n      input: prompt,\n      text: getTextFormat(format),\n    });\n\n    // Parse the content of the response as a JSON object if it is a table or single cell\n    return parseTextFormat(response.content || \"No response content\", format as OutputFormat);\n  }\n\n  /**\n   * Load API key from storage (OfficeRuntime.storage)\n   */\n  private async loadApiKey(): Promise<void> {\n    const storedKey = await this.getStoredApiKey();\n\n    if (storedKey) {\n      this.apiKey = storedKey;\n      return;\n    }\n\n    // If we get here, no API key was found\n    this.apiKey = null;\n  }\n\n  /**\n   * Returns true if the API key is set and not empty.\n   * Always reloads from OfficeRuntime.storage to avoid stale cached keys across runtimes.\n   */\n  public async isAuthenticated(): Promise<boolean> {\n    Logger.info(\"isAuthenticated invoked - synchronizing API key from storage\");\n\n    await this.loadApiKey();\n\n    // Return true if the API key is set\n    return !!this.apiKey;\n  }\n\n  /**\n   * Clear stored API key from OfficeRuntime.storage\n   */\n  public async clearApiKey(): Promise<void> {\n    this.apiKey = null;\n\n    try {\n      await OfficeRuntime.storage.removeItem(API_KEY_STORAGE_NAME);\n      Logger.info(\"API key cleared from OfficeRuntime.storage\");\n    } catch (error) {\n      Logger.error(\"Failed to clear API key from OfficeRuntime.storage\", error);\n    }\n  }\n\n  /**\n   * Get the stored API key from OfficeRuntime.storage.\n   */\n  private async getStoredApiKey(): Promise<string | null> {\n    try {\n      const storedValue = await OfficeRuntime.storage.getItem(API_KEY_STORAGE_NAME);\n      if (typeof storedValue === \"string\") {\n        return storedValue;\n      }\n    } catch (error) {\n      Logger.error(\"Failed to read API key from OfficeRuntime.storage\", error);\n    }\n    return null;\n  }\n\n  /**\n   * Generic method to make authenticated API requests\n   * Handles both regular JSON responses and streamed responses\n   */\n  private async createResponse(data: AgentRequest, apiKey?: string): Promise<AgentResponse> {\n    const requestUrl = new URL(\"/v1/responses\", this.apiUrl);\n\n    const token = apiKey ?? this.apiKey;\n    if (!token) {\n      throw new Error(\"No API key provided\");\n    }\n\n    const headers = new Headers({\n      \"Content-Type\": \"application/json\",\n      Authorization: `Bearer ${token}`,\n    });\n\n    const response = await fetch(requestUrl, {\n      method: \"POST\",\n      headers,\n      body: JSON.stringify(data),\n    });\n\n    if (!response.ok) {\n      // Throw an error with HTTP status and message from the API\n      await this.handleApiError(response);\n    }\n\n    // Bubble up any errors from the parseAgentResponse method to the caller\n    return await this.parseAgentResponse(response);\n  }\n\n  /**\n   * Parse the agent response from the Octagon API\n   * @param response - The fetch response object with streamed data\n   * @returns Parsed response data\n   */\n  private async parseAgentResponse(response: Response): Promise<AgentResponse> {\n    try {\n      // Get the reader for the stream\n      const data = await response.json();\n\n      // Ensure the response is in the expected format\n      if (!data.output || !Array.isArray(data.output)) {\n        Logger.warn(\"Unexpected response format: missing output array\", data);\n        return {\n          content: \"\",\n          id: data?.id,\n          model: data?.model,\n        } as AgentResponse;\n      }\n\n      // Create an empty content string, and append the text of each output message to the content\n      let content = \"\";\n\n      for (const output of data.output) {\n        if (output.type !== \"message\") continue;\n        // Ensure the content is in the expected format\n        if (!output.content || !Array.isArray(output.content)) continue;\n\n        // Add the text of each output message to the content\n        for (const message of output.content) {\n          if (message.type !== \"output_text\") continue;\n          content += message.text;\n        }\n      }\n\n      return {\n        content,\n        id: data.id,\n        model: data.model,\n      } as AgentResponse;\n    } catch (error) {\n      Logger.error(\"Error processing agent response:\", error);\n      throw new Error(\"Failed to process agent response\");\n    }\n  }\n\n  /**\n   * Test API key validity with a simple request\n   */\n  public async testConnection(apiKey: string): Promise<boolean> {\n    const request = {\n      model: AgentType.OctagonAgent,\n      input: \"Test connection\",\n      max_tokens: 10,\n    };\n\n    try {\n      // Test the connection with the provided API key\n      await this.createResponse(request, apiKey);\n      return true;\n    } catch (error) {\n      Logger.error(\"Test connection threw an exception\", error);\n      return false;\n    }\n  }\n\n  private async handleApiError(response: Response): Promise<void> {\n    // Parse error message from response\n    let data: { detail: string } | undefined;\n    try {\n      data = await response.json();\n    } catch (error) {\n      // Fallback to unknown error\n      data = { detail: \"Unknown error\" };\n    }\n\n    const status = response.status;\n    const errorMessage = data?.detail ?? \"Unknown error\";\n    Logger.error(\"Agent request failed\", { status, message: errorMessage });\n    throw new Error(`HTTP ${status}: ${errorMessage}`);\n  }\n}\n","/* global console, CustomFunctions, Office */\n\n/**\n * Octagon Excel Add-in Custom Functions\n * This file defines custom functions that expose Octagon's AI agents as Excel formulas\n */\n\nimport { AgentType, OctagonApiService } from \"../api\";\nimport Logger from \"../utils/logger\";\n\nconst octagonApi = new OctagonApiService();\n\n/**\n * Initializes the Octagon API and registers custom functions\n * This is automatically called when the add-in is initialized with SharedRuntime\n */\nOffice.onReady(async () => {\n  try {\n    Logger.debug(\"Office is ready - initializing Octagon functions\");\n\n    // Register functions namespaced under OCTAGON\n    CustomFunctions.associate(\"OCTAGON.AGENT\", OCTAGON_AGENT);\n  } catch (error) {\n    Logger.error(\"Error during initialization:\", error);\n  }\n});\n\n// ===============================================================\n// Market Intelligence Agent\n// ===============================================================\n\n/**\n * Call the Market Intelligence agent that routes to appropriate specialized agents\n * @customfunction AGENT\n * @param prompt The question or prompt for the Octagon agent\n * @param format The format of the response, one of \"raw\", \"table\", or \"cell\". Defaults to \"table\".\n * @helpUrl https://docs.octagonagents.com/guide/agents/octagon-agent.html\n * @returns array of arrays of strings or numbers\n */\nexport async function OCTAGON_AGENT(\n  prompt: string,\n  format?: string\n): Promise<Array<Array<string | number>>> {\n  try {\n    // Default to table format if no format is provided\n    const agentFormat = format ? format.toLowerCase() : \"table\";\n    return await octagonApi.callAgent(AgentType.OctagonAgent, prompt, agentFormat);\n  } catch (error) {\n    if (error instanceof CustomFunctions.Error) {\n      throw error;\n    }\n    // Throw a custom error with the error message\n    throw new CustomFunctions.Error(\n      CustomFunctions.ErrorCode.notAvailable,\n      error instanceof Error ? error.message : \"An unexpected error occurred\"\n    );\n  }\n}\n\nCustomFunctions.associate(\"AGENT\", OCTAGON_AGENT);"],"names":["AgentType","AgentCategory","OctagonAgent","MarketIntelligence","LogLevel","currentLogLevel","ERROR","logLevelPriority","_defineProperty","DEBUG","INFO","WARN","log","level","message","data","timestamp","Date","toISOString","formattedMessage","concat","console","debug","info","warn","error","formatMap","raw","format","type","table","strict","name","schema","properties","description","items","anyOf","required","title","additionalProperties","cell","getTextFormat","textFormat","Logger","CustomFunctions","Error","ErrorCode","invalidValue","parseTextFormat","content","defaultResponse","_JSON$parse$data","JSON","parse","undefined","e","t","r","Symbol","n","iterator","o","toStringTag","i","c","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","length","l","TypeError","call","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","_defineProperties","_toPropertyKey","key","_typeof","toPrimitive","String","_toPrimitive","API_KEY_STORAGE_NAME","OctagonApiService","apiUrl","_classCallCheck","this","_setApiKey","_callee","apiKey","trimmedKey","_t","_context","trim","clearApiKey","OfficeRuntime","storage","setItem","_x","_callAgent","_callee2","model","prompt","response","_context2","substring","isAuthenticated","createResponse","input","text","_x2","_x3","_x4","_loadApiKey","_callee3","storedKey","_context3","getStoredApiKey","_isAuthenticated","_callee4","_context4","loadApiKey","_clearApiKey","_callee5","_t2","_context5","removeItem","_getStoredApiKey","_callee6","storedValue","_t3","_context6","getItem","_createResponse","_callee7","requestUrl","token","headers","_context7","URL","Headers","Authorization","fetch","method","body","stringify","ok","handleApiError","parseAgentResponse","_x5","_x6","_parseAgentResponse","_callee8","_iterator","_step","output","_iterator2","_step2","_t4","_t5","_t6","_context8","json","Array","isArray","id","_createForOfIteratorHelper","s","_x7","_testConnection","_callee9","request","_t7","_context9","max_tokens","_x8","_handleApiError","_callee0","_data$detail","_data","status","errorMessage","_context0","detail","_x9","octagonApi","OCTAGON_AGENT","_OCTAGON_AGENT","agentFormat","toLowerCase","callAgent","notAvailable","Office","onReady","associate"],"sourceRoot":""}