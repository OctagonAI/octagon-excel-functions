{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://excel-custom-functions/webpack/bootstrap","webpack://excel-custom-functions/webpack/runtime/global","webpack://excel-custom-functions/webpack/runtime/hasOwnProperty shorthand","webpack://excel-custom-functions/webpack/runtime/publicPath","webpack://excel-custom-functions/webpack/runtime/jsonp chunk loading","webpack://excel-custom-functions/./src/utils/logger.ts","webpack://excel-custom-functions/./src/api/octagonApi.ts","webpack://excel-custom-functions/./src/api/agents.ts","webpack://excel-custom-functions/./src/api/types.ts","webpack://excel-custom-functions/./src/utils/browserSupport.ts","webpack://excel-custom-functions/./src/taskpane/taskpane.ts","webpack://excel-custom-functions/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/**\n * Logging utility for Octagon Excel Add-in\n * This module provides centralized logging functionality with different log levels\n * to help debug issues during development and production.\n */\n\n// Log levels\nexport enum LogLevel {\n  DEBUG = 'DEBUG',\n  INFO = 'INFO',\n  WARN = 'WARN',\n  ERROR = 'ERROR'\n}\n\n// Current log level - can be adjusted based on environment\nlet currentLogLevel: LogLevel = \n  process.env.NODE_ENV === 'production' ? LogLevel.ERROR : LogLevel.DEBUG;\n\n// Log level priority (used to determine if a message should be logged)\nconst logLevelPriority: Record<LogLevel, number> = {\n  [LogLevel.DEBUG]: 0,\n  [LogLevel.INFO]: 1,\n  [LogLevel.WARN]: 2,\n  [LogLevel.ERROR]: 3\n};\n\n/**\n * Main logging function that handles all log levels\n */\nexport function log(level: LogLevel, message: string, data?: any): void {\n  // Only log if the current level priority is less than or equal to the message level\n  if (logLevelPriority[level] >= logLevelPriority[currentLogLevel]) {\n    const timestamp = new Date().toISOString();\n    const formattedMessage = `[${timestamp}] [${level}] ${message}`;\n\n    switch (level) {\n      case LogLevel.DEBUG:\n        console.debug(formattedMessage, data || '');\n        break;\n      case LogLevel.INFO:\n        console.info(formattedMessage, data || '');\n        break;\n      case LogLevel.WARN:\n        console.warn(formattedMessage, data || '');\n        break;\n      case LogLevel.ERROR:\n        console.error(formattedMessage, data || '');\n        break;\n    }\n  }\n}\n\n/**\n * Set the current log level\n */\nexport function setLogLevel(level: LogLevel): void {\n  currentLogLevel = level;\n  log(LogLevel.INFO, `Log level set to ${level}`);\n}\n\n/**\n * Get all logs stored in session storage\n */\nexport function getLogs(): any[] {\n  try {\n    return JSON.parse(sessionStorage.getItem('octagon_logs') || '[]');\n  } catch (e) {\n    console.error('[Logger] Error retrieving logs from sessionStorage:', e);\n    return [];\n  }\n}\n\n/**\n * Clear all logs in session storage\n */\nexport function clearLogs(): void {\n  try {\n    sessionStorage.removeItem('octagon_logs');\n  } catch (e) {\n    // Log the error instead of silently failing\n    console.error('[Logger] Error clearing logs from sessionStorage:', e);\n  }\n}\n\n// Convenience methods for each log level\nexport const debug = (message: string, data?: any) => log(LogLevel.DEBUG, message, data);\nexport const info = (message: string, data?: any) => log(LogLevel.INFO, message, data);\nexport const warn = (message: string, data?: any) => log(LogLevel.WARN, message, data);\nexport const error = (message: string, data?: any) => log(LogLevel.ERROR, message, data);\n\n// Export a default logger object\nexport default {\n  debug,\n  info,\n  warn,\n  error,\n  setLogLevel,\n  getLogs,\n  clearLogs\n};","/**\n * Octagon API Service Defintions\n * This service handles all communication with the Octagon API using OpenAI-compatible endpoints.\n * It provides methods to query agents using the chat/completions pattern.\n */\n\nimport {\n  ApiResponse,\n  AgentFullResponse,\n  StreamResponse\n} from './types';\nimport Logger from '../utils/logger';\n\n// API Configuration\nconst DEFAULT_API_URL = 'https://api-gateway.octagonagents.com/v1';\n\n// SessionStorage key constants\nconst API_KEY_STORAGE_NAME = 'octagon_api_key';\nconst CACHED_SESSION_SETTINGS_KEY = 'CachedSessionSettings';\n\n/**\n * OctagonApiService class handles all API interactions\n */\nexport class OctagonApiService {\n  private apiKey: string | null = null;\n  private apiUrl: string;\n  private isOfficeInitialized: boolean = false;\n  \n  constructor(apiUrl: string = DEFAULT_API_URL) {\n    this.apiUrl = apiUrl;\n    // Don't automatically initialize in constructor to avoid race conditions\n    // Instead, require explicit initialization after Office.onReady\n    Logger.info(`OctagonApiService created with API URL: ${this.apiUrl}`);\n  }\n  \n  /**\n   * Initialize the service after Office is ready\n   * This should be called after Office.onReady completes\n   */\n  public initialize(): void {\n    this.isOfficeInitialized = true;\n    this.loadApiKey();\n    Logger.info(`OctagonApiService fully initialized. API key status: ${this.isAuthenticated() ? 'Available' : 'Not available'}`);\n  }\n  \n  /**\n   * Check if API key exists in SessionStorage\n   * @returns boolean True if API key is found in SessionStorage\n   */\n  public checkForStoredApiKey(): boolean {\n    try {\n      // Check if we have a cached session settings with an API key\n      const cachedSessionData = sessionStorage.getItem(CACHED_SESSION_SETTINGS_KEY);\n      if (cachedSessionData) {\n        const sessionData = JSON.parse(cachedSessionData);\n        if (sessionData && sessionData.octagon_api_key) {\n          Logger.info('Found API key in CachedSessionSettings');\n          return true;\n        }\n      }\n      \n      // Also check our direct storage\n      const directApiKey = sessionStorage.getItem(API_KEY_STORAGE_NAME);\n      if (directApiKey) {\n        Logger.info('Found API key in direct SessionStorage');\n        return true;\n      }\n    } catch (error) {\n      Logger.error('Error checking for stored API key', error);\n    }\n    \n    return false;\n  }\n  \n  /**\n   * Set the API key for authentication\n   */\n  public setApiKey(apiKey: string): void {\n    this.apiKey = apiKey;\n    this.saveApiKey(apiKey);\n  }\n  \n  /**\n   * Save API key to SessionStorage\n   */\n  private saveApiKey(apiKey: string): void {\n    try {\n      // Save to SessionStorage\n      sessionStorage.setItem(API_KEY_STORAGE_NAME, apiKey);\n      \n      // Also save to CachedSessionSettings for compatibility\n      try {\n        const cachedSessionData = sessionStorage.getItem(CACHED_SESSION_SETTINGS_KEY);\n        if (cachedSessionData) {\n          const sessionData = JSON.parse(cachedSessionData);\n          sessionData.octagon_api_key = apiKey;\n          sessionStorage.setItem(CACHED_SESSION_SETTINGS_KEY, JSON.stringify(sessionData));\n        } else {\n          // Create a new cached session settings object\n          const newSessionData = { octagon_api_key: apiKey };\n          sessionStorage.setItem(CACHED_SESSION_SETTINGS_KEY, JSON.stringify(newSessionData));\n        }\n      } catch (error) {\n        Logger.warn('Failed to save to CachedSessionSettings', error);\n      }\n      \n      Logger.info('API key saved to SessionStorage');\n    } catch (error) {\n      Logger.error('Failed to save API key to SessionStorage', error);\n    }\n  }\n  \n  /**\n   * Call an Octagon agent with a prompt\n   * \n   * @param agentId - The ID of the agent to call\n   * @param prompt - The prompt to send to the agent\n   * @returns A promise that resolves to the agent's response\n   */\n  public async callAgent(agentId: string, prompt: string): Promise<ApiResponse<AgentFullResponse>> {\n    Logger.info(`callAgent invoked with agent: ${agentId}, prompt: ${prompt.substring(0, 50)}...`);\n    const requestData = {\n      model: agentId,\n      input: prompt,\n      stream: true\n    };\n    Logger.debug('callAgent request data:', requestData);\n    const response = await this.apiRequest<any>(`/responses`, 'POST', requestData, true);\n    if (!response.success) {\n      return response as ApiResponse<AgentFullResponse>;\n    }\n    return response as ApiResponse<AgentFullResponse>;\n  }\n  \n  /**\n   * Load API key from SessionStorage with a simplified approach\n   */\n  private loadApiKey(): void {\n    Logger.info('Attempting to load API key from SessionStorage');\n    \n    try {\n      // Try CachedSessionSettings first\n      const cachedSessionData = sessionStorage.getItem(CACHED_SESSION_SETTINGS_KEY);\n      if (cachedSessionData) {\n        try {\n          const sessionData = JSON.parse(cachedSessionData);\n          if (sessionData && sessionData.octagon_api_key) {\n            this.apiKey = sessionData.octagon_api_key;\n            Logger.info('API key loaded from CachedSessionSettings');\n            return;\n          }\n        } catch (parseError) {\n          Logger.warn('Failed to parse CachedSessionSettings', parseError);\n        }\n      }\n      \n      // Fallback to direct storage\n      const directApiKey = sessionStorage.getItem(API_KEY_STORAGE_NAME);\n      if (directApiKey) {\n        this.apiKey = directApiKey;\n        Logger.info('API key loaded from direct SessionStorage');\n        return;\n      }\n    } catch (error) {\n      Logger.error('Failed to load API key from SessionStorage', error);\n    }\n    \n    // If we get here, no API key was found\n    Logger.info('No API key found in SessionStorage');\n  }\n  \n  /**\n   * Check if the API key is set\n   */\n  public isAuthenticated(): boolean {\n    // Force reload of the API key to ensure we have the latest\n    if (!this.apiKey) {\n      this.loadApiKey();\n    }\n    const hasApiKey = !!this.apiKey && this.apiKey.trim() !== '';\n    return hasApiKey;\n  }\n  \n  /**\n   * Clear stored API key from all SessionStorage locations\n   */\n  public clearApiKey(): void {\n    this.apiKey = null;\n    \n    try {\n      // Clear direct API key storage\n      sessionStorage.removeItem(API_KEY_STORAGE_NAME);\n      \n      // Clear from CachedSessionSettings if it exists\n      const cachedSessionData = sessionStorage.getItem(CACHED_SESSION_SETTINGS_KEY);\n      if (cachedSessionData) {\n        try {\n          const sessionData = JSON.parse(cachedSessionData);\n          if (sessionData) {\n            delete sessionData.octagon_api_key;\n            sessionStorage.setItem(CACHED_SESSION_SETTINGS_KEY, JSON.stringify(sessionData));\n          }\n        } catch (parseError) {\n          Logger.warn('Failed to parse CachedSessionSettings for clearing', parseError);\n        }\n      }\n      \n      Logger.info('API key cleared from all SessionStorage locations');\n    } catch (error) {\n      Logger.error('Failed to clear API key from SessionStorage', error);\n    }\n  }\n  \n  /**\n   * Generic method to make authenticated API requests\n   * Handles both regular JSON responses and streamed responses\n   */\n  private async apiRequest<T>(\n    endpoint: string, \n    method: string = 'POST', \n    data?: any,\n    stream: boolean = true\n  ): Promise<ApiResponse<T>> {\n    \n    if (!this.isAuthenticated()) {\n      Logger.error('API request failed: Not authenticated');\n      return {\n        success: false,\n        error: 'Not authenticated. Please set your API key first.'\n      };\n    }\n    \n    const url = `${this.apiUrl}${endpoint}`;\n    \n    try {\n      Logger.info(`Making ${method} request to ${url}`, data);\n      \n      const headers = new Headers({\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${this.apiKey}`\n      });\n      \n      Logger.debug('Request headers:', {\n        contentType: headers.get('Content-Type'),\n        authorization: this.apiKey ? `Bearer ${this.apiKey.substring(0, 5)}...` : 'None'\n      });\n      \n      const requestBody = data ? JSON.stringify(data) : undefined;\n      Logger.debug('Request body:', requestBody);\n      \n      const response = await fetch(url, {\n        method,\n        headers,\n        body: requestBody\n      });\n      \n      Logger.info(`Response status: ${response.status} ${response.statusText}`);\n      \n      if (!response.ok) {\n        const errorText = await response.text();\n        Logger.error(`API request failed: ${response.status} ${response.statusText}`, errorText);\n        \n        return {\n          success: false,\n          error: `Request failed (${response.status}): ${errorText || response.statusText}`\n        };\n      }\n      \n      const streamedResponse = await this.handleStreamedResponse(response);\n      return streamedResponse as ApiResponse<T>;\n    \n    } catch (error) {\n      Logger.error('API request failed with exception', error);\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error occurred'\n      };\n    }\n  }\n  \n  /**\n   * Handle streamed responses from the Octagon API\n   * @param response - The fetch response object with streamed data\n   * @returns Parsed response data\n   */\n  private async handleStreamedResponse(response: Response): Promise<ApiResponse<any>> {\n    try {\n      // Get the reader for the stream\n      const reader = response.body?.getReader();\n      if (!reader) {\n        Logger.error('Response stream could not be read');\n        return { \n          success: false, \n          error: 'Response stream could not be read' \n        };\n      }\n\n      Logger.info('Processing streamed response');\n      \n      // Variables to collect the response\n      let fullText = '';\n      let finalResponse = null;\n      let parseErrorCount = 0; // Track number of parse errors\n      \n      // Process the stream\n      while (true) {\n        try {\n          const { done, value } = await reader.read();\n          if (done) break;\n          \n          // Convert the chunks to text\n          const chunk = new TextDecoder().decode(value);\n          Logger.debug('Received stream chunk:', chunk.substring(0, 100) + (chunk.length > 100 ? '...' : ''));\n          \n          // Process each line that starts with \"data: \"\n          const lines = chunk.split('\\n');\n          for (const line of lines) {\n            if (line.startsWith('data: ')) {\n              const jsonStr = line.substring(6); // Remove 'data: ' prefix\n              \n              // Check for the end of stream marker\n              if (jsonStr.trim() === '[DONE]') {\n                Logger.info('Stream completed [DONE] marker received');\n                continue;\n              }\n              \n              try {\n                const data = JSON.parse(jsonStr);\n                Logger.debug('Parsed stream data type:', data.type);\n                \n                // Process based on the type of data\n                if (data.type === 'response.completed') {\n                  // This is the final response with all data\n                  finalResponse = data.response;\n                  Logger.info('Final response received');\n                } else if (data.type === 'response.output_text.delta' || data.type === 'response.output_text.done') {\n                  // This is a text delta/update, append to our content\n                  if (data.delta) {\n                    fullText += data.delta;\n                  } else if (data.text) {\n                    fullText = data.text; // This is the complete text\n                  }\n                } else if (data.type === 'response.content_part.done' && data.part?.text) {\n                  // Content part with complete text\n                  fullText = data.part.text;\n                } else if (data.response && data.response.output) {\n                  // Store the full response data for direct access\n                  finalResponse = data.response;\n                }\n              } catch (parseError) {\n                parseErrorCount++;\n                Logger.warn(`Error parsing stream JSON (${parseErrorCount}): ${parseError} - ${jsonStr.substring(0, 100)}`);\n                \n                // If we hit too many parse errors, we might be dealing with a bad stream\n                if (parseErrorCount > 5) {\n                  Logger.error('Too many JSON parse errors in stream, aborting');\n                  throw new Error('Stream parsing failed: Too many JSON parse errors');\n                }\n              }\n            }\n          }\n        } catch (streamError) {\n          Logger.error('Error processing stream chunk:', streamError);\n          throw streamError; // Rethrow to be caught by the outer try/catch\n        }\n      }\n      \n      // Ensure we have some content to return, even if it's empty\n      const transformedResponse = {\n        content: fullText || '',\n        id: finalResponse?.id || '',\n        model: finalResponse?.model || '',\n        created: finalResponse?.created_at || Date.now(),\n        // For compatibility with functions.ts, include the raw response\n        output: finalResponse?.output || [],\n        // Include full response data for more advanced processing if needed\n        rawResponse: finalResponse\n      };\n      \n      Logger.info('Streamed response processed successfully');\n      Logger.debug('Transformed response:', {\n        contentLength: transformedResponse.content.length,\n        hasId: !!transformedResponse.id,\n        hasModel: !!transformedResponse.model,\n        outputItems: transformedResponse.output.length\n      });\n      \n      return {\n        success: true,\n        data: transformedResponse\n      };\n    } catch (error) {\n      Logger.error('Error processing streamed response:', error);\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : 'Failed to process streamed response'\n      };\n    }\n  }\n  \n  /**\n   * Test API key validity with a simple request\n   */\n  public async testConnection(): Promise<ApiResponse<StreamResponse>> {\n    Logger.info('Testing API connection with stored key');\n    \n    // If no API key was loaded, return failure immediately\n    if (!this.isAuthenticated()) {\n      Logger.error('Test connection failed: No API key available');\n      return {\n        success: false,\n        error: 'No API key available for testing'\n      };\n    }\n    \n    // Use a simple, fast query to test the connection\n    try {\n      const model = 'octagon-agent'; // Default model for testing\n      const result = await this.apiRequest<any>('/responses', 'POST', {\n        model: model,\n        input: 'Test connection',\n        max_tokens: 10\n      }, true); // Add true for stream parameter\n      \n      Logger.info(`Test connection result: ${result.success ? 'Success' : 'Failed'}`);\n      \n      if (result.success) {\n        // Try to log the response format to help debugging\n        Logger.debug('Test connection response format:', {\n          hasContent: result.data && typeof result.data.content !== 'undefined',\n          hasChoices: result.data && Array.isArray(result.data.choices),\n          responseKeys: result.data ? Object.keys(result.data) : []\n        });\n      }\n      \n      return result;\n    } catch (error) {\n      Logger.error('Test connection threw an exception', error);\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error during connection test'\n      };\n    }\n  }\n  \n  /**\n   * Main method for agent interaction - OpenAI compatible\n   * Maps agent selection to model names and formats query as message array\n   */\n  public async ResponseEndpoint(\n    query: string,\n    model: string,\n    stream: boolean = true\n  ): Promise<ApiResponse<StreamResponse>> {\n    Logger.info('Making stream responses endpoint request', { query: query.substring(0, 100) + '...', model, stream });\n    \n    // Use the improved streaming response handling when stream is true\n    return this.apiRequest<StreamResponse>('/responses', 'POST', {\n      model: model,\n      input: query,\n      stream: stream\n    }, stream);\n  }\n    \n}\n\n// Export singleton instance\nexport const octagonApiService = new OctagonApiService();","/**\n * Octagon API Agents Definitions\n * These interfaces define the available agents in the Octagon API\n */\n\nimport { AgentInfo, AgentCategory } from './types';\n\nexport const OCTAGON_AGENTS: AgentInfo[] = [  \n  {\n    id: 'octagon-agent',\n    displayName: 'Octagon Agent',\n    excelFormulaName: 'OCTAGON.OCTAGON_AGENT',\n    description: 'Public and Private market intelligence agent that optimally routes requests to appropriate specialized agents',\n    category: AgentCategory.MarketIntelligence,\n    usageExamples: [\n      { \n        topic: 'Financial Metrics Analysis',\n        prompt: '=OCTAGON.OCTAGON_AGENT(\"Retrieve year-over-year growth in key income-statement items for AAPL, limited to 5 records and filtered by period FY.\")'\n      },\n      { \n        topic: 'SEC Filing Analysis',\n        prompt: '=OCTAGON.OCTAGON_AGENT(\"Analyze the latest 10-K filing for AAPL and extract key financial metrics and risk factors.\")'\n      },\n      { \n        topic: 'Stock Performance',\n        prompt: '=OCTAGON.OCTAGON_AGENT(\"Retrieve the daily closing prices for AAPL over the last 30 days.\")'\n      },\n      { \n        topic: 'Earnings Call Insights',\n        prompt: '=OCTAGON.OCTAGON_AGENT(\"Analyze AAPL\\'s latest earnings call transcript and extract key insights about future guidance.\")'\n      },\n      { \n        topic: 'Company Overview',\n        prompt: '=OCTAGON.OCTAGON_AGENT(\"Provide a comprehensive overview of Stripe, including its business model and key metrics.\")'\n      },\n      { \n        topic: 'Funding History',\n        prompt: '=OCTAGON.OCTAGON_AGENT(\"Retrieve the funding history for Stripe, including all rounds and investors.\")'\n      },\n      { \n        topic: 'M&A Activity',\n        prompt: '=OCTAGON.OCTAGON_AGENT(\"List all M&A transactions involving Stripe in the last 2 years.\")'\n      },\n      { \n        topic: 'Investor Profile',\n        prompt: '=OCTAGON.OCTAGON_AGENT(\"Provide a detailed profile of Sequoia Capital\\'s investment strategy and portfolio.\")'\n      },\n      { \n        topic: 'Debt Analysis',\n        prompt: '=OCTAGON.OCTAGON_AGENT(\"Analyze Stripe\\'s debt financing history and current debt structure.\")'\n      },\n      { \n        topic: 'Institutional Holdings',\n        prompt: '=OCTAGON.OCTAGON_AGENT(\"Retrieve the most recent Form 13F and related filings submitted by institutional investors.\")'\n      }\n    ]\n  },\n];\n","/**\n * Octagon API TypeScript Interfaces\n * These interfaces define the contract between our Excel Add-in and the Octagon API.\n */\n\n// ==================== COMMON API TYPES ====================\n\n// Common API response structure\nexport interface ApiResponse<T> {\n  success: boolean;\n  data?: T;\n  error?: string;\n}\n\n// Generic agent response base\nexport interface AgentResponse {\n  query: string;\n  timestamp: string;\n  agent: AgentInfo | AgentListing;\n}\n\n// ==================== OPENAI COMPATIBLE TYPES ====================\n\n// OpenAI-style message structure\nexport interface ChatMessage {\n  role: 'system' | 'user' | 'assistant';\n  content: string;\n}\n\n// OpenAI-style chat completion request\nexport interface StreamRequest {\n  model: string;\n  messages: ChatMessage[];\n  temperature?: number;\n  max_tokens?: number;\n  stream?: boolean;\n}\n\n// OpenAI-style choice structure\nexport interface StreamChoice {\n  index: number;\n  message: ChatMessage;\n  finish_reason: 'stop' | 'length' | 'function_call' | 'content_filter' | null;\n}\n\n// OpenAI-style usage statistics\nexport interface StreamUsage {\n  prompt_tokens: number;\n  completion_tokens: number;\n  total_tokens: number;\n}\n\n// OpenAI-style responses endpoint response\nexport interface StreamResponse {\n  id: string;\n  object: 'responses';\n  created: number;\n  model: string;\n  choices: StreamChoice[];\n  usage?: StreamUsage;\n  // Adding new fields for Octagon specific response structure\n  content?: string;\n  output?: any[];\n  rawResponse?: any;\n  status?: string;\n  text?: any;\n}\n\n// ==================== AGENT TYPES ====================\n\nexport interface AgentInfo {\n  id: string;\n  displayName: string;\n  excelFormulaName: string;\n  description: string;\n  category: AgentCategory;\n  examplePrompt?: string;\n  usageExamples?: UsageExample[];\n}\n\nexport interface UsageExample {\n  topic: string;\n  prompt: string;\n}\n\nexport enum AgentCategory {\n  MarketIntelligence = 'Market Intelligence',\n  DeepResearch = 'Deep Research'\n}\n\nexport enum AgentListing {\n  OctagonAgent = 'octagon-agent',\n  ScraperAgent = 'octagon-scraper-agent',\n  DeepResearchAgent = 'octagon-deep-research-agent'\n}\n\n// ==================== REQUEST/RESPONSE TYPES ====================\n\n// Detailed agent response with content and structured data\nexport interface AgentFullResponse {\n  content: string;\n  // Additional fields that might be in the Octagon API response\n  model?: string;\n  created?: number;\n  id?: string;\n  [key: string]: any; // Allow for additional unknown properties\n}\n\n// ==================== AUTHENTICATION & MANAGEMENT TYPES ====================\n\n// API Authentication types\nexport interface AuthCredentials {\n  apiKey: string;\n}\n\n// API Key interface\nexport interface APIKey {\n  id?: string | null;\n  created_at: string;\n  updated_at?: string | null;\n  name: string;\n  truncated_secret: string;\n}\n\n// ==================== UTILITY TYPES ====================\n\n// Type aliases for common data structures\nexport type Option<T = string> = { value: T; label: string };\nexport type Maybe<T> = T | null | undefined;\n\n// ==================== EXCEL INTEGRATION TYPES ====================\n\n// Excel table formatting options\nexport interface ExcelTableOptions {\n  hasHeaders?: boolean;\n  showTotals?: boolean;\n  tableName?: string;\n  tableStyle?: string;\n}\n\n// Excel insertion result\nexport interface ExcelInsertionResult {\n  success: boolean;\n  rowsInserted: number;\n  columnsInserted: number;\n  range?: string;\n  error?: string;\n}\n\n// ==================== ERROR HANDLING TYPES ====================\n\n// Standardized error response\nexport interface ErrorResponse {\n  error: {\n    code: string;\n    message: string;\n    type: 'api_error' | 'rate_limit_exceeded' | 'invalid_request' | 'authentication_error';\n    param?: string;\n  };\n}\n\n// ==================== EXPORTED CONSTANTS ====================\n\n// Default responses endpoint completion options\nexport const DEFAULT_CHAT_OPTIONS = {\n  temperature: 0.7,\n  max_tokens: 1500,\n  stream: true\n} as const;","/**\n * Browser and API support detection utilities\n * Used to provide compatibility warnings to users\n */\n\nimport Logger from './logger';\n\n/**\n * Detects if the browser is Internet Explorer\n * @returns true if the browser is IE, false otherwise\n */\nexport function detectIE(): boolean {\n  try {\n    const ua = window.navigator.userAgent;\n    const msie = ua.indexOf('MSIE ');\n    const trident = ua.indexOf('Trident/');\n    \n    return (msie > 0 || trident > 0);\n  } catch (error) {\n    Logger.error('Error detecting browser:', error);\n    return false; // Assume not IE if detection fails\n  }\n}\n\n/**\n * Checks if all required APIs are supported in the current environment\n * @returns An array of issues (empty if all requirements are met)\n */\nexport function checkRequiredApiSupport(): string[] {\n  const issues: string[] = [];\n  \n  try {\n    // Check for SharedRuntime support\n    if (!Office.context.requirements.isSetSupported('SharedRuntime', '1.1')) {\n      issues.push(\"This add-in requires SharedRuntime support. Please update to a newer version of Office.\");\n    }\n    \n    // Check for ExcelApi support\n    if (!Office.context.requirements.isSetSupported('ExcelApi', '1.7')) {\n      issues.push(\"Some Excel features require Excel API 1.7 or later. Please update to a newer version of Excel.\");\n    }\n    \n    // Check for CustomFunctions support\n    if (!Office.context.requirements.isSetSupported('CustomFunctions', '1.1')) {\n      issues.push(\"Custom functions require Excel support for CustomFunctions 1.1 or later.\");\n    }\n    \n    // Check if we're in a compatible platform for our add-in\n    checkPlatformCompatibility(issues);\n    \n  } catch (error) {\n    Logger.error('Error checking API support:', error);\n    issues.push(\"Error checking API compatibility. Some features may not work as expected.\");\n  }\n  \n  return issues;\n}\n\n/**\n * Checks platform compatibility and adds any issues to the issues array\n * @param issues Array to add platform compatibility issues to\n */\nfunction checkPlatformCompatibility(issues: string[]): void {\n  // Check if we're in a web browser\n  try {\n    const platform = Office.context.platform;\n    const host = Office.context.host;\n    \n    // Log platform information for diagnostics\n    Logger.info(`Running on platform: ${platform}, host: ${host}`);\n    \n    // Check specific platform requirements\n    if (platform === Office.PlatformType.PC) {\n      // Check for Windows version compatibility if needed\n      // This would require additional detection code\n    } else if (platform === Office.PlatformType.Mac) {\n      // Check for Mac-specific issues if needed\n    } else if (platform === Office.PlatformType.OfficeOnline) {\n      // Check for Office Online specific issues\n      \n      // Example: Warn about possible streaming limitations in Excel Online\n      issues.push(\"Excel Online may have limitations with long-running functions. Consider using Excel desktop for complex operations.\");\n    }\n    \n    // Ensure we're running in Excel\n    if (host !== Office.HostType.Excel) {\n      issues.push(\"This add-in is designed for Excel and may not function correctly in other Office applications.\");\n    }\n    \n  } catch (error) {\n    Logger.error('Error detecting platform:', error);\n    // Don't add to issues here as we already have a general error message\n  }\n}","/**\n * Octagon Excel Add-in Taskpane\n * This file handles the UI and interaction for the Octagon Excel Add-in taskpane\n */\n\nimport { octagonApiService } from '../api/octagonApi';\nimport { OCTAGON_AGENTS } from '../api/agents';\nimport Logger from '../utils/logger';\nimport { detectIE, checkRequiredApiSupport } from '../utils/browserSupport';\n\n// Initialize API service\nconst apiService = octagonApiService;\n\n// Track the application state\nlet isAuthenticated = false;\nlet isCheckingApiKey = false;\nlet hasAutoRedirected = false;\n\n// Initialize the taskpane when Office is ready\nOffice.onReady(async (info) => {\n  try {\n    Logger.info(\"Office is ready - initializing Octagon taskpane\");\n    \n    // Initialize the API service\n    apiService.initialize();\n    \n    // Hide the sideload message\n    document.getElementById(\"sideload-msg\").style.display = \"none\";\n    \n    // Add event listeners to UI elements\n    setupEventListeners();\n    \n    // Show auth view first (this ensures UI is visible)\n    showAuthView();\n        \n    // Check browser compatibility\n    if (detectIE()) {\n      showBrowserWarning('Internet Explorer is not fully supported. For the best experience, please use Microsoft Edge, Chrome, or another modern browser.');\n    }\n    \n    // Check if all required APIs are supported\n    const apiSupportIssues = checkRequiredApiSupport();\n    if (apiSupportIssues.length > 0) {\n      showApiSupportWarning(apiSupportIssues);\n    }\n    \n    Logger.info(\"Taskpane initialized\");\n  } catch (error) {\n    Logger.error(\"Error during taskpane initialization:\", error);\n  }\n});\n\n/**\n * Set up event listeners for UI interactions\n */\nfunction setupEventListeners() {\n  // Submit button\n  const submitButton = document.getElementById(\"submit-button\");\n  if (submitButton) {\n    submitButton.addEventListener(\"click\", handleSubmit);\n  }\n  \n  // Test Connection button\n  const testConnectionButton = document.getElementById(\"test-connection-button\");\n  if (testConnectionButton) {\n    testConnectionButton.addEventListener(\"click\", handleTestConnection);\n  }\n  \n  // Clear API Keys button\n  const clearApiKeysButton = document.getElementById(\"clear-api-keys-button\");\n  if (clearApiKeysButton) {\n    clearApiKeysButton.addEventListener(\"click\", handleClearApiKeys);\n  }\n  \n  // Continue to Main Menu button\n  const continueToMenuButton = document.getElementById(\"continue-to-menu-button\");\n  if (continueToMenuButton) {\n    continueToMenuButton.addEventListener(\"click\", showAgentsView);\n  }\n  \n  // Note: We no longer need to set up the back button listener here\n  // since we add it dynamically when creating the agents view\n  \n  // Enter key in API key input\n  const apiKeyInput = document.getElementById(\"api-key-input\") as HTMLInputElement;\n  if (apiKeyInput) {\n    apiKeyInput.addEventListener(\"keypress\", (event) => {\n      if (event.key === \"Enter\") {\n        handleSubmit();\n      }\n    });\n  }\n}\n\n/**\n * Show the authentication view\n */\nfunction showAuthView() {\n  const authView = document.getElementById(\"auth-view\");\n  const agentsView = document.getElementById(\"agents-view\");\n  \n  if (authView && agentsView) {\n    authView.style.display = \"block\";\n    authView.classList.add(\"fade-in\");\n    agentsView.style.display = \"none\";\n  }\n  \n  // Only check API key status if this function wasn't called during initialization\n  // or as part of another API key status check\n  if (!isCheckingApiKey) {\n    isCheckingApiKey = true;\n    \n    // Uses setTimeout to break the potential call stack chain\n    // This ensures UI renders before we continue with more logic\n    setTimeout(() => {\n      checkApiKeyStatus();\n      isCheckingApiKey = false;\n    }, 0);\n  }\n}\n\n/**\n * Check the status of the API key and update the UI accordingly\n */\nfunction checkApiKeyStatus() {\n  const hasStoredKey = apiService.checkForStoredApiKey();\n  const statusMessageContainer = document.getElementById(\"api-key-status-message\");\n  const continueToMenuContainer = document.getElementById(\"continue-to-menu-container\");\n  const apiKeyInputContainer = document.getElementById(\"api-key-input-container\");\n  const clearApiKeysButton = document.getElementById(\"clear-api-keys-button\");\n  \n  // Get the authentication header and instruction text\n  const authHeader = document.querySelector(\".auth-container h3.ms-font-l\");\n  const authInstructions = document.querySelector(\".auth-container p.ms-font-m\");\n  \n  if (hasStoredKey) {\n    // If we have a stored key, hide the status message but log it\n    Logger.info(\"API Key detected from previous sessions\");\n    \n    if (statusMessageContainer) {\n      statusMessageContainer.style.display = \"none\";\n    }\n    \n    // Hide the authentication header and instructions\n    if (authHeader) {\n      authHeader.textContent = \"API Key Detected\";\n    }\n    \n    if (authInstructions) {\n      authInstructions.textContent = \"Your API key has been detected. You can proceed to the main menu or verify your connection.\";\n    }\n    \n    // Show the continue button and style it at the bottom center\n    if (continueToMenuContainer) {\n      continueToMenuContainer.style.display = \"flex\";\n      continueToMenuContainer.innerHTML = \"\";\n      \n      const continueButton = document.createElement(\"button\");\n      continueButton.id = \"continue-to-menu-button\";\n      continueButton.className = \"ms-Button ms-Button--icon continue-to-menu-button\";\n      continueButton.innerHTML = `\n        <span class=\"ms-Button-label\">Main Menu</span>\n        <span class=\"ms-Button-icon\">\n          <i class=\"ms-Icon ms-Icon--ChevronRight\"></i>\n        </span>\n      `;\n      continueButton.addEventListener(\"click\", showAgentsView);\n      \n      continueToMenuContainer.appendChild(continueButton);\n    }\n    \n    // Hide the API key input container\n    if (apiKeyInputContainer) {\n      apiKeyInputContainer.style.display = \"none\";\n    }\n    \n    // Show Clear API Keys button since there's a stored key\n    if (clearApiKeysButton) {\n      clearApiKeysButton.style.display = \"inline-block\";\n    }\n    \n    // Rename the action buttons\n    updateActionButtonLabels(true);\n    \n    // Set authenticated state\n    isAuthenticated = true;\n    \n    // Only auto-redirect if this is the first time we're checking the API key\n    // and we haven't auto-redirected before\n    if (!hasAutoRedirected) {\n      hasAutoRedirected = true;\n      // Automatically proceed to the Main Menu after a brief delay\n      setTimeout(() => {\n        showAgentsView();\n      }, 1000);\n    }\n  } else {\n    // If no key is stored, show a message\n    if (statusMessageContainer) {\n      statusMessageContainer.textContent = \"No API Key detected. Please provide an API Key to continue.\";\n      statusMessageContainer.style.display = \"block\";\n    }\n    \n    // Show the default authentication header and instructions\n    if (authHeader) {\n      authHeader.textContent = \"Authentication Required\";\n    }\n    \n    if (authInstructions) {\n      authInstructions.textContent = \"Please enter your Octagon API key to continue:\";\n    }\n    \n    if (continueToMenuContainer) {\n      continueToMenuContainer.style.display = \"none\";\n    }\n    \n    // Show the API key input container\n    if (apiKeyInputContainer) {\n      apiKeyInputContainer.style.display = \"block\";\n    }\n    \n    // Hide Clear API Keys button since there's no stored key\n    if (clearApiKeysButton) {\n      clearApiKeysButton.style.display = \"none\";\n    }\n    \n    // Update button labels for new users\n    updateActionButtonLabels(false);\n  }\n}\n\n/**\n * Update action button labels based on authentication state\n * @param isAuthenticated Whether the user is authenticated\n */\nfunction updateActionButtonLabels(isAuthenticated: boolean) {\n  const submitButton = document.getElementById(\"submit-button\");\n  const testConnectionButton = document.getElementById(\"test-connection-button\");\n  \n  if (submitButton) {\n    if (isAuthenticated) {\n      submitButton.style.display = \"none\";\n    } else {\n      submitButton.style.display = \"inline-block\";\n    }\n  }\n  \n  if (testConnectionButton) {\n    // Test Connection button label stays the same regardless of auth state\n    testConnectionButton.innerHTML = '<span class=\"ms-Button-label\">Test Connection</span>';\n  }\n}\n\n/**\n * Handle the Submit button click\n */\nasync function handleSubmit() {\n  try {\n    // Get the API key from the input field\n    const apiKeyInput = document.getElementById(\"api-key-input\") as HTMLInputElement;\n    const apiKey = apiKeyInput?.value?.trim();\n    \n    if (!apiKey) {\n      showAuthError(\"Please enter an API Key.\");\n      return;\n    }\n    \n    // Set the API key\n    apiService.setApiKey(apiKey);\n    \n    // Show loading state\n    toggleAuthLoadingState(true);\n    \n    // Test the connection\n    const isValid = await testApiConnection();\n    \n    // Hide loading state\n    toggleAuthLoadingState(false);\n    \n    if (isValid) {\n      // Success - show success message and enable continue button\n      clearAuthError();\n      showAuthSuccess(\"Connection successful! API Key verified.\");\n      \n      // Get the authentication header and instruction text\n      const authHeader = document.querySelector(\".auth-container h3.ms-font-l\");\n      const authInstructions = document.querySelector(\".auth-container p.ms-font-m\");\n      \n      // Update text for authenticated users\n      if (authHeader) {\n        authHeader.textContent = \"API Key Detected\";\n      }\n      \n      if (authInstructions) {\n        authInstructions.textContent = \"Your API key has been detected. You can proceed to the main menu or verify your connection.\";\n      }\n      \n      // Update the UI to authenticated state\n      const apiKeyInputContainer = document.getElementById(\"api-key-input-container\");\n      if (apiKeyInputContainer) {\n        apiKeyInputContainer.style.display = \"none\";\n      }\n      \n      // Show the continue button\n      const continueToMenuContainer = document.getElementById(\"continue-to-menu-container\");\n      if (continueToMenuContainer) {\n        continueToMenuContainer.style.display = \"flex\";\n        continueToMenuContainer.innerHTML = \"\";\n        \n        const continueButton = document.createElement(\"button\");\n        continueButton.id = \"continue-to-menu-button\";\n        continueButton.className = \"ms-Button ms-Button--icon continue-to-menu-button\";\n        continueButton.innerHTML = `\n          <span class=\"ms-Button-label\">Main Menu</span>\n          <span class=\"ms-Button-icon\">\n            <i class=\"ms-Icon ms-Icon--ChevronRight\"></i>\n          </span>\n        `;\n        continueButton.addEventListener(\"click\", showAgentsView);\n        \n        continueToMenuContainer.appendChild(continueButton);\n      }\n      \n      // Hide status message\n      const statusMessageContainer = document.getElementById(\"api-key-status-message\");\n      if (statusMessageContainer) {\n        statusMessageContainer.style.display = \"none\";\n      }\n      \n      // Show Clear API Keys button\n      const clearApiKeysButton = document.getElementById(\"clear-api-keys-button\");\n      if (clearApiKeysButton) {\n        clearApiKeysButton.style.display = \"inline-block\";\n      }\n      \n      updateActionButtonLabels(true);\n      isAuthenticated = true;\n      \n      // Automatically proceed to the Main Menu after a brief delay\n      // This gives the user a chance to see the success message first\n      setTimeout(() => {\n        showAgentsView();\n      }, 1000);\n\n    } else {\n      \n      // Failed - show error message\n      showAuthError(\"Invalid API key. Please check and try again.\");\n      apiService.clearApiKey();\n      \n      // Reset UI text\n      const authHeader = document.querySelector(\".auth-container h3.ms-font-l\");\n      const authInstructions = document.querySelector(\".auth-container p.ms-font-m\");\n      \n      if (authHeader) {\n        authHeader.textContent = \"Authentication Required\";\n      }\n      \n      if (authInstructions) {\n        authInstructions.textContent = \"Please enter your Octagon API key to continue:\";\n      }\n      \n      // Show the API key input\n      const apiKeyInputContainer = document.getElementById(\"api-key-input-container\");\n      if (apiKeyInputContainer) {\n        apiKeyInputContainer.style.display = \"block\";\n      }\n      \n      updateActionButtonLabels(false);\n      isAuthenticated = false;\n    }\n  } catch (error) {\n    // Hide loading state\n    toggleAuthLoadingState(false);\n    \n    // Show error message\n    showAuthError(\"An error occurred. Please try again.\");\n    Logger.error(\"Authentication error:\", error);\n  }\n}\n\n/**\n * Handle the Test Connection button click\n */\nasync function handleTestConnection() {\n  try {\n    // Get the API key from the input field (if visible)\n    const apiKeyInput = document.getElementById(\"api-key-input\") as HTMLInputElement;\n    let apiKey = apiKeyInput?.value?.trim();\n    \n    // If input is not visible or empty, we need to use the stored key\n    if (!apiKeyInput || apiKeyInput.style.display === \"none\" || !apiKey) {\n      // Check if a stored API Key exists\n      const hasStoredKey = apiService.checkForStoredApiKey();\n      \n      // If we have a stored key but don't have access to it directly,\n      // we can just proceed with testing the connection using whatever\n      // the API service already has\n      if (!hasStoredKey) {\n        showAuthError(\"No API Key available. Please enter an API Key.\");\n        return;\n      }\n      \n      // We'll just test with the key that's already set in the service\n    } else {\n      // We have a new key from the input, set it before testing\n      apiService.setApiKey(apiKey);\n    }\n    \n    // Show loading state\n    toggleAuthLoadingState(true);\n    \n    // Test the connection\n    const isValid = await testApiConnection();\n    \n    // Hide loading state\n    toggleAuthLoadingState(false);\n    \n    if (isValid) {\n      // Success - show success message and enable continue button\n      clearAuthError();\n      showAuthSuccess(\"Connection successful! API Key verified.\");\n      \n      // Get the authentication header and instruction text\n      const authHeader = document.querySelector(\".auth-container h3.ms-font-l\");\n      const authInstructions = document.querySelector(\".auth-container p.ms-font-m\");\n      \n      // Update text for authenticated users\n      if (authHeader) {\n        authHeader.textContent = \"API Key Detected\";\n      }\n      \n      if (authInstructions) {\n        authInstructions.textContent = \"Your API key has been detected. You can proceed to the main menu or verify your connection.\";\n      }\n      \n      // Update the UI to authenticated state\n      const apiKeyInputContainer = document.getElementById(\"api-key-input-container\");\n      if (apiKeyInputContainer) {\n        apiKeyInputContainer.style.display = \"none\";\n      }\n      \n      // Show the continue button\n      const continueToMenuContainer = document.getElementById(\"continue-to-menu-container\");\n      if (continueToMenuContainer) {\n        continueToMenuContainer.style.display = \"flex\";\n        continueToMenuContainer.innerHTML = \"\";\n        \n        const continueButton = document.createElement(\"button\");\n        continueButton.id = \"continue-to-menu-button\";\n        continueButton.className = \"ms-Button ms-Button--icon continue-to-menu-button\";\n        continueButton.innerHTML = `\n          <span class=\"ms-Button-label\">Main Menu</span>\n          <span class=\"ms-Button-icon\">\n            <i class=\"ms-Icon ms-Icon--ChevronRight\"></i>\n          </span>\n        `;\n        continueButton.addEventListener(\"click\", showAgentsView);\n        \n        continueToMenuContainer.appendChild(continueButton);\n      }\n      \n      // Hide status message\n      const statusMessageContainer = document.getElementById(\"api-key-status-message\");\n      if (statusMessageContainer) {\n        statusMessageContainer.style.display = \"none\";\n      }\n      \n      // Show Clear API Keys button\n      const clearApiKeysButton = document.getElementById(\"clear-api-keys-button\");\n      if (clearApiKeysButton) {\n        clearApiKeysButton.style.display = \"inline-block\";\n      }\n      \n      updateActionButtonLabels(true);\n      isAuthenticated = true;\n      \n      // Automatically proceed to the Main Menu after a brief delay\n      // This gives the user a chance to see the success message first\n      setTimeout(() => {\n        showAgentsView();\n      }, 1000);\n\n    } else {\n      \n      // Failed - show error message\n      showAuthError(\"Invalid API key. Please check and try again.\");\n      apiService.clearApiKey();\n      \n      // Reset UI text\n      const authHeader = document.querySelector(\".auth-container h3.ms-font-l\");\n      const authInstructions = document.querySelector(\".auth-container p.ms-font-m\");\n      \n      if (authHeader) {\n        authHeader.textContent = \"Authentication Required\";\n      }\n      \n      if (authInstructions) {\n        authInstructions.textContent = \"Please enter your Octagon API key to continue:\";\n      }\n      \n      // Show the API key input\n      const apiKeyInputContainer = document.getElementById(\"api-key-input-container\");\n      if (apiKeyInputContainer) {\n        apiKeyInputContainer.style.display = \"block\";\n      }\n      \n      updateActionButtonLabels(false);\n      isAuthenticated = false;\n    }\n  } catch (error) {\n    // Hide loading state\n    toggleAuthLoadingState(false);\n    \n    // Show error message\n    showAuthError(\"An error occurred. Please try again.\");\n    Logger.error(\"Authentication error:\", error);\n  }\n}\n\n/**\n * Handle the Clear API Keys button click\n */\nfunction handleClearApiKeys() {\n  apiService.clearApiKey();\n  isAuthenticated = false;\n  hasAutoRedirected = false; // Reset the auto-redirect flag\n  \n  // Reset the API key input\n  const apiKeyInput = document.getElementById(\"api-key-input\") as HTMLInputElement;\n  if (apiKeyInput) {\n    apiKeyInput.value = \"\";\n  }\n  \n  // Update the authentication header and instruction text\n  const authHeader = document.querySelector(\".auth-container h3.ms-font-l\");\n  const authInstructions = document.querySelector(\".auth-container p.ms-font-m\");\n  \n  if (authHeader) {\n    authHeader.textContent = \"Authentication Required\";\n  }\n  \n  if (authInstructions) {\n    authInstructions.textContent = \"Please enter your Octagon API key to continue:\";\n  }\n  \n  // Show the API key input container\n  const apiKeyInputContainer = document.getElementById(\"api-key-input-container\");\n  if (apiKeyInputContainer) {\n    apiKeyInputContainer.style.display = \"block\";\n  }\n  \n  // Hide the continue button\n  const continueToMenuContainer = document.getElementById(\"continue-to-menu-container\");\n  if (continueToMenuContainer) {\n    continueToMenuContainer.style.display = \"none\";\n  }\n  \n  // Hide the Clear API Keys button since there's no stored key anymore\n  const clearApiKeysButton = document.getElementById(\"clear-api-keys-button\");\n  if (clearApiKeysButton) {\n    clearApiKeysButton.style.display = \"none\";\n  }\n  \n  // Update status message\n  const statusMessageContainer = document.getElementById(\"api-key-status-message\");\n  if (statusMessageContainer) {\n    statusMessageContainer.textContent = \"All stored API Keys have been cleared. Please provide a new API Key to continue.\";\n    statusMessageContainer.style.display = \"block\";\n  }\n  \n  // Update button labels\n  updateActionButtonLabels(false);\n  \n  Logger.info(\"All API Keys cleared\");\n}\n\n/**\n * Test the API connection\n * @returns Promise<boolean> True if connection is valid, false otherwise\n */\nasync function testApiConnection(): Promise<boolean> {\n  try {\n    Logger.info(\"Testing API connection\");\n    const response = await apiService.testConnection();\n    \n    Logger.info(`API test response: ${JSON.stringify(response)}`);\n    \n    return response.success;\n  } catch (error) {\n    Logger.error(\"API test connection error:\", error);\n    return false;\n  }\n}\n\n/**\n * Show authentication error message\n * @param message Error message to display\n */\nfunction showAuthError(message: string) {\n  const errorElement = document.getElementById(\"auth-error\");\n  if (errorElement) {\n    errorElement.textContent = message;\n    errorElement.style.display = \"block\";\n  }\n}\n\n/**\n * Show authentication success message (temporarily)\n * @param message Success message to display\n */\nfunction showAuthSuccess(message: string) {\n  const errorElement = document.getElementById(\"auth-error\");\n  if (errorElement) {\n    errorElement.textContent = message;\n    errorElement.style.color = \"green\";\n    errorElement.style.display = \"block\";\n    \n    // Hide the message after 3 seconds\n    setTimeout(() => {\n      clearAuthError();\n    }, 3000);\n  }\n}\n\n/**\n * Clear authentication error message\n */\nfunction clearAuthError() {\n  const errorElement = document.getElementById(\"auth-error\");\n  if (errorElement) {\n    errorElement.textContent = \"\";\n    errorElement.style.display = \"none\";\n    errorElement.style.color = \"#a80000\"; // Reset to error color\n  }\n}\n\n/**\n * Toggle the loading state during authentication\n * @param isLoading Whether to show or hide the loading state\n */\nfunction toggleAuthLoadingState(isLoading: boolean) {\n  const submitButton = document.getElementById(\"submit-button\");\n  const testConnectionButton = document.getElementById(\"test-connection-button\");\n  const spinner = document.getElementById(\"auth-spinner\");\n  \n  if (spinner) {\n    if (isLoading) {\n      if (submitButton) submitButton.setAttribute(\"disabled\", \"true\");\n      if (testConnectionButton) testConnectionButton.setAttribute(\"disabled\", \"true\");\n      spinner.style.display = \"block\";\n    } else {\n      if (submitButton) submitButton.removeAttribute(\"disabled\");\n      if (testConnectionButton) testConnectionButton.removeAttribute(\"disabled\");\n      spinner.style.display = \"none\";\n    }\n  }\n}\n\n/**\n * Show the agents view and populate it with agent data\n */\nfunction showAgentsView() {\n  const authView = document.getElementById(\"auth-view\");\n  const agentsView = document.getElementById(\"agents-view\");\n  \n  if (authView && agentsView) {\n    authView.style.display = \"none\";\n    agentsView.style.display = \"block\";\n    agentsView.classList.add(\"fade-in\");\n    \n    // Hide the old back-to-auth button in the header (if it exists)\n    const oldBackButton = document.getElementById(\"back-to-auth-button-header\");\n    if (oldBackButton) {\n      oldBackButton.style.display = \"none\";\n    }\n    \n    // Populate the agents list\n    populateAgentsList();\n  }\n}\n\n/**\n * Populate the agents list with categories and agent cards\n */\nfunction populateAgentsList() {\n  const container = document.getElementById(\"agent-categories-container\");\n  \n  if (!container) return;\n  \n  // Clear the container\n  container.innerHTML = \"\";\n  \n  // Group agents by category\n  const agentsByCategory = groupAgentsByCategory();\n  \n  // Create a section for each category\n  for (const [category, agents] of Object.entries(agentsByCategory)) {\n    // Create category container\n    const categoryElement = document.createElement(\"div\");\n    categoryElement.className = \"agent-category\";\n    \n    // Create category title\n    const titleElement = document.createElement(\"h3\");\n    titleElement.className = \"category-title\";\n    titleElement.textContent = category;\n    categoryElement.appendChild(titleElement);\n    \n    // Create agent cards for this category\n    agents.forEach(agent => {\n      const agentCard = createAgentCard(agent);\n      categoryElement.appendChild(agentCard);\n    });\n    \n    // Add the category to the container\n    container.appendChild(categoryElement);\n  }\n  \n  // Add a small back button at the bottom of the container\n  const backButtonContainer = document.createElement(\"div\");\n  backButtonContainer.className = \"back-button-container\";\n  \n  const backButton = document.createElement(\"button\");\n  backButton.id = \"back-to-auth-button\";\n  backButton.className = \"ms-Button ms-Button--icon back-to-login-button\";\n  backButton.innerHTML = `\n    <span class=\"ms-Button-icon\">\n      <i class=\"ms-Icon ms-Icon--ChevronLeft\"></i>\n    </span>\n    <span class=\"ms-Button-label\">Back to Log In</span>\n  `;\n  backButton.addEventListener(\"click\", showAuthView);\n  \n  backButtonContainer.appendChild(backButton);\n  container.appendChild(backButtonContainer);\n}\n\n/**\n * Group agents by their category\n * @returns Record<string, typeof OCTAGON_AGENTS[0][]>\n */\nfunction groupAgentsByCategory() {\n  const categories: Record<string, typeof OCTAGON_AGENTS[0][]> = {};\n  \n  OCTAGON_AGENTS.forEach(agent => {\n    if (!categories[agent.category]) {\n      categories[agent.category] = [];\n    }\n    categories[agent.category].push(agent);\n  });\n  \n  return categories;\n}\n\n/**\n * Create an agent card element\n * @param agent Agent information\n * @returns HTMLElement The agent card\n */\nfunction createAgentCard(agent: typeof OCTAGON_AGENTS[0]): HTMLElement {\n  const card = document.createElement(\"div\");\n  card.className = \"agent-card\";\n  \n  // Agent title\n  const title = document.createElement(\"h4\");\n  title.className = \"agent-title\";\n  title.textContent = agent.displayName;\n  card.appendChild(title);\n  \n  // Agent description\n  const description = document.createElement(\"p\");\n  description.className = \"agent-description\";\n  description.textContent = agent.description;\n  card.appendChild(description);\n  \n  // Agent metadata\n  const meta = document.createElement(\"div\");\n  meta.className = \"agent-meta\";\n  \n  // Formula name\n  const formula = document.createElement(\"div\");\n  formula.innerHTML = `<strong>Excel Formula:</strong> <span class=\"formula-name\">${agent.excelFormulaName}(\"your prompt\")</span>`;\n  meta.appendChild(formula);\n  \n  // Example prompt\n  if (agent.examplePrompt) {\n    const example = document.createElement(\"div\");\n    example.innerHTML = `<strong>Example:</strong>`;\n    \n    // Create a container for the prompt to allow positioning the copy button\n    const promptContainer = document.createElement(\"div\");\n    promptContainer.style.position = \"relative\";\n    promptContainer.style.display = \"inline-block\";\n    promptContainer.style.width = \"100%\";\n    \n    const promptElement = document.createElement(\"span\");\n    promptElement.className = \"example-prompt\";\n    promptElement.textContent = agent.examplePrompt;\n    promptContainer.appendChild(promptElement);\n    \n    // Add copy button for the example prompt\n    const copyButton = document.createElement(\"button\");\n    copyButton.className = \"copy-button\";\n    copyButton.title = \"Copy example\";\n    copyButton.innerHTML = '<i class=\"ms-Icon ms-Icon--Copy\"></i>';\n    copyButton.onclick = (e) => {\n      e.stopPropagation();\n      navigator.clipboard.writeText(agent.examplePrompt)\n        .then(() => {\n          // Show success feedback\n          copyButton.innerHTML = '<i class=\"ms-Icon ms-Icon--CheckMark copy-success\"></i>';\n          setTimeout(() => {\n            copyButton.innerHTML = '<i class=\"ms-Icon ms-Icon--Copy\"></i>';\n          }, 1500);\n        })\n        .catch(err => {\n          console.error('Could not copy text: ', err);\n        });\n    };\n    \n    promptContainer.appendChild(copyButton);\n    example.appendChild(promptContainer);\n    meta.appendChild(example);\n  }\n  \n  card.appendChild(meta);\n  \n  // Usage examples section (if available)\n  if (agent.usageExamples && agent.usageExamples.length > 0) {\n    const usageSection = document.createElement(\"div\");\n    usageSection.className = \"usage-examples-section\";\n    \n    // Usage examples heading\n    const usageHeading = document.createElement(\"h5\");\n    usageHeading.className = \"usage-heading\";\n    usageHeading.textContent = \"Usage Examples:\";\n    usageSection.appendChild(usageHeading);\n    \n    // Create a list for the examples\n    const examplesList = document.createElement(\"div\");\n    examplesList.className = \"examples-list\";\n    \n    // Add each example to the list\n    agent.usageExamples.forEach(example => {\n      const exampleItem = document.createElement(\"div\");\n      exampleItem.className = \"example-item\";\n      \n      const topicElement = document.createElement(\"div\");\n      topicElement.className = \"example-topic\";\n      topicElement.textContent = example.topic;\n      exampleItem.appendChild(topicElement);\n      \n      // Create a container for the prompt to allow positioning the copy button\n      const promptContainer = document.createElement(\"div\");\n      promptContainer.className = \"example-prompt-container\";\n      promptContainer.style.position = \"relative\";\n      \n      const promptElement = document.createElement(\"div\");\n      promptElement.className = \"example-prompt code\";\n      promptElement.textContent = example.prompt;\n      promptContainer.appendChild(promptElement);\n      \n      // Add copy button\n      const copyButton = document.createElement(\"button\");\n      copyButton.className = \"copy-button\";\n      copyButton.title = \"Copy example\";\n      copyButton.innerHTML = '<i class=\"ms-Icon ms-Icon--Copy\"></i>';\n      copyButton.onclick = (e) => {\n        e.stopPropagation();\n        navigator.clipboard.writeText(example.prompt)\n          .then(() => {\n            // Show success feedback\n            copyButton.innerHTML = '<i class=\"ms-Icon ms-Icon--CheckMark copy-success\"></i>';\n            setTimeout(() => {\n              copyButton.innerHTML = '<i class=\"ms-Icon ms-Icon--Copy\"></i>';\n            }, 1500);\n          })\n          .catch(err => {\n            console.error('Could not copy text: ', err);\n          });\n      };\n      \n      promptContainer.appendChild(copyButton);\n      exampleItem.appendChild(promptContainer);\n      \n      examplesList.appendChild(exampleItem);\n    });\n    \n    usageSection.appendChild(examplesList);\n    card.appendChild(usageSection);\n  }\n  \n  return card;\n}\n\n/**\n * Shows a browser compatibility warning to the user\n */\nfunction showBrowserWarning(message: string) {\n  const warningDiv = document.createElement('div');\n  warningDiv.className = 'browser-warning';\n  warningDiv.innerHTML = `\n    <div class=\"warning-icon\"><i class=\"ms-Icon ms-Icon--Warning\"></i></div>\n    <div class=\"warning-message\">${message}</div>\n  `;\n  \n  // Insert at the top of the body or in a specific container\n  const container = document.querySelector('.content-container') || document.body;\n  container.insertBefore(warningDiv, container.firstChild);\n}\n\n/**\n * Shows API support warnings to the user\n */\nfunction showApiSupportWarning(issues: string[]) {\n  const warningDiv = document.createElement('div');\n  warningDiv.className = 'api-support-warning';\n  \n  let warningHtml = `\n    <div class=\"warning-icon\"><i class=\"ms-Icon ms-Icon--Warning\"></i></div>\n    <div class=\"warning-message\">\n      <p>Some features may not work correctly in your current environment:</p>\n      <ul>\n  `;\n  \n  issues.forEach(issue => {\n    warningHtml += `<li>${issue}</li>`;\n  });\n  \n  warningHtml += `\n      </ul>\n    </div>\n  `;\n  \n  warningDiv.innerHTML = warningHtml;\n  \n  // Insert after the browser warning or at the top\n  const container = document.querySelector('.content-container') || document.body;\n  const existingWarning = document.querySelector('.browser-warning');\n  \n  if (existingWarning) {\n    container.insertBefore(warningDiv, existingWarning.nextSibling);\n  } else {\n    container.insertBefore(warningDiv, container.firstChild);\n  }\n}","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_1___ = new URL(\"../../assets/icon-80.png\", import.meta.url);\n// Module\nvar code = \"<!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Octagon AI - Market Intelligence for Excel</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"ms-font-m ms-Fabric\\\"> <header class=\\\"octagon-header ms-bgColor-neutralLighter\\\"> <img width=\\\"90\\\" height=\\\"90\\\" src=\\\"\" + ___HTML_LOADER_IMPORT_1___ + \"\\\" alt=\\\"Octagon AI\\\" title=\\\"Octagon AI\\\"/> <h1 class=\\\"ms-font-su\\\">Octagon AI</h1> </header> <section id=\\\"sideload-msg\\\" class=\\\"ms-welcome__main\\\"> <h2 class=\\\"ms-font-xl\\\">Please <a target=\\\"_blank\\\" href=\\\"https://learn.microsoft.com/office/dev/add-ins/testing/test-debug-office-add-ins#sideload-an-office-add-in-for-testing\\\">sideload</a> your add-in to see app body.</h2> </section> <main id=\\\"auth-view\\\" class=\\\"main-content\\\" style=\\\"display:none\\\"> <div class=\\\"content-container\\\"> <h2 class=\\\"ms-font-xl\\\">Welcome to Octagon AI</h2> <p class=\\\"ms-font-m description\\\"> Access real-time market intelligence and financial data directly in Excel with Octagon AI agents. </p> <div id=\\\"api-key-status-message\\\" class=\\\"status-message\\\"></div> <div class=\\\"auth-container\\\"> <h3 class=\\\"ms-font-l\\\">Authentication Required</h3> <p class=\\\"ms-font-m\\\">Please enter your Octagon API key to continue:</p> <div id=\\\"api-key-input-container\\\" class=\\\"form-group\\\"> <input type=\\\"password\\\" id=\\\"api-key-input\\\" class=\\\"ms-TextField-field\\\" placeholder=\\\"Enter your API key here\\\"/> <div id=\\\"auth-error\\\" class=\\\"error-message\\\" style=\\\"display:none\\\"></div> </div> <div class=\\\"button-container\\\"> <button id=\\\"submit-button\\\" class=\\\"ms-Button ms-Button--primary\\\"> <span class=\\\"ms-Button-label\\\">Submit</span> </button> <button id=\\\"test-connection-button\\\" class=\\\"ms-Button ms-Button--default\\\"> <span class=\\\"ms-Button-label\\\">Test Connection</span> </button> <button id=\\\"clear-api-keys-button\\\" class=\\\"ms-Button ms-Button--default\\\" style=\\\"display:none\\\"> <span class=\\\"ms-Button-label\\\">Clear API Keys</span> </button> <div id=\\\"auth-spinner\\\" class=\\\"ms-Spinner\\\" style=\\\"display:none\\\"></div> </div> <div id=\\\"continue-to-menu-container\\\" class=\\\"continue-button-container\\\" style=\\\"display:none;margin-top:16px\\\"> <button id=\\\"continue-to-menu-button\\\" class=\\\"ms-Button ms-Button--primary\\\"> <span class=\\\"ms-Button-label\\\">Continue to Main Menu</span> </button> </div> <p class=\\\"ms-font-s signup-link\\\"> Don't have an API key? <a href=\\\"https://www.octagonai.co/\\\" target=\\\"_blank\\\">Get one here</a> </p> </div> </div> <div class=\\\"footer\\\"> <div class=\\\"version\\\">Version 1.0.0</div> <div class=\\\"footer-links\\\"> <a href=\\\"https://www.octagonai.co/terms-of-service\\\" target=\\\"_blank\\\">Terms of Service</a> | <a href=\\\"https://www.octagonai.co/privacy\\\" target=\\\"_blank\\\">Privacy</a> | <a href=\\\"mailto:contact@octagonai.co\\\">Contact</a> | <a href=\\\"https://app.octagonagents.com/playground\\\" target=\\\"_blank\\\">API Playground</a> </div> </div> </main> <main id=\\\"agents-view\\\" class=\\\"main-content\\\" style=\\\"display:none\\\"> <div class=\\\"content-container\\\"> <div class=\\\"header-actions\\\"> <h2 class=\\\"ms-font-xl\\\">Available Agents</h2> </div> <p class=\\\"ms-font-m description\\\"> Use the following Octagon agents in your Excel formulas. </p> <div id=\\\"agent-categories-container\\\"></div> <div class=\\\"additional-resources\\\"> <h3>Resources</h3> <ul> <li> <i class=\\\"ms-Icon ms-Icon--ReadingMode\\\"></i> <a href=\\\"https://docs.octagonagents.com/\\\" target=\\\"_blank\\\">Official Documentation</a> </li> <li> <i class=\\\"ms-Icon ms-Icon--TestBeaker\\\"></i> <a href=\\\"https://app.octagonagents.com/playground\\\" target=\\\"_blank\\\">API Playground</a> </li> </ul> </div> </div> <div class=\\\"footer\\\"> <div class=\\\"version\\\">Version 1.0</div> <div class=\\\"footer-links\\\"> <a href=\\\"https://www.octagonai.co/terms-of-service\\\" target=\\\"_blank\\\">Terms of Service</a> | <a href=\\\"https://www.octagonai.co/privacy\\\" target=\\\"_blank\\\">Privacy</a> | <a href=\\\"mailto:contact@octagonai.co\\\">Contact</a> </div> </div> </main> </body> </html>\";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","LogLevel","currentLogLevel","ERROR","logLevelPriority","_defineProperty","DEBUG","INFO","WARN","log","level","message","data","timestamp","Date","toISOString","formattedMessage","concat","console","debug","info","warn","error","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","d","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","_defineProperties","_toPropertyKey","key","_typeof","toPrimitive","String","_toPrimitive","API_KEY_STORAGE_NAME","CACHED_SESSION_SETTINGS_KEY","OctagonApiService","apiUrl","_classCallCheck","Logger","isOfficeInitialized","loadApiKey","isAuthenticated","cachedSessionData","sessionStorage","getItem","sessionData","JSON","parse","octagon_api_key","apiKey","saveApiKey","setItem","stringify","newSessionData","_callAgent","_callee","agentId","prompt","requestData","response","_context","substring","model","input","stream","apiRequest","success","_x","_x2","parseError","directApiKey","trim","removeItem","_apiRequest","_callee2","endpoint","method","url","headers","requestBody","errorText","streamedResponse","_t","_args2","_context2","Headers","contentType","get","authorization","fetch","body","status","statusText","ok","text","handleStreamedResponse","_x3","_handleStreamedResponse","_callee3","_response$body","_finalResponse","_finalResponse2","_finalResponse3","_finalResponse4","reader","fullText","finalResponse","parseErrorCount","_yield$reader$read","chunk","lines","_iterator","_step","line","jsonStr","_data$part","transformedResponse","_t2","_t3","_t4","_t5","_context3","getReader","read","TextDecoder","decode","split","_createForOfIteratorHelper","s","startsWith","type","delta","part","output","content","id","created","created_at","now","rawResponse","contentLength","hasId","hasModel","outputItems","_x4","_testConnection","_callee4","result","_t6","_context4","max_tokens","hasContent","hasChoices","Array","isArray","choices","responseKeys","keys","_ResponseEndpoint","_callee5","query","_args5","_context5","_x5","_x6","octagonApiService","OCTAGON_AGENTS","excelFormulaName","description","category","AgentCategory","MarketIntelligence","usageExamples","topic","detectIE","ua","navigator","userAgent","msie","indexOf","trident","checkRequiredApiSupport","issues","Office","context","requirements","isSetSupported","push","platform","host","PlatformType","PC","Mac","OfficeOnline","HostType","Excel","checkPlatformCompatibility","apiService","isCheckingApiKey","hasAutoRedirected","setupEventListeners","submitButton","getElementById","addEventListener","handleSubmit","testConnectionButton","handleTestConnection","clearApiKeysButton","handleClearApiKeys","continueToMenuButton","showAgentsView","apiKeyInput","event","showAuthView","authView","agentsView","style","display","classList","add","setTimeout","hasStoredKey","checkForStoredApiKey","statusMessageContainer","continueToMenuContainer","apiKeyInputContainer","authHeader","querySelector","authInstructions","textContent","innerHTML","continueButton","createElement","className","appendChild","updateActionButtonLabels","checkApiKeyStatus","_handleSubmit","_apiKeyInput$value","isValid","_authHeader","_authInstructions","_apiKeyInputContainer","showAuthError","setApiKey","toggleAuthLoadingState","testApiConnection","clearAuthError","showAuthSuccess","clearApiKey","_handleTestConnection","_apiKeyInput$value2","_authHeader2","_authInstructions2","_apiKeyInputContainer2","_testApiConnection","testConnection","errorElement","color","isLoading","spinner","setAttribute","removeAttribute","oldBackButton","container","agentsByCategory","categories","forEach","agent","groupAgentsByCategory","_loop","_Object$entries$_i","_Object$entries","_i","agents","categoryElement","titleElement","agentCard","card","title","meta","formula","examplePrompt","example","promptContainer","position","width","promptElement","copyButton","onclick","stopPropagation","clipboard","writeText","catch","err","usageSection","usageHeading","examplesList","exampleItem","topicElement","createAgentCard","entries","backButtonContainer","backButton","populateAgentsList","showBrowserWarning","warningDiv","insertBefore","firstChild","showApiSupportWarning","warningHtml","issue","existingWarning","nextSibling","onReady","_ref","apiSupportIssues","initialize","URL"],"sourceRoot":""}