{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://excel-custom-functions/webpack/bootstrap","webpack://excel-custom-functions/webpack/runtime/global","webpack://excel-custom-functions/webpack/runtime/hasOwnProperty shorthand","webpack://excel-custom-functions/webpack/runtime/publicPath","webpack://excel-custom-functions/webpack/runtime/jsonp chunk loading","webpack://excel-custom-functions/./src/utils/logger.ts","webpack://excel-custom-functions/./src/api/format.ts","webpack://excel-custom-functions/./src/api/types.ts","webpack://excel-custom-functions/./src/api/octagonApi.ts","webpack://excel-custom-functions/./src/utils/browserSupport.ts","webpack://excel-custom-functions/./src/taskpane/examples.ts","webpack://excel-custom-functions/./src/taskpane/taskpane.ts","webpack://excel-custom-functions/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/**\n * Logging utility for Octagon Excel Add-in\n * This module provides centralized logging functionality with different log levels\n * to help debug issues during development and production.\n */\n\n// Log levels\nexport enum LogLevel {\n  DEBUG = 'DEBUG',\n  INFO = 'INFO',\n  WARN = 'WARN',\n  ERROR = 'ERROR'\n}\n\n// Current log level - can be adjusted based on environment\nlet currentLogLevel: LogLevel = \n  process.env.NODE_ENV === 'production' ? LogLevel.ERROR : LogLevel.DEBUG;\n\n// Log level priority (used to determine if a message should be logged)\nconst logLevelPriority: Record<LogLevel, number> = {\n  [LogLevel.DEBUG]: 0,\n  [LogLevel.INFO]: 1,\n  [LogLevel.WARN]: 2,\n  [LogLevel.ERROR]: 3\n};\n\n/**\n * Main logging function that handles all log levels\n */\nexport function log(level: LogLevel, message: string, data?: any): void {\n  // Only log if the current level priority is less than or equal to the message level\n  if (logLevelPriority[level] >= logLevelPriority[currentLogLevel]) {\n    const timestamp = new Date().toISOString();\n    const formattedMessage = `[${timestamp}] [${level}] ${message}`;\n\n    switch (level) {\n      case LogLevel.DEBUG:\n        console.debug(formattedMessage, data || '');\n        break;\n      case LogLevel.INFO:\n        console.info(formattedMessage, data || '');\n        break;\n      case LogLevel.WARN:\n        console.warn(formattedMessage, data || '');\n        break;\n      case LogLevel.ERROR:\n        console.error(formattedMessage, data || '');\n        break;\n    }\n  }\n}\n\n/**\n * Set the current log level\n */\nexport function setLogLevel(level: LogLevel): void {\n  currentLogLevel = level;\n  log(LogLevel.INFO, `Log level set to ${level}`);\n}\n\n/**\n * Get all logs stored in session storage\n */\nexport function getLogs(): any[] {\n  try {\n    return JSON.parse(sessionStorage.getItem('octagon_logs') || '[]');\n  } catch (e) {\n    console.error('[Logger] Error retrieving logs from sessionStorage:', e);\n    return [];\n  }\n}\n\n/**\n * Clear all logs in session storage\n */\nexport function clearLogs(): void {\n  try {\n    sessionStorage.removeItem('octagon_logs');\n  } catch (e) {\n    // Log the error instead of silently failing\n    console.error('[Logger] Error clearing logs from sessionStorage:', e);\n  }\n}\n\n// Convenience methods for each log level\nexport const debug = (message: string, data?: any) => log(LogLevel.DEBUG, message, data);\nexport const info = (message: string, data?: any) => log(LogLevel.INFO, message, data);\nexport const warn = (message: string, data?: any) => log(LogLevel.WARN, message, data);\nexport const error = (message: string, data?: any) => log(LogLevel.ERROR, message, data);\n\n// Export a default logger object\nexport default {\n  debug,\n  info,\n  warn,\n  error,\n  setLogLevel,\n  getLogs,\n  clearLogs\n};","/* global CustomFunctions */\n\nimport Logger from \"../utils/logger\";\nimport type { OutputFormat } from \"./types\";\n\nconst RAW_TEXT = {\n  format: { type: \"text\" },\n};\n\nconst TABLE_FORMAT = {\n  format: {\n    type: \"json_schema\",\n    strict: true,\n    name: \"TableFormat\",\n    schema: {\n      properties: {\n        data: {\n          description:\n            \"Nested list of values for multiple spreadsheet cells. Outer list represents rows, inner list represents columns. Each element in the inner list is a cell value.\",\n          items: { items: { anyOf: [{ type: \"number\" }, { type: \"string\" }] }, type: \"array\" },\n          type: \"array\",\n        },\n      },\n      required: [\"data\"],\n      title: \"ExcelFormat\",\n      type: \"object\",\n      additionalProperties: false,\n    },\n  },\n};\n\nconst SINGLE_CELL_FORMAT = {\n  format: {\n    type: \"json_schema\",\n    strict: true,\n    name: \"SingleCellFormat\",\n    schema: {\n      properties: {\n        data: {\n          anyOf: [{ type: \"number\" }, { type: \"string\" }],\n          description: \"Single value of a spreadsheet cell\",\n          title: \"Data\",\n        },\n      },\n      required: [\"data\"],\n      title: \"ExcelCell\",\n      type: \"object\",\n      additionalProperties: false,\n    },\n  },\n};\n\nconst formatMap: Record<OutputFormat, { format: { type: string } }> = {\n  raw: RAW_TEXT,\n  table: TABLE_FORMAT,\n  cell: SINGLE_CELL_FORMAT,\n};\n\nexport function getTextFormat(format: string): { format: { type: string } } {\n  const textFormat = formatMap[format];\n  if (!textFormat) {\n    Logger.error(`Invalid format: ${format}`);\n    throw new CustomFunctions.Error(\n      CustomFunctions.ErrorCode.invalidValue,\n      'Invalid format. Please use \"raw\", \"table\", or \"cell\"'\n    );\n  }\n\n  return textFormat;\n}\n\nexport function parseTextFormat(\n  content: string,\n  format: OutputFormat\n): Array<Array<string | number>> {\n  // Default response is a single row with a single cell containing \"No response content\"\n  const defaultResponse = [[\"No response content\"]];\n\n  try {\n    if (format == \"table\") {\n      return JSON.parse(content).data ?? defaultResponse;\n    } else if (format == \"cell\") {\n      const data = JSON.parse(content).data;\n      return data !== undefined ? [[data]] : defaultResponse;\n    } else {\n      return [[content]];\n    }\n  } catch (error) {\n    // Fallback if content is not valid JSON for table and single cell format\n    Logger.error(\"Error parsing text format:\", { error, content, format });\n    return defaultResponse;\n  }\n}\n","/**\n * Octagon API TypeScript Interfaces\n * These interfaces define the contract between our Excel Add-in and the Octagon API.\n */\n\n// ==================== COMMON API TYPES ====================\n\n// Common API response structure\nexport interface ApiResponse<T> {\n  success: boolean;\n  data?: T;\n  error?: string;\n}\n\n// ==================== OPENAI COMPATIBLE TYPES ====================\n\n// OpenAI-style message structure\nexport interface ChatMessage {\n  role: \"system\" | \"user\" | \"assistant\";\n  content: string;\n}\n\n// OpenAI-style choice structure\nexport interface StreamChoice {\n  index: number;\n  message: ChatMessage;\n  finish_reason: \"stop\" | \"length\" | \"function_call\" | \"content_filter\" | null;\n}\n\n// OpenAI-style usage statistics\nexport interface StreamUsage {\n  prompt_tokens: number;\n  completion_tokens: number;\n  total_tokens: number;\n}\n\n// OpenAI-style responses endpoint response\nexport interface StreamResponse {\n  id: string;\n  object: \"responses\";\n  created: number;\n  model: string;\n  choices: StreamChoice[];\n  usage?: StreamUsage;\n  // Adding new fields for Octagon specific response structure\n  content?: string;\n  output?: any[];\n  rawResponse?: any;\n  status?: string;\n  text?: any;\n}\n\n// ==================== AGENT TYPES ====================\n\nexport enum AgentType {\n  OctagonAgent = \"octagon-agent\",\n}\n\n// ==================== REQUEST/RESPONSE TYPES ====================\n\nexport interface AgentRequest {\n  model: string;\n  input: string;\n  max_tokens?: number;\n  text?: { format: { type: string } };\n}\n\n// Detailed agent response with content and structured data\nexport interface AgentResponse {\n  content: string;\n  // Additional fields that might be in the Octagon API response\n  model?: string;\n  created?: number;\n  id?: string;\n  [key: string]: any; // Allow for additional unknown properties\n}\n\n// ==================== UTILITY TYPES ====================\n\n// Type aliases for common data structures\nexport type Option<T = string> = { value: T; label: string };\nexport type Maybe<T> = T | null | undefined;\n\nexport type OutputFormat = \"raw\" | \"table\" | \"cell\";\n\n// ==================== EXCEL INTEGRATION TYPES ====================\n\n// Excel table formatting options\nexport interface ExcelTableOptions {\n  hasHeaders?: boolean;\n  showTotals?: boolean;\n  tableName?: string;\n  tableStyle?: string;\n}\n\n// Excel insertion result\nexport interface ExcelInsertionResult {\n  success: boolean;\n  rowsInserted: number;\n  columnsInserted: number;\n  range?: string;\n  error?: string;\n}\n\n// ==================== ERROR HANDLING TYPES ====================\n\n// Standardized error response\nexport interface ErrorResponse {\n  error: {\n    code: string;\n    message: string;\n    type: \"api_error\" | \"rate_limit_exceeded\" | \"invalid_request\" | \"authentication_error\";\n    param?: string;\n  };\n}\n","/**\n * Octagon API Service Defintions\n * This service handles all communication with the Octagon API using OpenAI-compatible endpoints.\n * It provides methods to query agents using the chat/completions pattern.\n */\n\nimport Logger from \"../utils/logger\";\nimport { getTextFormat, parseTextFormat } from \"./format\";\nimport { AgentRequest, AgentResponse, AgentType, OutputFormat } from \"./types\";\n\n// API Configuration\nconst DEFAULT_API_URL = \"https://api-gateway.octagonagents.com\";\n\n// Storage key constants (used with OfficeRuntime.storage)\nconst API_KEY_STORAGE_NAME = \"octagon_api_key\";\n\n/**\n * OctagonApiService class handles all API interactions\n */\nexport class OctagonApiService {\n  private apiKey: string | null = null;\n  private apiUrl: string;\n\n  constructor(apiUrl: string = DEFAULT_API_URL) {\n    this.apiUrl = apiUrl;\n    // Don't automatically initialize in constructor to avoid race conditions\n    // Instead, require explicit initialization after Office.onReady\n  }\n\n  /**\n   * Set the API key for authentication\n   */\n  public async setApiKey(apiKey: string): Promise<void> {\n    const trimmedKey = apiKey.trim() || null;\n    this.apiKey = trimmedKey;\n\n    if (!trimmedKey) {\n      Logger.warn(\"Attempted to set an empty API key; clearing stored key instead\");\n      await this.clearApiKey();\n      return;\n    }\n\n    // Save the API key to OfficeRuntime.storage\n    try {\n      await OfficeRuntime.storage.setItem(API_KEY_STORAGE_NAME, trimmedKey);\n      Logger.debug(\"API key saved to OfficeRuntime.storage\");\n    } catch (error) {\n      Logger.error(\"Failed to save API key to OfficeRuntime.storage\", error);\n    }\n  }\n\n  /**\n   * Call an Octagon agent with a prompt\n   *\n   * @param agentId - The ID of the agent to call\n   * @param prompt - The prompt to send to the agent\n   * @returns A promise that resolves to the agent's response\n   */\n  public async callAgent(\n    model: string,\n    prompt: string,\n    format: string\n  ): Promise<Array<Array<string | number>>> {\n    Logger.debug(`callAgent invoked with model: ${model}, prompt: ${prompt.substring(0, 50)}...`);\n\n    // Validate the prompt\n    if (!prompt || prompt.trim() === \"\") {\n      throw new Error(\"Please provide a valid prompt\");\n    }\n\n    // Ensure add-in has been authenticated\n    if (!(await this.isAuthenticated())) {\n      Logger.error(\"API request failed: Not authenticated\");\n      throw new Error(\"Not authenticated. Please set your API key first.\");\n    }\n\n    const response = await this.createResponse({\n      model,\n      input: prompt,\n      text: getTextFormat(format),\n    });\n\n    // Parse the content of the response as a JSON object if it is a table or single cell\n    return parseTextFormat(response.content || \"No response content\", format as OutputFormat);\n  }\n\n  /**\n   * Load API key from storage (OfficeRuntime.storage)\n   */\n  private async loadApiKey(): Promise<void> {\n    const storedKey = await this.getStoredApiKey();\n\n    if (storedKey) {\n      this.apiKey = storedKey;\n      return;\n    }\n\n    // If we get here, no API key was found\n    this.apiKey = null;\n  }\n\n  /**\n   * Returns true if the API key is set and not empty.\n   * Always reloads from OfficeRuntime.storage to avoid stale cached keys across runtimes.\n   */\n  public async isAuthenticated(): Promise<boolean> {\n    Logger.info(\"isAuthenticated invoked - synchronizing API key from storage\");\n\n    await this.loadApiKey();\n\n    // Return true if the API key is set\n    return !!this.apiKey;\n  }\n\n  /**\n   * Clear stored API key from OfficeRuntime.storage\n   */\n  public async clearApiKey(): Promise<void> {\n    this.apiKey = null;\n\n    try {\n      await OfficeRuntime.storage.removeItem(API_KEY_STORAGE_NAME);\n      Logger.info(\"API key cleared from OfficeRuntime.storage\");\n    } catch (error) {\n      Logger.error(\"Failed to clear API key from OfficeRuntime.storage\", error);\n    }\n  }\n\n  /**\n   * Get the stored API key from OfficeRuntime.storage.\n   */\n  private async getStoredApiKey(): Promise<string | null> {\n    try {\n      const storedValue = await OfficeRuntime.storage.getItem(API_KEY_STORAGE_NAME);\n      if (typeof storedValue === \"string\") {\n        return storedValue;\n      }\n    } catch (error) {\n      Logger.error(\"Failed to read API key from OfficeRuntime.storage\", error);\n    }\n    return null;\n  }\n\n  /**\n   * Generic method to make authenticated API requests\n   * Handles both regular JSON responses and streamed responses\n   */\n  private async createResponse(data: AgentRequest, apiKey?: string): Promise<AgentResponse> {\n    const requestUrl = new URL(\"/v1/responses\", this.apiUrl);\n\n    const token = apiKey ?? this.apiKey;\n    if (!token) {\n      throw new Error(\"No API key provided\");\n    }\n\n    const headers = new Headers({\n      \"Content-Type\": \"application/json\",\n      Authorization: `Bearer ${token}`,\n    });\n\n    const response = await fetch(requestUrl, {\n      method: \"POST\",\n      headers,\n      body: JSON.stringify(data),\n    });\n\n    if (!response.ok) {\n      // Throw an error with HTTP status and message from the API\n      await this.handleApiError(response);\n    }\n\n    // Bubble up any errors from the parseAgentResponse method to the caller\n    return await this.parseAgentResponse(response);\n  }\n\n  /**\n   * Parse the agent response from the Octagon API\n   * @param response - The fetch response object with streamed data\n   * @returns Parsed response data\n   */\n  private async parseAgentResponse(response: Response): Promise<AgentResponse> {\n    try {\n      // Get the reader for the stream\n      const data = await response.json();\n\n      // Ensure the response is in the expected format\n      if (!data.output || !Array.isArray(data.output)) {\n        Logger.warn(\"Unexpected response format: missing output array\", data);\n        return {\n          content: \"\",\n          id: data?.id,\n          model: data?.model,\n        } as AgentResponse;\n      }\n\n      // Create an empty content string, and append the text of each output message to the content\n      let content = \"\";\n\n      for (const output of data.output) {\n        if (output.type !== \"message\") continue;\n        // Ensure the content is in the expected format\n        if (!output.content || !Array.isArray(output.content)) continue;\n\n        // Add the text of each output message to the content\n        for (const message of output.content) {\n          if (message.type !== \"output_text\") continue;\n          content += message.text;\n        }\n      }\n\n      return {\n        content,\n        id: data.id,\n        model: data.model,\n      } as AgentResponse;\n    } catch (error) {\n      Logger.error(\"Error processing agent response:\", error);\n      throw new Error(\"Failed to process agent response\");\n    }\n  }\n\n  /**\n   * Test API key validity with a simple request\n   */\n  public async testConnection(apiKey: string): Promise<boolean> {\n    const request = {\n      model: AgentType.OctagonAgent,\n      input: \"Test connection\",\n      max_tokens: 10,\n    };\n\n    try {\n      // Test the connection with the provided API key\n      await this.createResponse(request, apiKey);\n      return true;\n    } catch (error) {\n      Logger.error(\"Test connection threw an exception\", error);\n      return false;\n    }\n  }\n\n  private async handleApiError(response: Response): Promise<void> {\n    // Parse error message from response\n    let data: { detail: string } | undefined;\n    try {\n      data = await response.json();\n    } catch (error) {\n      // Fallback to unknown error\n      data = { detail: \"Unknown error\" };\n    }\n\n    const status = response.status;\n    const errorMessage = data?.detail ?? \"Unknown error\";\n    Logger.error(\"Agent request failed\", { status, message: errorMessage });\n    throw new Error(`HTTP ${status}: ${errorMessage}`);\n  }\n}\n","/**\n * Browser and API support detection utilities\n * Used to provide compatibility warnings to users\n */\n\nimport Logger from './logger';\n\n/**\n * Detects if the browser is Internet Explorer\n * @returns true if the browser is IE, false otherwise\n */\nexport function detectIE(): boolean {\n  try {\n    const ua = window.navigator.userAgent;\n    const msie = ua.indexOf('MSIE ');\n    const trident = ua.indexOf('Trident/');\n    \n    return (msie > 0 || trident > 0);\n  } catch (error) {\n    Logger.error('Error detecting browser:', error);\n    return false; // Assume not IE if detection fails\n  }\n}\n\n/**\n * Checks if all required APIs are supported in the current environment\n * @returns An array of issues (empty if all requirements are met)\n */\nexport function checkRequiredApiSupport(): string[] {\n  const issues: string[] = [];\n  \n  try {\n    // Check for SharedRuntime support\n    if (!Office.context.requirements.isSetSupported('SharedRuntime', '1.1')) {\n      issues.push(\"This add-in requires SharedRuntime support. Please update to a newer version of Office.\");\n    }\n    \n    // Check for ExcelApi support\n    if (!Office.context.requirements.isSetSupported('ExcelApi', '1.7')) {\n      issues.push(\"Some Excel features require Excel API 1.7 or later. Please update to a newer version of Excel.\");\n    }\n    \n    // Check for CustomFunctions support\n    if (!Office.context.requirements.isSetSupported('CustomFunctions', '1.1')) {\n      issues.push(\"Custom functions require Excel support for CustomFunctions 1.1 or later.\");\n    }\n    \n    // Check if we're in a compatible platform for our add-in\n    checkPlatformCompatibility(issues);\n    \n  } catch (error) {\n    Logger.error('Error checking API support:', error);\n    issues.push(\"Error checking API compatibility. Some features may not work as expected.\");\n  }\n  \n  return issues;\n}\n\n/**\n * Checks platform compatibility and adds any issues to the issues array\n * @param issues Array to add platform compatibility issues to\n */\nfunction checkPlatformCompatibility(issues: string[]): void {\n  // Check if we're in a web browser\n  try {\n    const platform = Office.context.platform;\n    const host = Office.context.host;\n    \n    // Log platform information for diagnostics\n    Logger.info(`Running on platform: ${platform}, host: ${host}`);\n    \n    // Check specific platform requirements\n    if (platform === Office.PlatformType.PC) {\n      // Check for Windows version compatibility if needed\n      // This would require additional detection code\n    } else if (platform === Office.PlatformType.Mac) {\n      // Check for Mac-specific issues if needed\n    } else if (platform === Office.PlatformType.OfficeOnline) {\n      // Check for Office Online specific issues\n      \n      // Example: Warn about possible streaming limitations in Excel Online\n      issues.push(\"Excel Online may have limitations with long-running functions. Consider using Excel desktop for complex operations.\");\n    }\n    \n    // Ensure we're running in Excel\n    if (host !== Office.HostType.Excel) {\n      issues.push(\"This add-in is designed for Excel and may not function correctly in other Office applications.\");\n    }\n    \n  } catch (error) {\n    Logger.error('Error detecting platform:', error);\n    // Don't add to issues here as we already have a general error message\n  }\n}","/**\n * Octagon API Agents Definitions\n * These interfaces define the available agents in Excel Add-in\n */\n\nimport { AgentType } from \"../api/types\";\nimport Logger from \"../utils/logger\";\n\nenum AgentCategory {\n  MarketIntelligence = \"Market Intelligence\",\n}\ninterface UsageExample {\n  topic: string;\n  prompt: string;\n}\n\ninterface AgentDefinition {\n  id: AgentType;\n  displayName: string;\n  excelFormulaName: string;\n  description: string;\n  usageExamples: UsageExample[];\n}\n\nconst OCTAGON_AGENTS: Record<AgentCategory, AgentDefinition[]> = {\n  [AgentCategory.MarketIntelligence]: [\n    {\n      id: AgentType.OctagonAgent,\n      displayName: \"Octagon Agent\",\n      excelFormulaName: \"OCTAGON.AGENT\",\n      description:\n        \"Public and Private market intelligence agent that optimally routes requests to appropriate specialized agents\",\n      usageExamples: [\n        {\n          topic: \"Financial Metrics Analysis\",\n          prompt:\n            '=OCTAGON.AGENT(\"Retrieve year-over-year growth in key income-statement items for AAPL, limited to 5 records and filtered by period FY.\")',\n        },\n        {\n          topic: \"SEC Filing Analysis\",\n          prompt:\n            '=OCTAGON.AGENT(\"Analyze the latest 10-K filing for AAPL and extract key financial metrics and risk factors.\", \"raw\")',\n        },\n        {\n          topic: \"Stock Performance\",\n          prompt:\n            '=OCTAGON.AGENT(\"Retrieve the daily closing prices for AAPL over the last 30 days.\")',\n        },\n        {\n          topic: \"Earnings Call Insights\",\n          prompt:\n            '=OCTAGON.AGENT(\"In one concise sentence, summarize AAPL\\'s latest earnings call with a focus on revenue growth and future guidance.\", \"cell\")',\n        },\n        {\n          topic: \"Company Overview\",\n          prompt:\n            '=OCTAGON.AGENT(\"Provide a comprehensive overview of Stripe, including its business model and key metrics.\", \"raw\")',\n        },\n        {\n          topic: \"Funding History\",\n          prompt:\n            '=OCTAGON.AGENT(\"Create a table of Stripe\\'s funding history with columns Round, Date, AmountUSD, LeadInvestor, OtherInvestors, and PostMoneyValuation.\", \"table\")',\n        },\n        {\n          topic: \"M&A Activity\",\n          prompt:\n            '=OCTAGON.AGENT(\"List all M&A transactions involving Stripe in the last 2 years.\")',\n        },\n        {\n          topic: \"Investor Profile\",\n          prompt:\n            '=OCTAGON.AGENT(\"Provide a detailed profile of Sequoia Capital\\'s investment strategy and portfolio.\", \"raw\")',\n        },\n        {\n          topic: \"Debt Analysis\",\n          prompt:\n            '=OCTAGON.AGENT(\"Analyze Stripe\\'s debt financing history and current debt structure.\", \"raw\")',\n        },\n        {\n          topic: \"Institutional Holdings\",\n          prompt:\n            '=OCTAGON.AGENT(\"Retrieve the most recent Form 13F and related filings submitted by institutional investors.\", \"raw\")',\n        },\n      ],\n    },\n  ],\n};\n\n/**\n * Populate the agents list with categories and agent cards.\n * This only builds the DOM once since the underlying data is static.\n */\nexport function createAgentExamplesFragment(): DocumentFragment {\n  const fragment = document.createDocumentFragment();\n\n  // Create a list for the examples\n  const examplesList = document.createElement(\"div\");\n  examplesList.className = \"examples-list\";\n  fragment.appendChild(examplesList);\n\n  // Add examples for each category\n  for (const category of Object.values(OCTAGON_AGENTS)) {\n    // Create agent cards for this category\n    category.forEach((agent) => {\n      addAgentExamples(agent.usageExamples, examplesList);\n    });\n  }\n  return fragment;\n}\n\n/**\n * Create an agent card element\n * @param agent Agent information\n * @returns HTMLElement The agent card\n */\nfunction addAgentExamples(usageExamples: UsageExample[], examplesList: HTMLElement) {\n  // Add each example to the list\n  usageExamples.forEach((example) => {\n    const exampleItem = document.createElement(\"div\");\n    exampleItem.className = \"example-item\";\n\n    const topicElement = document.createElement(\"div\");\n    topicElement.className = \"example-topic\";\n    topicElement.textContent = example.topic;\n    exampleItem.appendChild(topicElement);\n\n    // Create a container for the prompt to allow positioning the copy button\n    const promptContainer = document.createElement(\"div\");\n    promptContainer.className = \"example-prompt-container\";\n    promptContainer.style.position = \"relative\";\n\n    const promptElement = document.createElement(\"div\");\n    promptElement.className = \"example-prompt code\";\n    promptElement.textContent = example.prompt;\n    promptContainer.appendChild(promptElement);\n\n    // Add copy button\n    const copyButton = document.createElement(\"button\");\n    copyButton.className = \"copy-button\";\n    copyButton.title = \"Copy example\";\n    copyButton.innerHTML = '<i class=\"ms-Icon ms-Icon--Copy\"></i>';\n    copyButton.onclick = (e) => {\n      e.stopPropagation();\n      navigator.clipboard\n        .writeText(example.prompt)\n        .then(() => {\n          // Show success feedback\n          copyButton.innerHTML = '<i class=\"ms-Icon ms-Icon--CheckMark copy-success\"></i>';\n          setTimeout(() => {\n            copyButton.innerHTML = '<i class=\"ms-Icon ms-Icon--Copy\"></i>';\n          }, 1500);\n        })\n        .catch((err) => {\n          Logger.error(\"Could not copy text: \", err);\n        });\n    };\n\n    promptContainer.appendChild(copyButton);\n    exampleItem.appendChild(promptContainer);\n\n    examplesList.appendChild(exampleItem);\n  });\n}\n","/**\n * Octagon Excel Add-in Taskpane\n * This file handles the UI and interaction for the Octagon Excel Add-in taskpane\n */\n\nimport { OctagonApiService } from \"../api\";\nimport { checkRequiredApiSupport, detectIE } from \"../utils/browserSupport\";\nimport Logger from \"../utils/logger\";\nimport { createAgentExamplesFragment } from \"./examples\";\n\n// Track the application state\nlet agentsExamplesInitialized = false;\nconst octagonApi = new OctagonApiService();\n\n// Initialize the taskpane when Office is ready\nOffice.onReady(async () => {\n  try {\n    Logger.info(\"Office is ready - initializing Octagon taskpane\");\n\n    // Add event listeners to UI elements\n    setupEventListeners();\n\n    // Check authentication status and show the appropriate view\n    await checkAuthentication();\n\n    // Check browser compatibility\n    if (detectIE()) {\n      showBrowserWarning(\n        \"Internet Explorer is not fully supported. For the best experience, please use Microsoft Edge, Chrome, or another modern browser.\"\n      );\n    }\n\n    // Check if all required APIs are supported\n    const apiSupportIssues = checkRequiredApiSupport();\n    if (apiSupportIssues.length > 0) {\n      showApiSupportWarning(apiSupportIssues);\n    }\n\n    Logger.info(\"Taskpane initialized\");\n  } catch (error) {\n    Logger.error(\"Error during taskpane initialization:\", error);\n  }\n});\n\n/**\n * Set up event listeners for UI interactions\n */\nfunction setupEventListeners() {\n  // Submit button\n  const submitButton = document.getElementById(\"submit-button\");\n  if (submitButton) {\n    submitButton.addEventListener(\"click\", handleSubmit);\n  }\n\n  // Test Connection button\n  const testConnectionButton = document.getElementById(\"test-connection-button\");\n  if (testConnectionButton) {\n    testConnectionButton.addEventListener(\"click\", handleTestConnection);\n  }\n\n  // Back to Login button\n  const backToLoginButton = document.getElementById(\"back-to-login-button\");\n  if (backToLoginButton) {\n    backToLoginButton.addEventListener(\"click\", handleLogout);\n  }\n\n  // Enter key in API key input\n  const apiKeyInput = document.getElementById(\"api-key-input\") as HTMLInputElement;\n  if (apiKeyInput) {\n    apiKeyInput.addEventListener(\"keydown\", (event) => {\n      if (event.key === \"Enter\") {\n        handleSubmit();\n      }\n    });\n\n    // Clear the authentication message and update the button states when the user types or backspaces\n    apiKeyInput.addEventListener(\"input\", () => {\n      clearAuthError();\n      updateButtonStates();\n    });\n  }\n\n  // Set initial button states\n  updateButtonStates();\n}\n\n/**\n * Update button states based on API key input\n */\nfunction updateButtonStates() {\n  const apiKeyInput = document.getElementById(\"api-key-input\") as HTMLInputElement;\n  const submitButton = document.getElementById(\"submit-button\");\n  const testConnectionButton = document.getElementById(\"test-connection-button\");\n\n  const hasValue = apiKeyInput?.value?.trim().length > 0;\n\n  // Enable/disable buttons based on whether there's input\n  if (submitButton) {\n    if (hasValue) {\n      submitButton.removeAttribute(\"disabled\");\n    } else {\n      submitButton.setAttribute(\"disabled\", \"true\");\n    }\n  }\n\n  if (testConnectionButton) {\n    if (hasValue) {\n      testConnectionButton.removeAttribute(\"disabled\");\n    } else {\n      testConnectionButton.setAttribute(\"disabled\", \"true\");\n    }\n  }\n}\n\n/**\n * Show the authentication view\n */\nfunction showAuthView() {\n  const authView = document.getElementById(\"auth-view\");\n  const agentsView = document.getElementById(\"agents-view\");\n\n  if (authView && agentsView) {\n    authView.style.display = \"block\";\n    authView.classList.add(\"fade-in\");\n    agentsView.style.display = \"none\";\n  }\n}\n\n/**\n * Check the status of the API key and update the UI accordingly\n */\nasync function checkAuthentication() {\n  const isAuthenticated = await octagonApi.isAuthenticated();\n\n  if (isAuthenticated) {\n    // If the api service is authenticated, show the agents view\n    Logger.info(\"Authentication successful\");\n\n    // Automatically proceed to the Main Menu after a brief delay\n    setTimeout(() => showAgentsView(), 500);\n  } else {\n    // If the api service is not authenticated, show the authentication view\n    showAuthView();\n  }\n}\n\n/**\n * Handle the Submit button click\n */\nasync function handleSubmit() {\n  try {\n    // Get the API key from the input field\n    const apiKeyInput = document.getElementById(\"api-key-input\") as HTMLInputElement;\n    const apiKey = apiKeyInput?.value?.trim();\n\n    if (!apiKey) {\n      showAuthError(\"Please enter an API Key.\");\n      return;\n    }\n\n    // TODO: Test connection before saving\n    // Set and persist the API key\n    await octagonApi.setApiKey(apiKey);\n\n    // Success - show success message and enable continue button\n    clearAuthError();\n    showAuthSuccess(\"API Key saved successfully!\");\n\n    // Automatically proceed to the Main Menu after a brief delay\n    // This gives the user a chance to see the success message first\n    setTimeout(() => {\n      // Clear the input field before showing the agents view\n      apiKeyInput.value = \"\";\n      updateButtonStates();\n\n      showAgentsView();\n    }, 800);\n  } catch (error) {\n    // Show error message\n    showAuthError(\"An error occurred while saving the API key. Please try again.\");\n    Logger.error(\"Error saving API key:\", error);\n  }\n}\n\n/**\n * Handle the Test Connection button click\n */\nasync function handleTestConnection() {\n  try {\n    // Get the API key from the input field (if visible)\n    const apiKeyInput = document.getElementById(\"api-key-input\") as HTMLInputElement;\n    let apiKey = apiKeyInput?.value?.trim();\n\n    // If input is not visible or empty, raise an error immediately\n    if (!apiKeyInput || apiKeyInput.style.display === \"none\" || !apiKey) {\n      showAuthError(\"Please enter an API Key.\");\n      return;\n    }\n\n    // Show loading state\n    clearAuthError();\n    toggleAuthLoadingState(true);\n\n    // Test the connection\n    const isConnected = await octagonApi.testConnection(apiKey);\n\n    // Hide loading state\n    toggleAuthLoadingState(false);\n\n    if (isConnected) {\n      // Success - show success message and enable continue button\n      showAuthSuccess(\"Connection successful! API Key verified.\");\n    } else {\n      // Failed - show error message\n      showAuthError(\"Invalid API key. Please check and try again.\");\n    }\n  } catch (error) {\n    // Hide loading state\n    toggleAuthLoadingState(false);\n\n    // Show error message\n    showAuthError(\"An error occurred. Please try again.\");\n    Logger.error(\"Authentication error:\", error);\n  }\n}\n\n/**\n * Handle the Back to Login button click\n */\nasync function handleLogout() {\n  // Clear the API key\n  await octagonApi.clearApiKey();\n  Logger.info(\"API Key cleared\");\n\n  // Redirect to the login page after a brief delay\n  setTimeout(() => showAuthView(), 500);\n}\n\n/**\n * Show authentication error message\n * @param message Error message to display\n */\nfunction showAuthError(message: string) {\n  const errorElement = document.getElementById(\"auth-error\");\n  if (errorElement) {\n    errorElement.textContent = message;\n    errorElement.style.display = \"block\";\n  }\n}\n\n/**\n * Show authentication success message (temporarily)\n * @param message Success message to display\n */\nfunction showAuthSuccess(message: string) {\n  const errorElement = document.getElementById(\"auth-error\");\n  if (errorElement) {\n    errorElement.textContent = message;\n    errorElement.style.color = \"green\";\n    errorElement.style.display = \"block\";\n  }\n}\n\n/**\n * Clear authentication error message\n */\nfunction clearAuthError() {\n  const errorElement = document.getElementById(\"auth-error\");\n  if (errorElement) {\n    errorElement.textContent = \"\";\n    errorElement.style.display = \"none\";\n    errorElement.style.color = \"#a80000\"; // Reset to error color\n  }\n}\n\n/**\n * Toggle the loading state during authentication\n * @param isLoading Whether to show or hide the loading state\n */\nfunction toggleAuthLoadingState(isLoading: boolean) {\n  const submitButton = document.getElementById(\"submit-button\");\n  const testConnectionButton = document.getElementById(\"test-connection-button\");\n  const spinner = document.getElementById(\"auth-spinner\");\n\n  if (spinner) {\n    if (isLoading) {\n      if (submitButton) submitButton.setAttribute(\"disabled\", \"true\");\n      if (testConnectionButton) testConnectionButton.setAttribute(\"disabled\", \"true\");\n      spinner.style.display = \"block\";\n    } else {\n      if (submitButton) submitButton.removeAttribute(\"disabled\");\n      if (testConnectionButton) testConnectionButton.removeAttribute(\"disabled\");\n      spinner.style.display = \"none\";\n    }\n  }\n}\n\n/**\n * Show the agents view and populate it with agent data\n */\nfunction showAgentsView() {\n  const authView = document.getElementById(\"auth-view\");\n  const agentsView = document.getElementById(\"agents-view\");\n\n  if (authView && agentsView) {\n    authView.style.display = \"none\";\n    agentsView.style.display = \"block\";\n    agentsView.classList.add(\"fade-in\");\n\n    // Hide the old back-to-auth button in the header (if it exists)\n    const oldBackButton = document.getElementById(\"back-to-auth-button-header\");\n    if (oldBackButton) {\n      oldBackButton.style.display = \"none\";\n    }\n\n    // Populate the agents list\n    populateAgentsList();\n  }\n}\n\n/**\n * Populate the agents card with examples\n */\nfunction populateAgentsList() {\n  // Only populate the agents list on first call\n  if (agentsExamplesInitialized) return;\n\n  const agentCard = document.getElementById(\"agent-card\");\n  if (agentCard) {\n    const usageExamples = createAgentExamplesFragment();\n    agentCard.appendChild(usageExamples);\n    agentsExamplesInitialized = true;\n  }\n}\n\n/**\n * Shows a browser compatibility warning to the user\n */\nfunction showBrowserWarning(message: string) {\n  const warningDiv = document.createElement(\"div\");\n  warningDiv.className = \"browser-warning\";\n  warningDiv.innerHTML = `\n    <div class=\"warning-icon\"><i class=\"ms-Icon ms-Icon--Warning\"></i></div>\n    <div class=\"warning-message\">${message}</div>\n  `;\n\n  // Insert at the top of the body or in a specific container\n  const container = document.querySelector(\".content-container\") || document.body;\n  container.insertBefore(warningDiv, container.firstChild);\n}\n\n/**\n * Shows API support warnings to the user\n */\nfunction showApiSupportWarning(issues: string[]) {\n  const warningDiv = document.querySelector(\".api-support-warning\");\n  if (!warningDiv) return;\n\n  (warningDiv as HTMLElement).style.display = \"inline-block\";\n\n  if (issues.length > 0) {\n    const warningMessage = warningDiv.firstElementChild;\n    const issueList = document.createElement(\"ul\");\n    issues.forEach((issue) => {\n      const issueItem = document.createElement(\"li\");\n      issueItem.textContent = issue;\n      issueList.appendChild(issueItem);\n    });\n    warningMessage.appendChild(issueList);\n  }\n}\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_1___ = new URL(\"../../assets/octagon-logo.png\", import.meta.url);\n// Module\nvar code = \"<!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Octagon AI - Market Intelligence for Excel</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"ms-font-m ms-Fabric ms-bgColor-neutralLighter\\\"> <div class=\\\"api-support-warning\\\" style=\\\"display:none\\\"> <div class=\\\"warning-message\\\"> <i class=\\\"warning-icon ms-Icon ms-Icon--Warning\\\"></i> Some features may not work correctly in your current environment </div> </div> <header class=\\\"octagon-header\\\"> <img width=\\\"100%\\\" src=\\\"\" + ___HTML_LOADER_IMPORT_1___ + \"\\\" alt=\\\"Octagon AI\\\" title=\\\"Octagon AI\\\"/> </header> <main id=\\\"auth-view\\\" class=\\\"main-content\\\" style=\\\"display:none\\\"> <div class=\\\"content-container\\\"> <p class=\\\"ms-font-m description\\\"> Access real-time market intelligence and financial data directly in Excel with Octagon AI agents. </p> <div class=\\\"auth-container\\\"> <h3 class=\\\"ms-font-l\\\">Authentication Required</h3> <p class=\\\"ms-font-m\\\">Please enter your Octagon API key to continue:</p> <div id=\\\"api-key-input-container\\\" class=\\\"form-group\\\"> <input type=\\\"password\\\" id=\\\"api-key-input\\\" class=\\\"ms-TextField-field\\\" placeholder=\\\"Enter your API key here\\\"/> <div id=\\\"auth-error\\\" class=\\\"error-message\\\" style=\\\"display:none\\\"></div> </div> <div class=\\\"button-container\\\"> <button id=\\\"submit-button\\\" class=\\\"ms-Button ms-Button--primary\\\"> <span class=\\\"ms-Button-label\\\">Submit</span> </button> <button id=\\\"test-connection-button\\\" class=\\\"ms-Button ms-Button--default\\\"> <span class=\\\"ms-Button-label\\\">Test Connection</span> </button> <div id=\\\"auth-spinner\\\" class=\\\"ms-Spinner\\\" style=\\\"display:none\\\"></div> </div> <p class=\\\"ms-font-s signup-link\\\"> Don't have an API key? <a href=\\\"https://www.octagonai.co/\\\" target=\\\"_blank\\\">Get one here</a> </p> </div> </div> </main> <main id=\\\"agents-view\\\" class=\\\"main-content\\\" style=\\\"display:none\\\"> <div class=\\\"content-container\\\"> <div> <div id=\\\"agent-card\\\"> <h4 class=\\\"agent-title\\\">Octagon Agent</h4> <p class=\\\"agent-description\\\">Public and Private market intelligence agent that optimally routes requests to appropriate specialized agents</p> <div class=\\\"agent-meta\\\"> <div> <strong>Function:</strong> <span class=\\\"formula-name\\\">OCTAGON.AGENT(prompt, [format])</span> <div class=\\\"formula-argument\\\"> <code>prompt</code> is the question or prompt for the Octagon agent </div> <div class=\\\"formula-argument\\\"> <code>[format]</code> optional output format with possible values of 'table' (default), 'cell', or 'raw'. <br/> </div> <div> Use 'table' for generating tabular data spanning multiple cells, 'cell' for a single cell value, and 'raw' for more verbose text-based content. </div> </div> </div> <div class=\\\"usage-examples-section\\\"> <h5 class=\\\"usage-heading\\\">Usage Examples:</h5> </div> </div> <div class=\\\"back-button-container\\\"> <button id=\\\"back-to-login-button\\\" class=\\\"ms-Button ms-Button--default\\\"> <span class=\\\"ms-Button-icon\\\"> <i class=\\\"ms-Icon ms-Icon--SignOut\\\"></i> </span> <span class=\\\"ms-Button-label\\\">Logout</span> </button> </div> <div class=\\\"additional-resources\\\"> <h3>Resources</h3> <ul> <li> <i class=\\\"ms-Icon ms-Icon--ReadingMode\\\"></i> <a href=\\\"https://docs.octagonagents.com/\\\" target=\\\"_blank\\\">Official Documentation</a> </li> <li> <i class=\\\"ms-Icon ms-Icon--TestBeaker\\\"></i> <a href=\\\"https://app.octagonai.co/playground\\\" target=\\\"_blank\\\">API Playground</a> </li> </ul> </div> </div> </div></main> <div class=\\\"footer\\\"> <div class=\\\"version\\\">Version 1.2</div> <div class=\\\"footer-links\\\"> <a href=\\\"https://www.octagonai.co/terms-of-service\\\" target=\\\"_blank\\\">Terms of Service</a> | <a href=\\\"https://www.octagonai.co/privacy\\\" target=\\\"_blank\\\">Privacy</a> | <a href=\\\"mailto:contact@octagonai.co\\\">Contact</a> </div> </div> </body> </html>\";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","LogLevel","currentLogLevel","ERROR","logLevelPriority","_defineProperty","DEBUG","INFO","WARN","log","level","message","data","timestamp","Date","toISOString","formattedMessage","concat","console","debug","info","warn","error","formatMap","raw","format","type","table","strict","name","schema","properties","description","items","anyOf","required","title","additionalProperties","cell","getTextFormat","textFormat","Logger","CustomFunctions","ErrorCode","invalidValue","parseTextFormat","content","defaultResponse","_JSON$parse$data","JSON","parse","AgentType","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","d","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","_defineProperties","_toPropertyKey","key","_typeof","toPrimitive","String","_toPrimitive","API_KEY_STORAGE_NAME","OctagonApiService","apiUrl","_classCallCheck","_setApiKey","_callee","apiKey","trimmedKey","_t","_context","trim","clearApiKey","OfficeRuntime","storage","setItem","_x","_callAgent","_callee2","model","prompt","response","_context2","substring","isAuthenticated","createResponse","input","text","_x2","_x3","_x4","_loadApiKey","_callee3","storedKey","_context3","getStoredApiKey","_isAuthenticated","_callee4","_context4","loadApiKey","_clearApiKey","_callee5","_t2","_context5","removeItem","_getStoredApiKey","_callee6","storedValue","_t3","_context6","getItem","_createResponse","_callee7","requestUrl","token","headers","_context7","URL","Headers","Authorization","fetch","method","body","stringify","ok","handleApiError","parseAgentResponse","_x5","_x6","_parseAgentResponse","_callee8","_iterator","_step","output","_iterator2","_step2","_t4","_t5","_t6","_context8","json","Array","isArray","id","_createForOfIteratorHelper","s","_x7","_testConnection","_callee9","request","_t7","_context9","OctagonAgent","max_tokens","_x8","_handleApiError","_callee0","_data$detail","_data","status","errorMessage","_context0","detail","_x9","detectIE","ua","navigator","userAgent","msie","indexOf","trident","checkRequiredApiSupport","issues","Office","context","requirements","isSetSupported","push","platform","host","PlatformType","PC","Mac","OfficeOnline","HostType","Excel","checkPlatformCompatibility","AgentCategory","OCTAGON_AGENTS","MarketIntelligence","excelFormulaName","usageExamples","topic","addAgentExamples","examplesList","forEach","example","exampleItem","createElement","className","topicElement","textContent","appendChild","promptContainer","style","position","promptElement","copyButton","innerHTML","onclick","stopPropagation","clipboard","writeText","setTimeout","catch","err","agentsExamplesInitialized","octagonApi","setupEventListeners","submitButton","getElementById","addEventListener","handleSubmit","testConnectionButton","handleTestConnection","backToLoginButton","handleLogout","apiKeyInput","event","clearAuthError","updateButtonStates","_apiKeyInput$value","hasValue","removeAttribute","setAttribute","showAuthView","authView","agentsView","display","classList","add","checkAuthentication","_checkAuthentication","showAgentsView","_handleSubmit","_apiKeyInput$value2","showAuthError","setApiKey","showAuthSuccess","_handleTestConnection","_apiKeyInput$value3","isConnected","toggleAuthLoadingState","testConnection","_handleLogout","errorElement","color","isLoading","spinner","oldBackButton","agentCard","fragment","createDocumentFragment","_i","_Object$values","values","agent","createAgentExamplesFragment","populateAgentsList","showBrowserWarning","warningDiv","container","querySelector","insertBefore","firstChild","showApiSupportWarning","warningMessage","firstElementChild","issueList","issue","issueItem","onReady","apiSupportIssues"],"sourceRoot":""}