{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://excel-custom-functions/webpack/bootstrap","webpack://excel-custom-functions/webpack/runtime/global","webpack://excel-custom-functions/webpack/runtime/hasOwnProperty shorthand","webpack://excel-custom-functions/webpack/runtime/publicPath","webpack://excel-custom-functions/webpack/runtime/jsonp chunk loading","webpack://excel-custom-functions/./src/api/types.ts","webpack://excel-custom-functions/./src/api/agents.ts","webpack://excel-custom-functions/./src/utils/logger.ts","webpack://excel-custom-functions/./src/api/format.ts","webpack://excel-custom-functions/./src/api/octagonApi.ts","webpack://excel-custom-functions/./src/utils/browserSupport.ts","webpack://excel-custom-functions/./src/taskpane/taskpane.ts","webpack://excel-custom-functions/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/**\n * Octagon API TypeScript Interfaces\n * These interfaces define the contract between our Excel Add-in and the Octagon API.\n */\n\n// ==================== COMMON API TYPES ====================\n\n// Common API response structure\nexport interface ApiResponse<T> {\n  success: boolean;\n  data?: T;\n  error?: string;\n}\n\n// ==================== OPENAI COMPATIBLE TYPES ====================\n\n// OpenAI-style message structure\nexport interface ChatMessage {\n  role: \"system\" | \"user\" | \"assistant\";\n  content: string;\n}\n\n// OpenAI-style choice structure\nexport interface StreamChoice {\n  index: number;\n  message: ChatMessage;\n  finish_reason: \"stop\" | \"length\" | \"function_call\" | \"content_filter\" | null;\n}\n\n// OpenAI-style usage statistics\nexport interface StreamUsage {\n  prompt_tokens: number;\n  completion_tokens: number;\n  total_tokens: number;\n}\n\n// OpenAI-style responses endpoint response\nexport interface StreamResponse {\n  id: string;\n  object: \"responses\";\n  created: number;\n  model: string;\n  choices: StreamChoice[];\n  usage?: StreamUsage;\n  // Adding new fields for Octagon specific response structure\n  content?: string;\n  output?: any[];\n  rawResponse?: any;\n  status?: string;\n  text?: any;\n}\n\n// ==================== AGENT TYPES ====================\n\nexport enum AgentType {\n  OctagonAgent = \"octagon-agent\",\n}\n\n// ==================== REQUEST/RESPONSE TYPES ====================\n\nexport interface AgentRequest {\n  model: string;\n  input: string;\n  max_tokens?: number;\n  text?: { format: { type: string } };\n}\n\n// Detailed agent response with content and structured data\nexport interface AgentResponse {\n  content: string;\n  // Additional fields that might be in the Octagon API response\n  model?: string;\n  created?: number;\n  id?: string;\n  [key: string]: any; // Allow for additional unknown properties\n}\n\n// ==================== UTILITY TYPES ====================\n\n// Type aliases for common data structures\nexport type Option<T = string> = { value: T; label: string };\nexport type Maybe<T> = T | null | undefined;\n\nexport type OutputFormat = \"raw\" | \"table\" | \"single_cell\";\n\n// ==================== EXCEL INTEGRATION TYPES ====================\n\n// Excel table formatting options\nexport interface ExcelTableOptions {\n  hasHeaders?: boolean;\n  showTotals?: boolean;\n  tableName?: string;\n  tableStyle?: string;\n}\n\n// Excel insertion result\nexport interface ExcelInsertionResult {\n  success: boolean;\n  rowsInserted: number;\n  columnsInserted: number;\n  range?: string;\n  error?: string;\n}\n\n// ==================== ERROR HANDLING TYPES ====================\n\n// Standardized error response\nexport interface ErrorResponse {\n  error: {\n    code: string;\n    message: string;\n    type: \"api_error\" | \"rate_limit_exceeded\" | \"invalid_request\" | \"authentication_error\";\n    param?: string;\n  };\n}\n","/**\n * Octagon API Agents Definitions\n * These interfaces define the available agents in Excel Add-in\n */\n\nimport { AgentType } from './types';\n\ninterface AgentInfo {\n  id: AgentType;\n  displayName: string;\n  excelFormulaName: string;\n  description: string;\n  category: AgentCategory;\n  examplePrompt?: string;\n  usageExamples?: UsageExample[];\n}\n\ninterface UsageExample {\n  topic: string;\n  prompt: string;\n}\n\nenum AgentCategory {\n  MarketIntelligence = 'Market Intelligence',\n}\n\nexport const OCTAGON_AGENTS: AgentInfo[] = [  \n  {\n    id: AgentType.OctagonAgent,\n    displayName: 'Octagon Agent',\n    excelFormulaName: 'OCTAGON.OCTAGON_AGENT',\n    description: 'Public and Private market intelligence agent that optimally routes requests to appropriate specialized agents',\n    category: AgentCategory.MarketIntelligence,\n    usageExamples: [\n      { \n        topic: 'Financial Metrics Analysis',\n        prompt: '=OCTAGON.OCTAGON_AGENT(\"Retrieve year-over-year growth in key income-statement items for AAPL, limited to 5 records and filtered by period FY.\")'\n      },\n      { \n        topic: 'SEC Filing Analysis',\n        prompt: '=OCTAGON.OCTAGON_AGENT(\"Analyze the latest 10-K filing for AAPL and extract key financial metrics and risk factors.\")'\n      },\n      { \n        topic: 'Stock Performance',\n        prompt: '=OCTAGON.OCTAGON_AGENT(\"Retrieve the daily closing prices for AAPL over the last 30 days.\")'\n      },\n      { \n        topic: 'Earnings Call Insights',\n        prompt: '=OCTAGON.OCTAGON_AGENT(\"Analyze AAPL\\'s latest earnings call transcript and extract key insights about future guidance.\")'\n      },\n      { \n        topic: 'Company Overview',\n        prompt: '=OCTAGON.OCTAGON_AGENT(\"Provide a comprehensive overview of Stripe, including its business model and key metrics.\")'\n      },\n      { \n        topic: 'Funding History',\n        prompt: '=OCTAGON.OCTAGON_AGENT(\"Retrieve the funding history for Stripe, including all rounds and investors.\")'\n      },\n      { \n        topic: 'M&A Activity',\n        prompt: '=OCTAGON.OCTAGON_AGENT(\"List all M&A transactions involving Stripe in the last 2 years.\")'\n      },\n      { \n        topic: 'Investor Profile',\n        prompt: '=OCTAGON.OCTAGON_AGENT(\"Provide a detailed profile of Sequoia Capital\\'s investment strategy and portfolio.\")'\n      },\n      { \n        topic: 'Debt Analysis',\n        prompt: '=OCTAGON.OCTAGON_AGENT(\"Analyze Stripe\\'s debt financing history and current debt structure.\")'\n      },\n      { \n        topic: 'Institutional Holdings',\n        prompt: '=OCTAGON.OCTAGON_AGENT(\"Retrieve the most recent Form 13F and related filings submitted by institutional investors.\")'\n      }\n    ]\n  },\n];\n","/**\n * Logging utility for Octagon Excel Add-in\n * This module provides centralized logging functionality with different log levels\n * to help debug issues during development and production.\n */\n\n// Log levels\nexport enum LogLevel {\n  DEBUG = 'DEBUG',\n  INFO = 'INFO',\n  WARN = 'WARN',\n  ERROR = 'ERROR'\n}\n\n// Current log level - can be adjusted based on environment\nlet currentLogLevel: LogLevel = \n  process.env.NODE_ENV === 'production' ? LogLevel.ERROR : LogLevel.DEBUG;\n\n// Log level priority (used to determine if a message should be logged)\nconst logLevelPriority: Record<LogLevel, number> = {\n  [LogLevel.DEBUG]: 0,\n  [LogLevel.INFO]: 1,\n  [LogLevel.WARN]: 2,\n  [LogLevel.ERROR]: 3\n};\n\n/**\n * Main logging function that handles all log levels\n */\nexport function log(level: LogLevel, message: string, data?: any): void {\n  // Only log if the current level priority is less than or equal to the message level\n  if (logLevelPriority[level] >= logLevelPriority[currentLogLevel]) {\n    const timestamp = new Date().toISOString();\n    const formattedMessage = `[${timestamp}] [${level}] ${message}`;\n\n    switch (level) {\n      case LogLevel.DEBUG:\n        console.debug(formattedMessage, data || '');\n        break;\n      case LogLevel.INFO:\n        console.info(formattedMessage, data || '');\n        break;\n      case LogLevel.WARN:\n        console.warn(formattedMessage, data || '');\n        break;\n      case LogLevel.ERROR:\n        console.error(formattedMessage, data || '');\n        break;\n    }\n  }\n}\n\n/**\n * Set the current log level\n */\nexport function setLogLevel(level: LogLevel): void {\n  currentLogLevel = level;\n  log(LogLevel.INFO, `Log level set to ${level}`);\n}\n\n/**\n * Get all logs stored in session storage\n */\nexport function getLogs(): any[] {\n  try {\n    return JSON.parse(sessionStorage.getItem('octagon_logs') || '[]');\n  } catch (e) {\n    console.error('[Logger] Error retrieving logs from sessionStorage:', e);\n    return [];\n  }\n}\n\n/**\n * Clear all logs in session storage\n */\nexport function clearLogs(): void {\n  try {\n    sessionStorage.removeItem('octagon_logs');\n  } catch (e) {\n    // Log the error instead of silently failing\n    console.error('[Logger] Error clearing logs from sessionStorage:', e);\n  }\n}\n\n// Convenience methods for each log level\nexport const debug = (message: string, data?: any) => log(LogLevel.DEBUG, message, data);\nexport const info = (message: string, data?: any) => log(LogLevel.INFO, message, data);\nexport const warn = (message: string, data?: any) => log(LogLevel.WARN, message, data);\nexport const error = (message: string, data?: any) => log(LogLevel.ERROR, message, data);\n\n// Export a default logger object\nexport default {\n  debug,\n  info,\n  warn,\n  error,\n  setLogLevel,\n  getLogs,\n  clearLogs\n};","import Logger from \"../utils/logger\";\nimport type { OutputFormat } from \"./types\";\n\nconst RAW_TEXT = {\n  format: { type: \"text\" },\n};\n\nconst TABLE_FORMAT = {\n  format: {\n    type: \"json_schema\",\n    strict: true,\n    name: \"TableFormat\",\n    schema: {\n      properties: {\n        data: {\n          description:\n            \"Nested list of values for multiple spreadsheet cells. Outer list represents rows, inner list represents columns. Each element in the inner list is a cell value.\",\n          items: { items: { anyOf: [{ type: \"number\" }, { type: \"string\" }] }, type: \"array\" },\n          type: \"array\",\n        },\n      },\n      required: [\"data\"],\n      title: \"ExcelFormat\",\n      type: \"object\",\n      additionalProperties: false,\n    },\n  },\n};\n\nconst SINGLE_CELL_FORMAT = {\n  format: {\n    type: \"json_schema\",\n    strict: true,\n    name: \"SingleCellFormat\",\n    schema: {\n      properties: {\n        data: {\n          anyOf: [{ type: \"number\" }, { type: \"string\" }],\n          description: \"Single value of a spreadsheet cell\",\n          title: \"Data\",\n        },\n      },\n      required: [\"data\"],\n      title: \"ExcelCell\",\n      type: \"object\",\n      additionalProperties: false,\n    },\n  },\n};\n\nconst formatMap: Record<OutputFormat, { format: { type: string } }> = {\n  raw: RAW_TEXT,\n  table: TABLE_FORMAT,\n  single_cell: SINGLE_CELL_FORMAT,\n};\n\nexport function getTextFormat(format: string): { format: { type: string } } {\n  const textFormat = formatMap[format];\n  if (!textFormat) {\n    Logger.error(`Invalid format: ${format}`);\n    throw new CustomFunctions.Error(\n      CustomFunctions.ErrorCode.invalidValue,\n      'Invalid format. Please use \"raw\", \"table\", or \"single_cell\"'\n    );\n  }\n\n  return textFormat;\n}\n\nexport function parseTextFormat(\n  content: string,\n  format: OutputFormat\n): Array<Array<string | number>> {\n  Logger.info(\"Parsing text format:\", { content, format });\n  if (format == \"table\") {\n    return JSON.parse(content).data;\n  } else if (format == \"single_cell\") {\n    return [[JSON.parse(content).data]];\n  } else {\n    return [[content]];\n  }\n}\n","/**\n * Octagon API Service Defintions\n * This service handles all communication with the Octagon API using OpenAI-compatible endpoints.\n * It provides methods to query agents using the chat/completions pattern.\n */\n\nimport Logger from \"../utils/logger\";\nimport { getTextFormat, parseTextFormat } from \"./format\";\nimport { AgentRequest, AgentResponse, AgentType, OutputFormat } from \"./types\";\n// API Configuration\nconst DEFAULT_API_URL = \"https://octagon-api-gateway-staging.onrender.com\";\n\n// SessionStorage key constants\nconst API_KEY_STORAGE_NAME = \"octagon_api_key\";\nconst CACHED_SESSION_SETTINGS_KEY = \"CachedSessionSettings\";\n\n/**\n * OctagonApiService class handles all API interactions\n */\nexport class OctagonApiService {\n  private apiKey: string | null = null;\n  private apiUrl: string;\n  private isOfficeInitialized: boolean = false;\n\n  constructor(apiUrl: string = DEFAULT_API_URL) {\n    this.apiUrl = apiUrl;\n    // Don't automatically initialize in constructor to avoid race conditions\n    // Instead, require explicit initialization after Office.onReady\n    Logger.info(`OctagonApiService created with API URL: ${this.apiUrl}`);\n  }\n\n  /**\n   * Initialize the service after Office is ready\n   * This should be called after Office.onReady completes\n   */\n  public initialize(): void {\n    this.isOfficeInitialized = true;\n    this.loadApiKey();\n    Logger.info(\n      `OctagonApiService fully initialized. API key status: ${this.isAuthenticated() ? \"Available\" : \"Not available\"}`\n    );\n  }\n\n  /**\n   * Check if API key exists in SessionStorage\n   * @returns boolean True if API key is found in SessionStorage\n   */\n  public checkForStoredApiKey(): boolean {\n    try {\n      // Check if we have a cached session settings with an API key\n      const cachedSessionData = sessionStorage.getItem(CACHED_SESSION_SETTINGS_KEY);\n      if (cachedSessionData) {\n        const sessionData = JSON.parse(cachedSessionData);\n        if (sessionData && sessionData.octagon_api_key) {\n          Logger.info(\"Found API key in CachedSessionSettings\");\n          return true;\n        }\n      }\n\n      // Also check our direct storage\n      const directApiKey = sessionStorage.getItem(API_KEY_STORAGE_NAME);\n      if (directApiKey) {\n        Logger.info(\"Found API key in direct SessionStorage\");\n        return true;\n      }\n    } catch (error) {\n      Logger.error(\"Error checking for stored API key\", error);\n    }\n\n    return false;\n  }\n\n  /**\n   * Set the API key for authentication\n   */\n  public setApiKey(apiKey: string): void {\n    this.apiKey = apiKey;\n    this.saveApiKey(apiKey);\n  }\n\n  /**\n   * Save API key to SessionStorage\n   */\n  private saveApiKey(apiKey: string): void {\n    try {\n      // Save to SessionStorage\n      sessionStorage.setItem(API_KEY_STORAGE_NAME, apiKey);\n\n      // Also save to CachedSessionSettings for compatibility\n      try {\n        const cachedSessionData = sessionStorage.getItem(CACHED_SESSION_SETTINGS_KEY);\n        if (cachedSessionData) {\n          const sessionData = JSON.parse(cachedSessionData);\n          sessionData.octagon_api_key = apiKey;\n          sessionStorage.setItem(CACHED_SESSION_SETTINGS_KEY, JSON.stringify(sessionData));\n        } else {\n          // Create a new cached session settings object\n          const newSessionData = { octagon_api_key: apiKey };\n          sessionStorage.setItem(CACHED_SESSION_SETTINGS_KEY, JSON.stringify(newSessionData));\n        }\n      } catch (error) {\n        Logger.warn(\"Failed to save to CachedSessionSettings\", error);\n      }\n\n      Logger.info(\"API key saved to SessionStorage\");\n    } catch (error) {\n      Logger.error(\"Failed to save API key to SessionStorage\", error);\n    }\n  }\n\n  /**\n   * Call an Octagon agent with a prompt\n   *\n   * @param agentId - The ID of the agent to call\n   * @param prompt - The prompt to send to the agent\n   * @returns A promise that resolves to the agent's response\n   */\n  public async callAgent(\n    model: string,\n    prompt: string,\n    format?: string\n  ): Promise<Array<Array<string | number>>> {\n    Logger.debug(`callAgent invoked with model: ${model}, prompt: ${prompt.substring(0, 50)}...`);\n\n    // Validate the prompt\n    if (!prompt || prompt.trim() === \"\") {\n      throw new Error(\"Please provide a valid prompt\");\n    }\n\n    // Default to table format if no format is provided\n    const textFormat = format ?? \"table\";\n\n    Logger.debug(\"Calling agent...\", {\n      isAuthenticated: this.isAuthenticated(),\n      apiKey: this.apiKey,\n    });\n\n    // Ensure add-in has been authenticated\n    if (!this.isAuthenticated()) {\n      Logger.error(\"API request failed: Not authenticated\");\n      throw new Error(\"Not authenticated. Please set your API key first.\");\n    }\n\n    const response = await this.createResponse({\n      model,\n      input: prompt,\n      // Default to table format if no format is provided\n      text: getTextFormat(textFormat),\n    });\n\n    // Parse the content of the response as a JSON object if it is a table or single cell\n    const content = parseTextFormat(\n      response.content ?? \"No response content\",\n      textFormat as OutputFormat\n    );\n    Logger.info(\"Agent response:\", content);\n    return content;\n  }\n\n  /**\n   * Load API key from SessionStorage with a simplified approach\n   */\n  private loadApiKey(): void {\n    Logger.info(\"Attempting to load API key from SessionStorage\");\n\n    try {\n      // Try CachedSessionSettings first\n      const cachedSessionData = sessionStorage.getItem(CACHED_SESSION_SETTINGS_KEY);\n      if (cachedSessionData) {\n        try {\n          const sessionData = JSON.parse(cachedSessionData);\n          if (sessionData && sessionData.octagon_api_key) {\n            this.apiKey = sessionData.octagon_api_key;\n            Logger.info(\"API key loaded from CachedSessionSettings\");\n            return;\n          }\n        } catch (parseError) {\n          Logger.warn(\"Failed to parse CachedSessionSettings\", parseError);\n        }\n      }\n\n      // Fallback to direct storage\n      const directApiKey = sessionStorage.getItem(API_KEY_STORAGE_NAME);\n      if (directApiKey) {\n        this.apiKey = directApiKey;\n        Logger.info(\"API key loaded from direct SessionStorage\");\n        return;\n      }\n    } catch (error) {\n      Logger.error(\"Failed to load API key from SessionStorage\", error);\n    }\n\n    // If we get here, no API key was found\n    Logger.info(\"No API key found in SessionStorage\");\n  }\n\n  /**\n   * Returns true if the API key is set and not empty. Loads the API key from SessionStorage if not set in current instance.\n   */\n  public isAuthenticated(): boolean {\n    if (this.apiKey) {\n      return true;\n    }\n    // Try to load the API key from SessionStorage\n    this.loadApiKey();\n\n    // Return true if the API key is set and not empty\n    return !!this.apiKey && this.apiKey.trim() !== \"\";\n  }\n\n  /**\n   * Clear stored API key from all SessionStorage locations\n   */\n  public clearApiKey(): void {\n    this.apiKey = null;\n\n    try {\n      // Clear direct API key storage\n      sessionStorage.removeItem(API_KEY_STORAGE_NAME);\n\n      // Clear from CachedSessionSettings if it exists\n      const cachedSessionData = sessionStorage.getItem(CACHED_SESSION_SETTINGS_KEY);\n      if (cachedSessionData) {\n        try {\n          const sessionData = JSON.parse(cachedSessionData);\n          if (sessionData) {\n            delete sessionData.octagon_api_key;\n            sessionStorage.setItem(CACHED_SESSION_SETTINGS_KEY, JSON.stringify(sessionData));\n          }\n        } catch (parseError) {\n          Logger.warn(\"Failed to parse CachedSessionSettings for clearing\", parseError);\n        }\n      }\n\n      Logger.info(\"API key cleared from all SessionStorage locations\");\n    } catch (error) {\n      Logger.error(\"Failed to clear API key from SessionStorage\", error);\n    }\n  }\n\n  /**\n   * Generic method to make authenticated API requests\n   * Handles both regular JSON responses and streamed responses\n   */\n  private async createResponse(data: AgentRequest, apiKey?: string): Promise<AgentResponse> {\n    const requestUrl = new URL(\"/v1/responses\", this.apiUrl);\n\n    const token = apiKey ?? this.apiKey;\n    if (!token) {\n      throw new Error(\"No API key provided\");\n    }\n\n    try {\n      const headers = new Headers({\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${token}`,\n      });\n\n      const response = await fetch(requestUrl, {\n        method: \"POST\",\n        headers,\n        body: JSON.stringify(data),\n      });\n\n      if (!response.ok) {\n        Logger.error(\n          `Agent request failed: ${response.status} ${response.statusText}`,\n          response.json()\n        );\n        throw new Error(`Agent request failed: ${response.status} ${response.statusText}`);\n      }\n\n      return await this.parseAgentResponse(response);\n    } catch (error) {\n      throw new Error(\n        `Failed to create agent response: ${error instanceof Error ? error.message : \"Unknown error\"}`\n      );\n    }\n  }\n\n  /**\n   * Parse the agent response from the Octagon API\n   * @param response - The fetch response object with streamed data\n   * @returns Parsed response data\n   */\n  private async parseAgentResponse(response: Response): Promise<AgentResponse> {\n    try {\n      // Get the reader for the stream\n      const data = await response.json();\n\n      // Create an empty content string, and append the text of each output message to the content\n      let content = \"\";\n      for (const output of data.output) {\n        if (output.type !== \"message\") continue;\n        for (const message of output.content) {\n          if (message.type !== \"output_text\") continue;\n          content += message.text;\n        }\n      }\n\n      return {\n        content,\n        id: data.id,\n        model: data.model,\n      } as AgentResponse;\n    } catch (error) {\n      Logger.error(\"Error processing streamed response:\", error);\n      throw new Error(\n        `Failed to process streamed response: ${error instanceof Error ? error.message : \"Unknown error\"}`\n      );\n    }\n  }\n\n  /**\n   * Test API key validity with a simple request\n   */\n  public async testConnection(apiKey: string): Promise<boolean> {\n    Logger.info(\"Testing API connection with stored key\");\n\n    const request = {\n      model: AgentType.OctagonAgent,\n      input: \"Test connection\",\n      max_tokens: 10,\n    };\n\n    try {\n      await this.createResponse(request, apiKey);\n      return true;\n    } catch (error) {\n      Logger.error(\"Test connection threw an exception\", error);\n      return false;\n    }\n  }\n}\n\n// Export singleton instance\nexport const octagonApi = new OctagonApiService();\n","/**\n * Browser and API support detection utilities\n * Used to provide compatibility warnings to users\n */\n\nimport Logger from './logger';\n\n/**\n * Detects if the browser is Internet Explorer\n * @returns true if the browser is IE, false otherwise\n */\nexport function detectIE(): boolean {\n  try {\n    const ua = window.navigator.userAgent;\n    const msie = ua.indexOf('MSIE ');\n    const trident = ua.indexOf('Trident/');\n    \n    return (msie > 0 || trident > 0);\n  } catch (error) {\n    Logger.error('Error detecting browser:', error);\n    return false; // Assume not IE if detection fails\n  }\n}\n\n/**\n * Checks if all required APIs are supported in the current environment\n * @returns An array of issues (empty if all requirements are met)\n */\nexport function checkRequiredApiSupport(): string[] {\n  const issues: string[] = [];\n  \n  try {\n    // Check for SharedRuntime support\n    if (!Office.context.requirements.isSetSupported('SharedRuntime', '1.1')) {\n      issues.push(\"This add-in requires SharedRuntime support. Please update to a newer version of Office.\");\n    }\n    \n    // Check for ExcelApi support\n    if (!Office.context.requirements.isSetSupported('ExcelApi', '1.7')) {\n      issues.push(\"Some Excel features require Excel API 1.7 or later. Please update to a newer version of Excel.\");\n    }\n    \n    // Check for CustomFunctions support\n    if (!Office.context.requirements.isSetSupported('CustomFunctions', '1.1')) {\n      issues.push(\"Custom functions require Excel support for CustomFunctions 1.1 or later.\");\n    }\n    \n    // Check if we're in a compatible platform for our add-in\n    checkPlatformCompatibility(issues);\n    \n  } catch (error) {\n    Logger.error('Error checking API support:', error);\n    issues.push(\"Error checking API compatibility. Some features may not work as expected.\");\n  }\n  \n  return issues;\n}\n\n/**\n * Checks platform compatibility and adds any issues to the issues array\n * @param issues Array to add platform compatibility issues to\n */\nfunction checkPlatformCompatibility(issues: string[]): void {\n  // Check if we're in a web browser\n  try {\n    const platform = Office.context.platform;\n    const host = Office.context.host;\n    \n    // Log platform information for diagnostics\n    Logger.info(`Running on platform: ${platform}, host: ${host}`);\n    \n    // Check specific platform requirements\n    if (platform === Office.PlatformType.PC) {\n      // Check for Windows version compatibility if needed\n      // This would require additional detection code\n    } else if (platform === Office.PlatformType.Mac) {\n      // Check for Mac-specific issues if needed\n    } else if (platform === Office.PlatformType.OfficeOnline) {\n      // Check for Office Online specific issues\n      \n      // Example: Warn about possible streaming limitations in Excel Online\n      issues.push(\"Excel Online may have limitations with long-running functions. Consider using Excel desktop for complex operations.\");\n    }\n    \n    // Ensure we're running in Excel\n    if (host !== Office.HostType.Excel) {\n      issues.push(\"This add-in is designed for Excel and may not function correctly in other Office applications.\");\n    }\n    \n  } catch (error) {\n    Logger.error('Error detecting platform:', error);\n    // Don't add to issues here as we already have a general error message\n  }\n}","/**\n * Octagon Excel Add-in Taskpane\n * This file handles the UI and interaction for the Octagon Excel Add-in taskpane\n */\n\nimport { OCTAGON_AGENTS, octagonApi } from \"../api\";\nimport { checkRequiredApiSupport, detectIE } from \"../utils/browserSupport\";\nimport Logger from \"../utils/logger\";\n\n// Track the application state\nlet isAuthenticated = false;\n\n// Initialize the taskpane when Office is ready\nOffice.onReady(async (info) => {\n  try {\n    Logger.info(\"Office is ready - initializing Octagon taskpane\");\n\n    // Initialize the API service\n    octagonApi.initialize();\n\n    // Add event listeners to UI elements\n    setupEventListeners();\n\n    // Show auth view first (this ensures UI is visible)\n    checkApiKeyStatus();\n\n    // Check browser compatibility\n    if (detectIE()) {\n      showBrowserWarning(\n        \"Internet Explorer is not fully supported. For the best experience, please use Microsoft Edge, Chrome, or another modern browser.\"\n      );\n    }\n\n    // Check if all required APIs are supported\n    const apiSupportIssues = checkRequiredApiSupport();\n    if (apiSupportIssues.length > 0) {\n      showApiSupportWarning(apiSupportIssues);\n    }\n\n    Logger.info(\"Taskpane initialized\");\n  } catch (error) {\n    Logger.error(\"Error during taskpane initialization:\", error);\n  }\n});\n\n/**\n * Set up event listeners for UI interactions\n */\nfunction setupEventListeners() {\n  // Submit button\n  const submitButton = document.getElementById(\"submit-button\");\n  if (submitButton) {\n    submitButton.addEventListener(\"click\", handleSubmit);\n  }\n\n  // Test Connection button\n  const testConnectionButton = document.getElementById(\"test-connection-button\");\n  if (testConnectionButton) {\n    testConnectionButton.addEventListener(\"click\", handleTestConnection);\n  }\n\n  // Back to Login button\n  const backToLoginButton = document.getElementById(\"back-to-login-button\");\n  if (backToLoginButton) {\n    backToLoginButton.addEventListener(\"click\", handleLogout);\n  }\n\n  // Enter key in API key input\n  const apiKeyInput = document.getElementById(\"api-key-input\") as HTMLInputElement;\n  if (apiKeyInput) {\n    apiKeyInput.addEventListener(\"keydown\", (event) => {\n      if (event.key === \"Enter\") {\n        handleSubmit();\n      }\n    });\n\n    // Clear the authentication message and update the button states when the user types or backspaces\n    apiKeyInput.addEventListener(\"input\", () => {\n      clearAuthError();\n      updateButtonStates();\n    });\n  }\n\n  // Set initial button states\n  updateButtonStates();\n}\n\n/**\n * Update button states based on API key input\n */\nfunction updateButtonStates() {\n  const apiKeyInput = document.getElementById(\"api-key-input\") as HTMLInputElement;\n  const submitButton = document.getElementById(\"submit-button\");\n  const testConnectionButton = document.getElementById(\"test-connection-button\");\n\n  const hasValue = apiKeyInput?.value?.trim().length > 0;\n\n  // Enable/disable buttons based on whether there's input\n  if (submitButton) {\n    if (hasValue) {\n      submitButton.removeAttribute(\"disabled\");\n    } else {\n      submitButton.setAttribute(\"disabled\", \"true\");\n    }\n  }\n\n  if (testConnectionButton) {\n    if (hasValue) {\n      testConnectionButton.removeAttribute(\"disabled\");\n    } else {\n      testConnectionButton.setAttribute(\"disabled\", \"true\");\n    }\n  }\n}\n\n/**\n * Show the authentication view\n */\nfunction showAuthView() {\n  const authView = document.getElementById(\"auth-view\");\n  const agentsView = document.getElementById(\"agents-view\");\n\n  if (authView && agentsView) {\n    authView.style.display = \"block\";\n    authView.classList.add(\"fade-in\");\n    agentsView.style.display = \"none\";\n  }\n}\n\n/**\n * Check the status of the API key and update the UI accordingly\n */\nfunction checkApiKeyStatus() {\n  const hasStoredKey = octagonApi.checkForStoredApiKey();\n\n  if (hasStoredKey) {\n    // If we have a stored key, hide the status message but log it\n    Logger.info(\"API Key detected from previous sessions\");\n\n    // Set authenticated state\n    isAuthenticated = true;\n\n    // Automatically proceed to the Main Menu after a brief delay\n    setTimeout(() => showAgentsView(), 500);\n  } else {\n    // No API key detected, show the authentication view\n    showAuthView();\n  }\n}\n\n/**\n * Handle the Submit button click\n */\nfunction handleSubmit() {\n  try {\n    // Get the API key from the input field\n    const apiKeyInput = document.getElementById(\"api-key-input\") as HTMLInputElement;\n    const apiKey = apiKeyInput?.value?.trim();\n\n    if (!apiKey) {\n      showAuthError(\"Please enter an API Key.\");\n      return;\n    }\n\n    // TODO: Test connection before saving\n    // Set and persist the API key\n    octagonApi.setApiKey(apiKey);\n\n    // Success - show success message and enable continue button\n    clearAuthError();\n    showAuthSuccess(\"API Key saved successfully!\");\n    isAuthenticated = true;\n\n    // Automatically proceed to the Main Menu after a brief delay\n    // This gives the user a chance to see the success message first\n    setTimeout(() => showAgentsView(), 800);\n  } catch (error) {\n    // Show error message\n    showAuthError(\"An error occurred while saving the API key. Please try again.\");\n    Logger.error(\"Error saving API key:\", error);\n  }\n}\n\n/**\n * Handle the Test Connection button click\n */\nasync function handleTestConnection() {\n  try {\n    // Get the API key from the input field (if visible)\n    const apiKeyInput = document.getElementById(\"api-key-input\") as HTMLInputElement;\n    let apiKey = apiKeyInput?.value?.trim();\n\n    // If input is not visible or empty, raise an error immediately\n    if (!apiKeyInput || apiKeyInput.style.display === \"none\" || !apiKey) {\n      showAuthError(\"Please enter an API Key.\");\n      return;\n    }\n\n    // Show loading state\n    clearAuthError();\n    toggleAuthLoadingState(true);\n\n    // Test the connection\n    const isConnected = await octagonApi.testConnection(apiKey);\n\n    // Hide loading state\n    toggleAuthLoadingState(false);\n\n    if (isConnected) {\n      // Success - show success message and enable continue button\n      showAuthSuccess(\"Connection successful! API Key verified.\");\n    } else {\n      // Failed - show error message\n      showAuthError(\"Invalid API key. Please check and try again.\");\n    }\n  } catch (error) {\n    // Hide loading state\n    toggleAuthLoadingState(false);\n\n    // Show error message\n    showAuthError(\"An error occurred. Please try again.\");\n    Logger.error(\"Authentication error:\", error);\n  }\n}\n\n/**\n * Handle the Back to Login button click\n */\nfunction handleLogout() {\n  // Clear the API key\n  octagonApi.clearApiKey();\n  isAuthenticated = false;\n  Logger.info(\"API Key cleared\");\n\n  // Redirect to the login page after a brief delay\n  setTimeout(() => showAuthView(), 500);\n}\n\n/**\n * Show authentication error message\n * @param message Error message to display\n */\nfunction showAuthError(message: string) {\n  const errorElement = document.getElementById(\"auth-error\");\n  if (errorElement) {\n    errorElement.textContent = message;\n    errorElement.style.display = \"block\";\n  }\n}\n\n/**\n * Show authentication success message (temporarily)\n * @param message Success message to display\n */\nfunction showAuthSuccess(message: string) {\n  const errorElement = document.getElementById(\"auth-error\");\n  if (errorElement) {\n    errorElement.textContent = message;\n    errorElement.style.color = \"green\";\n    errorElement.style.display = \"block\";\n  }\n}\n\n/**\n * Clear authentication error message\n */\nfunction clearAuthError() {\n  const errorElement = document.getElementById(\"auth-error\");\n  if (errorElement) {\n    errorElement.textContent = \"\";\n    errorElement.style.display = \"none\";\n    errorElement.style.color = \"#a80000\"; // Reset to error color\n  }\n}\n\n/**\n * Toggle the loading state during authentication\n * @param isLoading Whether to show or hide the loading state\n */\nfunction toggleAuthLoadingState(isLoading: boolean) {\n  const submitButton = document.getElementById(\"submit-button\");\n  const testConnectionButton = document.getElementById(\"test-connection-button\");\n  const spinner = document.getElementById(\"auth-spinner\");\n\n  if (spinner) {\n    if (isLoading) {\n      if (submitButton) submitButton.setAttribute(\"disabled\", \"true\");\n      if (testConnectionButton) testConnectionButton.setAttribute(\"disabled\", \"true\");\n      spinner.style.display = \"block\";\n    } else {\n      if (submitButton) submitButton.removeAttribute(\"disabled\");\n      if (testConnectionButton) testConnectionButton.removeAttribute(\"disabled\");\n      spinner.style.display = \"none\";\n    }\n  }\n}\n\n/**\n * Show the agents view and populate it with agent data\n */\nfunction showAgentsView() {\n  const authView = document.getElementById(\"auth-view\");\n  const agentsView = document.getElementById(\"agents-view\");\n\n  if (authView && agentsView) {\n    authView.style.display = \"none\";\n    agentsView.style.display = \"block\";\n    agentsView.classList.add(\"fade-in\");\n\n    // Hide the old back-to-auth button in the header (if it exists)\n    const oldBackButton = document.getElementById(\"back-to-auth-button-header\");\n    if (oldBackButton) {\n      oldBackButton.style.display = \"none\";\n    }\n\n    // Populate the agents list\n    populateAgentsList();\n  }\n}\n\n/**\n * Populate the agents list with categories and agent cards\n */\nfunction populateAgentsList() {\n  const container = document.getElementById(\"agent-categories-container\");\n\n  if (!container) return;\n\n  // Clear the container\n  container.innerHTML = \"\";\n\n  // Group agents by category\n  const agentsByCategory = groupAgentsByCategory();\n\n  // Create a section for each category\n  for (const [category, agents] of Object.entries(agentsByCategory)) {\n    // Create category container\n    const categoryElement = document.createElement(\"div\");\n    categoryElement.className = \"agent-category\";\n\n    // Create category title\n    const titleElement = document.createElement(\"h3\");\n    titleElement.className = \"category-title\";\n    titleElement.textContent = category;\n    categoryElement.appendChild(titleElement);\n\n    // Create agent cards for this category\n    agents.forEach((agent) => {\n      const agentCard = createAgentCard(agent);\n      categoryElement.appendChild(agentCard);\n    });\n\n    // Add the category to the container\n    container.appendChild(categoryElement);\n  }\n}\n\n/**\n * Group agents by their category\n * @returns Record<string, typeof OCTAGON_AGENTS[0][]>\n */\nfunction groupAgentsByCategory() {\n  const categories: Record<string, (typeof OCTAGON_AGENTS)[0][]> = {};\n\n  OCTAGON_AGENTS.forEach((agent) => {\n    if (!categories[agent.category]) {\n      categories[agent.category] = [];\n    }\n    categories[agent.category].push(agent);\n  });\n\n  return categories;\n}\n\n/**\n * Create an agent card element\n * @param agent Agent information\n * @returns HTMLElement The agent card\n */\nfunction createAgentCard(agent: (typeof OCTAGON_AGENTS)[0]): HTMLElement {\n  const card = document.createElement(\"div\");\n  card.className = \"agent-card\";\n\n  // Agent title\n  const title = document.createElement(\"h4\");\n  title.className = \"agent-title\";\n  title.textContent = agent.displayName;\n  card.appendChild(title);\n\n  // Agent description\n  const description = document.createElement(\"p\");\n  description.className = \"agent-description\";\n  description.textContent = agent.description;\n  card.appendChild(description);\n\n  // Agent metadata\n  const meta = document.createElement(\"div\");\n  meta.className = \"agent-meta\";\n\n  // Formula name\n  const formula = document.createElement(\"div\");\n  formula.innerHTML = `<strong>Excel Formula:</strong> <span class=\"formula-name\">${agent.excelFormulaName}(\"your prompt\")</span>`;\n  meta.appendChild(formula);\n\n  // Example prompt\n  if (agent.examplePrompt) {\n    const example = document.createElement(\"div\");\n    example.innerHTML = `<strong>Example:</strong>`;\n\n    // Create a container for the prompt to allow positioning the copy button\n    const promptContainer = document.createElement(\"div\");\n    promptContainer.style.position = \"relative\";\n    promptContainer.style.display = \"inline-block\";\n    promptContainer.style.width = \"100%\";\n\n    const promptElement = document.createElement(\"span\");\n    promptElement.className = \"example-prompt\";\n    promptElement.textContent = agent.examplePrompt;\n    promptContainer.appendChild(promptElement);\n\n    // Add copy button for the example prompt\n    const copyButton = document.createElement(\"button\");\n    copyButton.className = \"copy-button\";\n    copyButton.title = \"Copy example\";\n    copyButton.innerHTML = '<i class=\"ms-Icon ms-Icon--Copy\"></i>';\n    copyButton.onclick = (e) => {\n      e.stopPropagation();\n      navigator.clipboard\n        .writeText(agent.examplePrompt)\n        .then(() => {\n          // Show success feedback\n          copyButton.innerHTML = '<i class=\"ms-Icon ms-Icon--CheckMark copy-success\"></i>';\n          setTimeout(() => {\n            copyButton.innerHTML = '<i class=\"ms-Icon ms-Icon--Copy\"></i>';\n          }, 1500);\n        })\n        .catch((err) => {\n          console.error(\"Could not copy text: \", err);\n        });\n    };\n\n    promptContainer.appendChild(copyButton);\n    example.appendChild(promptContainer);\n    meta.appendChild(example);\n  }\n\n  card.appendChild(meta);\n\n  // Usage examples section (if available)\n  if (agent.usageExamples && agent.usageExamples.length > 0) {\n    const usageSection = document.createElement(\"div\");\n    usageSection.className = \"usage-examples-section\";\n\n    // Usage examples heading\n    const usageHeading = document.createElement(\"h5\");\n    usageHeading.className = \"usage-heading\";\n    usageHeading.textContent = \"Usage Examples:\";\n    usageSection.appendChild(usageHeading);\n\n    // Create a list for the examples\n    const examplesList = document.createElement(\"div\");\n    examplesList.className = \"examples-list\";\n\n    // Add each example to the list\n    agent.usageExamples.forEach((example) => {\n      const exampleItem = document.createElement(\"div\");\n      exampleItem.className = \"example-item\";\n\n      const topicElement = document.createElement(\"div\");\n      topicElement.className = \"example-topic\";\n      topicElement.textContent = example.topic;\n      exampleItem.appendChild(topicElement);\n\n      // Create a container for the prompt to allow positioning the copy button\n      const promptContainer = document.createElement(\"div\");\n      promptContainer.className = \"example-prompt-container\";\n      promptContainer.style.position = \"relative\";\n\n      const promptElement = document.createElement(\"div\");\n      promptElement.className = \"example-prompt code\";\n      promptElement.textContent = example.prompt;\n      promptContainer.appendChild(promptElement);\n\n      // Add copy button\n      const copyButton = document.createElement(\"button\");\n      copyButton.className = \"copy-button\";\n      copyButton.title = \"Copy example\";\n      copyButton.innerHTML = '<i class=\"ms-Icon ms-Icon--Copy\"></i>';\n      copyButton.onclick = (e) => {\n        e.stopPropagation();\n        navigator.clipboard\n          .writeText(example.prompt)\n          .then(() => {\n            // Show success feedback\n            copyButton.innerHTML = '<i class=\"ms-Icon ms-Icon--CheckMark copy-success\"></i>';\n            setTimeout(() => {\n              copyButton.innerHTML = '<i class=\"ms-Icon ms-Icon--Copy\"></i>';\n            }, 1500);\n          })\n          .catch((err) => {\n            console.error(\"Could not copy text: \", err);\n          });\n      };\n\n      promptContainer.appendChild(copyButton);\n      exampleItem.appendChild(promptContainer);\n\n      examplesList.appendChild(exampleItem);\n    });\n\n    usageSection.appendChild(examplesList);\n    card.appendChild(usageSection);\n  }\n\n  return card;\n}\n\n/**\n * Shows a browser compatibility warning to the user\n */\nfunction showBrowserWarning(message: string) {\n  const warningDiv = document.createElement(\"div\");\n  warningDiv.className = \"browser-warning\";\n  warningDiv.innerHTML = `\n    <div class=\"warning-icon\"><i class=\"ms-Icon ms-Icon--Warning\"></i></div>\n    <div class=\"warning-message\">${message}</div>\n  `;\n\n  // Insert at the top of the body or in a specific container\n  const container = document.querySelector(\".content-container\") || document.body;\n  container.insertBefore(warningDiv, container.firstChild);\n}\n\n/**\n * Shows API support warnings to the user\n */\nfunction showApiSupportWarning(issues: string[]) {\n  const warningDiv = document.querySelector(\".api-support-warning\");\n  if (!warningDiv) return;\n\n  (warningDiv as HTMLElement).style.display = \"inline-block\";\n\n  console.log(\"showing api support warning\", issues);\n\n  if (issues.length > 0) {\n    const warningMessage = warningDiv.firstElementChild;\n    const issueList = document.createElement(\"ul\");\n    issues.forEach((issue) => {\n      const issueItem = document.createElement(\"li\");\n      issueItem.textContent = issue;\n      issueList.appendChild(issueItem);\n    });\n    warningMessage.appendChild(issueList);\n  }\n}\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_1___ = new URL(\"../../assets/icon-80.png\", import.meta.url);\n// Module\nvar code = \"<!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Octagon AI - Market Intelligence for Excel</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"ms-font-m ms-Fabric ms-bgColor-neutralLighter\\\"> <div class=\\\"api-support-warning\\\" style=\\\"display:none\\\"> <div class=\\\"warning-message\\\"> <i class=\\\"warning-icon ms-Icon ms-Icon--Warning\\\"></i> Some features may not work correctly in your current environment </div> </div> <header class=\\\"octagon-header\\\"> <img width=\\\"80\\\" height=\\\"80\\\" src=\\\"\" + ___HTML_LOADER_IMPORT_1___ + \"\\\" alt=\\\"Octagon AI\\\" title=\\\"Octagon AI\\\"/> <h1>Octagon AI</h1> </header> <main id=\\\"auth-view\\\" class=\\\"main-content\\\" style=\\\"display:none\\\"> <div class=\\\"content-container\\\"> <p class=\\\"ms-font-m description\\\"> Access real-time market intelligence and financial data directly in Excel with Octagon AI agents. </p> <div class=\\\"auth-container\\\"> <h3 class=\\\"ms-font-l\\\">Authentication Required</h3> <p class=\\\"ms-font-m\\\">Please enter your Octagon API key to continue:</p> <div id=\\\"api-key-input-container\\\" class=\\\"form-group\\\"> <input type=\\\"password\\\" id=\\\"api-key-input\\\" class=\\\"ms-TextField-field\\\" placeholder=\\\"Enter your API key here\\\"/> <div id=\\\"auth-error\\\" class=\\\"error-message\\\" style=\\\"display:none\\\"></div> </div> <div class=\\\"button-container\\\"> <button id=\\\"submit-button\\\" class=\\\"ms-Button ms-Button--primary\\\"> <span class=\\\"ms-Button-label\\\">Submit</span> </button> <button id=\\\"test-connection-button\\\" class=\\\"ms-Button ms-Button--default\\\"> <span class=\\\"ms-Button-label\\\">Test Connection</span> </button> <div id=\\\"auth-spinner\\\" class=\\\"ms-Spinner\\\" style=\\\"display:none\\\"></div> </div> <p class=\\\"ms-font-s signup-link\\\"> Don't have an API key? <a href=\\\"https://www.octagonai.co/\\\" target=\\\"_blank\\\">Get one here</a> </p> </div> </div> <div class=\\\"footer\\\"> <div class=\\\"version\\\">Version 1.0.0</div> <div class=\\\"footer-links\\\"> <a href=\\\"https://www.octagonai.co/terms-of-service\\\" target=\\\"_blank\\\">Terms of Service</a> | <a href=\\\"https://www.octagonai.co/privacy\\\" target=\\\"_blank\\\">Privacy</a> | <a href=\\\"mailto:contact@octagonai.co\\\">Contact</a> | <a href=\\\"https://app.octagonagents.com/playground\\\" target=\\\"_blank\\\">API Playground</a> </div> </div> </main> <main id=\\\"agents-view\\\" class=\\\"main-content\\\" style=\\\"display:none\\\"> <div class=\\\"content-container\\\"> <div id=\\\"agent-categories-container\\\"></div> <div class=\\\"back-button-container\\\"> <button id=\\\"back-to-login-button\\\" class=\\\"ms-Button ms-Button--default\\\"> <span class=\\\"ms-Button-icon\\\"> <i class=\\\"ms-Icon ms-Icon--ChevronLeft\\\"></i> </span> <span class=\\\"ms-Button-label\\\">Back to Login</span> </button> </div> <div class=\\\"additional-resources\\\"> <h3>Resources</h3> <ul> <li> <i class=\\\"ms-Icon ms-Icon--ReadingMode\\\"></i> <a href=\\\"https://docs.octagonagents.com/\\\" target=\\\"_blank\\\">Official Documentation</a> </li> <li> <i class=\\\"ms-Icon ms-Icon--TestBeaker\\\"></i> <a href=\\\"https://app.octagonagents.com/playground\\\" target=\\\"_blank\\\">API Playground</a> </li> </ul> </div> </div> <div class=\\\"footer\\\"> <div class=\\\"version\\\">Version 1.0</div> <div class=\\\"footer-links\\\"> <a href=\\\"https://www.octagonai.co/terms-of-service\\\" target=\\\"_blank\\\">Terms of Service</a> | <a href=\\\"https://www.octagonai.co/privacy\\\" target=\\\"_blank\\\">Privacy</a> | <a href=\\\"mailto:contact@octagonai.co\\\">Contact</a> </div> </div> </main> </body> </html>\";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","AgentType","AgentCategory","OCTAGON_AGENTS","id","OctagonAgent","displayName","excelFormulaName","description","category","MarketIntelligence","usageExamples","topic","prompt","LogLevel","currentLogLevel","ERROR","logLevelPriority","_defineProperty","DEBUG","INFO","WARN","log","level","message","data","timestamp","Date","toISOString","formattedMessage","concat","console","debug","info","warn","error","formatMap","raw","format","type","table","strict","name","schema","properties","items","anyOf","required","title","additionalProperties","single_cell","getTextFormat","textFormat","Logger","CustomFunctions","ErrorCode","invalidValue","parseTextFormat","content","JSON","parse","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","d","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","_regenerator","w","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","_defineProperties","_toPropertyKey","key","_typeof","toPrimitive","String","_toPrimitive","API_KEY_STORAGE_NAME","CACHED_SESSION_SETTINGS_KEY","OctagonApiService","apiUrl","_classCallCheck","isOfficeInitialized","loadApiKey","isAuthenticated","cachedSessionData","sessionStorage","getItem","sessionData","octagon_api_key","apiKey","saveApiKey","setItem","stringify","newSessionData","_callAgent","_callee","model","_response$content","response","_context","substring","trim","createResponse","input","text","_x","_x2","_x3","parseError","directApiKey","removeItem","_createResponse","_callee2","requestUrl","token","headers","_t","_context2","URL","Headers","Authorization","fetch","method","body","ok","status","statusText","json","parseAgentResponse","_x4","_x5","_parseAgentResponse","_callee3","_iterator","_step","output","_iterator2","_step2","_t2","_t3","_t4","_context3","_createForOfIteratorHelper","s","_x6","_testConnection","_callee4","request","_t5","_context4","max_tokens","_x7","octagonApi","detectIE","ua","navigator","userAgent","msie","indexOf","trident","checkRequiredApiSupport","issues","Office","context","requirements","isSetSupported","push","platform","host","PlatformType","PC","Mac","OfficeOnline","HostType","Excel","checkPlatformCompatibility","setupEventListeners","submitButton","getElementById","addEventListener","handleSubmit","testConnectionButton","handleTestConnection","backToLoginButton","handleLogout","apiKeyInput","event","clearAuthError","updateButtonStates","_apiKeyInput$value","hasValue","removeAttribute","setAttribute","showAuthView","authView","agentsView","style","display","classList","add","checkApiKeyStatus","checkForStoredApiKey","setTimeout","showAgentsView","_apiKeyInput$value2","showAuthError","setApiKey","showAuthSuccess","_handleTestConnection","_apiKeyInput$value3","isConnected","toggleAuthLoadingState","testConnection","clearApiKey","errorElement","textContent","color","isLoading","spinner","oldBackButton","container","innerHTML","agentsByCategory","categories","forEach","agent","groupAgentsByCategory","_loop","_Object$entries$_i","_Object$entries","_i","agents","categoryElement","createElement","className","titleElement","appendChild","agentCard","card","meta","formula","examplePrompt","example","promptContainer","position","width","promptElement","copyButton","onclick","stopPropagation","clipboard","writeText","catch","err","usageSection","usageHeading","examplesList","exampleItem","topicElement","createAgentCard","entries","populateAgentsList","showBrowserWarning","warningDiv","querySelector","insertBefore","firstChild","showApiSupportWarning","warningMessage","firstElementChild","issueList","issue","issueItem","onReady","_ref","apiSupportIssues","initialize"],"sourceRoot":""}