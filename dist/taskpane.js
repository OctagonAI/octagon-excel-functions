/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={35132:function(e,t,n){e.exports=n.p+"assets/icon-80.png"},58394:function(e,t,n){e.exports=n.p+"0f242e216c875d7cc5a4.css"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.m=e,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,function(){var e=function(e){return e.OctagonAgent="octagon-agent",e}({}),t=function(e){return e.MarketIntelligence="Market Intelligence",e}(t||{}),n=[{id:e.OctagonAgent,displayName:"Octagon Agent",excelFormulaName:"OCTAGON.OCTAGON_AGENT",description:"Public and Private market intelligence agent that optimally routes requests to appropriate specialized agents",category:t.MarketIntelligence,usageExamples:[{topic:"Financial Metrics Analysis",prompt:'=OCTAGON.OCTAGON_AGENT("Retrieve year-over-year growth in key income-statement items for AAPL, limited to 5 records and filtered by period FY.")'},{topic:"SEC Filing Analysis",prompt:'=OCTAGON.OCTAGON_AGENT("Analyze the latest 10-K filing for AAPL and extract key financial metrics and risk factors.")'},{topic:"Stock Performance",prompt:'=OCTAGON.OCTAGON_AGENT("Retrieve the daily closing prices for AAPL over the last 30 days.")'},{topic:"Earnings Call Insights",prompt:'=OCTAGON.OCTAGON_AGENT("Analyze AAPL\'s latest earnings call transcript and extract key insights about future guidance.")'},{topic:"Company Overview",prompt:'=OCTAGON.OCTAGON_AGENT("Provide a comprehensive overview of Stripe, including its business model and key metrics.")'},{topic:"Funding History",prompt:'=OCTAGON.OCTAGON_AGENT("Retrieve the funding history for Stripe, including all rounds and investors.")'},{topic:"M&A Activity",prompt:'=OCTAGON.OCTAGON_AGENT("List all M&A transactions involving Stripe in the last 2 years.")'},{topic:"Investor Profile",prompt:'=OCTAGON.OCTAGON_AGENT("Provide a detailed profile of Sequoia Capital\'s investment strategy and portfolio.")'},{topic:"Debt Analysis",prompt:'=OCTAGON.OCTAGON_AGENT("Analyze Stripe\'s debt financing history and current debt structure.")'},{topic:"Institutional Holdings",prompt:'=OCTAGON.OCTAGON_AGENT("Retrieve the most recent Form 13F and related filings submitted by institutional investors.")'}]}];function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t,n){return(t=function(e){var t=function(e){if("object"!=r(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i=function(e){return e.DEBUG="DEBUG",e.INFO="INFO",e.WARN="WARN",e.ERROR="ERROR",e}({}),a=i.ERROR,c=o(o(o(o({},i.DEBUG,0),i.INFO,1),i.WARN,2),i.ERROR,3);function s(e,t,n){if(c[e]>=c[a]){var r=(new Date).toISOString(),o="[".concat(r,"] [").concat(e,"] ").concat(t);switch(e){case i.DEBUG:console.debug(o,n||"");break;case i.INFO:console.info(o,n||"");break;case i.WARN:console.warn(o,n||"");break;case i.ERROR:console.error(o,n||"")}}}var u=function(e,t){return s(i.DEBUG,e,t)},l=function(e,t){return s(i.INFO,e,t)},p=function(e,t){return s(i.WARN,e,t)},f=function(e,t){return s(i.ERROR,e,t)},d={raw:{format:{type:"text"}},table:{format:{type:"json_schema",strict:!0,name:"TableFormat",schema:{properties:{data:{description:"Nested list of values for multiple spreadsheet cells. Outer list represents rows, inner list represents columns. Each element in the inner list is a cell value.",items:{items:{anyOf:[{type:"number"},{type:"string"}]},type:"array"},type:"array"}},required:["data"],title:"ExcelFormat",type:"object",additionalProperties:!1}}},single_cell:{format:{type:"json_schema",strict:!0,name:"SingleCellFormat",schema:{properties:{data:{anyOf:[{type:"number"},{type:"string"}],description:"Single value of a spreadsheet cell",title:"Data"}},required:["data"],title:"ExcelCell",type:"object",additionalProperties:!1}}}};function m(e){var t=d[e];if(!t)throw f("Invalid format: ".concat(e)),new CustomFunctions.Error(CustomFunctions.ErrorCode.invalidValue,'Invalid format. Please use "raw", "table", or "single_cell"');return t}function y(e,t){return l("Parsing text format:",{content:e,format:t}),"table"==t?JSON.parse(e).data:"single_cell"==t?[[JSON.parse(e).data]]:[[e]]}function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function g(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return h(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function b(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof c?r:c,u=Object.create(s.prototype);return A(u,"_invoke",function(n,r,o){var i,c,s,u=0,l=o||[],p=!1,f={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return i=t,c=0,s=e,f.n=n,a}};function d(n,r){for(c=n,s=r,t=0;!p&&u&&!o&&t<l.length;t++){var o,i=l[t],d=f.p,m=i[2];n>3?(o=m===r)&&(s=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,f.v=r,f.n=i[1]):d<m&&(o=n<3||i[0]>r||r>m)&&(i[4]=n,i[5]=r,f.n=m,c=0))}if(o||n>1)return a;throw p=!0,r}return function(o,l,m){if(u>1)throw TypeError("Generator is already running");for(p&&1===l&&d(l,m),c=l,s=m;(t=c<2?e:s)||!p;){i||(c?c<3?(c>1&&(f.n=-1),d(c,s)):f.n=s:f.v=s);try{if(u=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(p=f.n<0)?s:n.call(r,f))!==a)break}catch(t){i=e,c=1,s=t}finally{u=1}}return{value:t,done:p}}}(n,o,i),!0),u}var a={};function c(){}function s(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(A(t={},r,function(){return this}),t),p=u.prototype=c.prototype=Object.create(l);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,A(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return s.prototype=u,A(p,"constructor",u),A(u,"constructor",s),s.displayName="GeneratorFunction",A(u,o,"GeneratorFunction"),A(p),A(p,o,"Generator"),A(p,r,function(){return this}),A(p,"toString",function(){return"[object Generator]"}),(b=function(){return{w:i,m:f}})()}function A(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}A=function(e,t,n,r){function i(t,n){A(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},A(e,t,n,r)}function E(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function O(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){E(i,r,o,a,c,"next",e)}function c(e){E(i,r,o,a,c,"throw",e)}a(void 0)})}}function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,k(r.key),r)}}function w(e,t,n){return(t=k(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function k(e){var t=function(e){if("object"!=v(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=v(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==v(t)?t:t+""}var I="octagon_api_key",C="CachedSessionSettings",T=function(){return t=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"https://octagon-api-gateway-staging.onrender.com";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),w(this,"apiKey",null),w(this,"isOfficeInitialized",!1),this.apiUrl=t,l("OctagonApiService created with API URL: ".concat(this.apiUrl))},n=[{key:"initialize",value:function(){this.isOfficeInitialized=!0,this.loadApiKey(),l("OctagonApiService fully initialized. API key status: ".concat(this.isAuthenticated()?"Available":"Not available"))}},{key:"checkForStoredApiKey",value:function(){try{var e=sessionStorage.getItem(C);if(e){var t=JSON.parse(e);if(t&&t.octagon_api_key)return l("Found API key in CachedSessionSettings"),!0}if(sessionStorage.getItem(I))return l("Found API key in direct SessionStorage"),!0}catch(e){f("Error checking for stored API key",e)}return!1}},{key:"setApiKey",value:function(e){this.apiKey=e,this.saveApiKey(e)}},{key:"saveApiKey",value:function(e){try{sessionStorage.setItem(I,e);try{var t=sessionStorage.getItem(C);if(t){var n=JSON.parse(t);n.octagon_api_key=e,sessionStorage.setItem(C,JSON.stringify(n))}else{var r={octagon_api_key:e};sessionStorage.setItem(C,JSON.stringify(r))}}catch(e){p("Failed to save to CachedSessionSettings",e)}l("API key saved to SessionStorage")}catch(e){f("Failed to save API key to SessionStorage",e)}}},{key:"callAgent",value:(a=O(b().m(function e(t,n,r){var o,i,a,c;return b().w(function(e){for(;;)switch(e.n){case 0:if(u("callAgent invoked with model: ".concat(t,", prompt: ").concat(n.substring(0,50),"...")),n&&""!==n.trim()){e.n=1;break}throw new Error("Please provide a valid prompt");case 1:if(i=null!=r?r:"table",u("Calling agent...",{isAuthenticated:this.isAuthenticated(),apiKey:this.apiKey}),this.isAuthenticated()){e.n=2;break}throw f("API request failed: Not authenticated"),new Error("Not authenticated. Please set your API key first.");case 2:return e.n=3,this.createResponse({model:t,input:n,text:m(i)});case 3:return a=e.v,c=y(null!==(o=a.content)&&void 0!==o?o:"No response content",i),l("Agent response:",c),e.a(2,c)}},e,this)})),function(e,t,n){return a.apply(this,arguments)})},{key:"loadApiKey",value:function(){l("Attempting to load API key from SessionStorage");try{var e=sessionStorage.getItem(C);if(e)try{var t=JSON.parse(e);if(t&&t.octagon_api_key)return this.apiKey=t.octagon_api_key,void l("API key loaded from CachedSessionSettings")}catch(e){p("Failed to parse CachedSessionSettings",e)}var n=sessionStorage.getItem(I);if(n)return this.apiKey=n,void l("API key loaded from direct SessionStorage")}catch(e){f("Failed to load API key from SessionStorage",e)}l("No API key found in SessionStorage")}},{key:"isAuthenticated",value:function(){return!!this.apiKey||(this.loadApiKey(),!!this.apiKey&&""!==this.apiKey.trim())}},{key:"clearApiKey",value:function(){this.apiKey=null;try{sessionStorage.removeItem(I);var e=sessionStorage.getItem(C);if(e)try{var t=JSON.parse(e);t&&(delete t.octagon_api_key,sessionStorage.setItem(C,JSON.stringify(t)))}catch(e){p("Failed to parse CachedSessionSettings for clearing",e)}l("API key cleared from all SessionStorage locations")}catch(e){f("Failed to clear API key from SessionStorage",e)}}},{key:"createResponse",value:(i=O(b().m(function e(t,n){var r,o,i,a,c;return b().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r=new URL("/v1/responses",this.apiUrl),o=null!=n?n:this.apiKey){e.n=1;break}throw new Error("No API key provided");case 1:return e.p=1,i=new Headers({"Content-Type":"application/json",Authorization:"Bearer ".concat(o)}),e.n=2,fetch(r,{method:"POST",headers:i,body:JSON.stringify(t)});case 2:if((a=e.v).ok){e.n=3;break}throw f("Agent request failed: ".concat(a.status," ").concat(a.statusText),a.json()),new Error("Agent request failed: ".concat(a.status," ").concat(a.statusText));case 3:return e.n=4,this.parseAgentResponse(a);case 4:return e.a(2,e.v);case 5:throw e.p=5,c=e.v,new Error("Failed to create agent response: ".concat(c instanceof Error?c.message:"Unknown error"));case 6:return e.a(2)}},e,this,[[1,5]])})),function(e,t){return i.apply(this,arguments)})},{key:"parseAgentResponse",value:(o=O(b().m(function e(t){var n,r,o,i,a,c,s,u,l,p,d;return b().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,t.json();case 1:n=e.v,r="",o=g(n.output),e.p=2,o.s();case 3:if((i=o.n()).done){e.n=13;break}if("message"===(a=i.value).type){e.n=4;break}return e.a(3,12);case 4:c=g(a.content),e.p=5,c.s();case 6:if((s=c.n()).done){e.n=9;break}if("output_text"===(u=s.value).type){e.n=7;break}return e.a(3,8);case 7:r+=u.text;case 8:e.n=6;break;case 9:e.n=11;break;case 10:e.p=10,l=e.v,c.e(l);case 11:return e.p=11,c.f(),e.f(11);case 12:e.n=3;break;case 13:e.n=15;break;case 14:e.p=14,p=e.v,o.e(p);case 15:return e.p=15,o.f(),e.f(15);case 16:return e.a(2,{content:r,id:n.id,model:n.model});case 17:throw e.p=17,d=e.v,f("Error processing streamed response:",d),new Error("Failed to process streamed response: ".concat(d instanceof Error?d.message:"Unknown error"));case 18:return e.a(2)}},e,null,[[5,10,11,12],[2,14,15,16],[0,17]])})),function(e){return o.apply(this,arguments)})},{key:"testConnection",value:(r=O(b().m(function t(n){var r,o;return b().w(function(t){for(;;)switch(t.p=t.n){case 0:return l("Testing API connection with stored key"),r={model:e.OctagonAgent,input:"Test connection",max_tokens:10},t.p=1,t.n=2,this.createResponse(r,n);case 2:return t.a(2,!0);case 3:return t.p=3,o=t.v,f("Test connection threw an exception",o),t.a(2,!1)}},t,this,[[1,3]])})),function(e){return r.apply(this,arguments)})}],n&&S(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,r,o,i,a}(),P=new T;function N(){try{var e=window.navigator.userAgent,t=e.indexOf("MSIE "),n=e.indexOf("Trident/");return t>0||n>0}catch(e){return f("Error detecting browser:",e),!1}}function x(){var e=[];try{Office.context.requirements.isSetSupported("SharedRuntime","1.1")||e.push("This add-in requires SharedRuntime support. Please update to a newer version of Office."),Office.context.requirements.isSetSupported("ExcelApi","1.7")||e.push("Some Excel features require Excel API 1.7 or later. Please update to a newer version of Excel."),Office.context.requirements.isSetSupported("CustomFunctions","1.1")||e.push("Custom functions require Excel support for CustomFunctions 1.1 or later."),function(e){try{var t=Office.context.platform,n=Office.context.host;l("Running on platform: ".concat(t,", host: ").concat(n)),t===Office.PlatformType.PC||t===Office.PlatformType.Mac||t===Office.PlatformType.OfficeOnline&&e.push("Excel Online may have limitations with long-running functions. Consider using Excel desktop for complex operations."),n!==Office.HostType.Excel&&e.push("This add-in is designed for Excel and may not function correctly in other Office applications.")}catch(e){f("Error detecting platform:",e)}}(e)}catch(t){f("Error checking API support:",t),e.push("Error checking API compatibility. Some features may not work as expected.")}return e}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function _(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof c?r:c,u=Object.create(s.prototype);return j(u,"_invoke",function(n,r,o){var i,c,s,u=0,l=o||[],p=!1,f={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return i=t,c=0,s=e,f.n=n,a}};function d(n,r){for(c=n,s=r,t=0;!p&&u&&!o&&t<l.length;t++){var o,i=l[t],d=f.p,m=i[2];n>3?(o=m===r)&&(s=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,f.v=r,f.n=i[1]):d<m&&(o=n<3||i[0]>r||r>m)&&(i[4]=n,i[5]=r,f.n=m,c=0))}if(o||n>1)return a;throw p=!0,r}return function(o,l,m){if(u>1)throw TypeError("Generator is already running");for(p&&1===l&&d(l,m),c=l,s=m;(t=c<2?e:s)||!p;){i||(c?c<3?(c>1&&(f.n=-1),d(c,s)):f.n=s:f.v=s);try{if(u=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(p=f.n<0)?s:n.call(r,f))!==a)break}catch(t){i=e,c=1,s=t}finally{u=1}}return{value:t,done:p}}}(n,o,i),!0),u}var a={};function c(){}function s(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(j(t={},r,function(){return this}),t),p=u.prototype=c.prototype=Object.create(l);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,j(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return s.prototype=u,j(p,"constructor",u),j(u,"constructor",s),s.displayName="GeneratorFunction",j(u,o,"GeneratorFunction"),j(p),j(p,o,"Generator"),j(p,r,function(){return this}),j(p,"toString",function(){return"[object Generator]"}),(_=function(){return{w:i,m:f}})()}function j(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}j=function(e,t,n,r){function i(t,n){j(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},j(e,t,n,r)}function R(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function F(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){R(i,r,o,a,c,"next",e)}function c(e){R(i,r,o,a,c,"throw",e)}a(void 0)})}}function B(){var e=document.getElementById("submit-button");e&&e.addEventListener("click",U);var t=document.getElementById("test-connection-button");t&&t.addEventListener("click",q);var n=document.getElementById("back-to-login-button");n&&n.addEventListener("click",z);var r=document.getElementById("api-key-input");r&&(r.addEventListener("keydown",function(e){"Enter"===e.key&&U()}),r.addEventListener("input",function(){W(),K()})),K()}function K(){var e,t=document.getElementById("api-key-input"),n=document.getElementById("submit-button"),r=document.getElementById("test-connection-button"),o=(null==t||null===(e=t.value)||void 0===e?void 0:e.trim().length)>0;n&&(o?n.removeAttribute("disabled"):n.setAttribute("disabled","true")),r&&(o?r.removeAttribute("disabled"):r.setAttribute("disabled","true"))}function L(){var e=document.getElementById("auth-view"),t=document.getElementById("agents-view");e&&t&&(e.style.display="block",e.classList.add("fade-in"),t.style.display="none")}function M(){P.checkForStoredApiKey()?(l("API Key detected from previous sessions"),setTimeout(function(){return V()},500)):L()}function U(){try{var e,t=document.getElementById("api-key-input"),n=null==t||null===(e=t.value)||void 0===e?void 0:e.trim();if(!n)return void J("Please enter an API Key.");P.setApiKey(n),W(),D("API Key saved successfully!"),setTimeout(function(){return V()},800)}catch(e){J("An error occurred while saving the API key. Please try again."),f("Error saving API key:",e)}}function q(){return H.apply(this,arguments)}function H(){return(H=F(_().m(function e(){var t,n,r,o,i;return _().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,n=document.getElementById("api-key-input"),r=null==n||null===(t=n.value)||void 0===t?void 0:t.trim(),n&&"none"!==n.style.display&&r){e.n=1;break}return J("Please enter an API Key."),e.a(2);case 1:return W(),$(!0),e.n=2,P.testConnection(r);case 2:o=e.v,$(!1),o?D("Connection successful! API Key verified."):J("Invalid API key. Please check and try again."),e.n=4;break;case 3:e.p=3,i=e.v,$(!1),J("An error occurred. Please try again."),f("Authentication error:",i);case 4:return e.a(2)}},e,null,[[0,3]])}))).apply(this,arguments)}function z(){P.clearApiKey(),l("API Key cleared"),setTimeout(function(){return L()},500)}function J(e){var t=document.getElementById("auth-error");t&&(t.textContent=e,t.style.display="block")}function D(e){var t=document.getElementById("auth-error");t&&(t.textContent=e,t.style.color="green",t.style.display="block")}function W(){var e=document.getElementById("auth-error");e&&(e.textContent="",e.style.display="none",e.style.color="#a80000")}function $(e){var t=document.getElementById("submit-button"),n=document.getElementById("test-connection-button"),r=document.getElementById("auth-spinner");r&&(e?(t&&t.setAttribute("disabled","true"),n&&n.setAttribute("disabled","true"),r.style.display="block"):(t&&t.removeAttribute("disabled"),n&&n.removeAttribute("disabled"),r.style.display="none"))}function V(){var e=document.getElementById("auth-view"),t=document.getElementById("agents-view");if(e&&t){e.style.display="none",t.style.display="block",t.classList.add("fade-in");var r=document.getElementById("back-to-auth-button-header");r&&(r.style.display="none"),function(){var e=document.getElementById("agent-categories-container");if(e){e.innerHTML="";for(var t=function(){var e={};return n.forEach(function(t){e[t.category]||(e[t.category]=[]),e[t.category].push(t)}),e}(),r=function(){var t,n,r=(t=i[o],n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],s=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);s=!0);}catch(e){u=!0,o=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(t,n)||function(e,t){if(e){if("string"==typeof e)return G(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?G(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=r[0],c=r[1],s=document.createElement("div");s.className="agent-category";var u=document.createElement("h3");u.className="category-title",u.textContent=a,s.appendChild(u),c.forEach(function(e){var t=function(e){var t=document.createElement("div");t.className="agent-card";var n=document.createElement("h4");n.className="agent-title",n.textContent=e.displayName,t.appendChild(n);var r=document.createElement("p");r.className="agent-description",r.textContent=e.description,t.appendChild(r);var o=document.createElement("div");o.className="agent-meta";var i=document.createElement("div");if(i.innerHTML='<strong>Excel Formula:</strong> <span class="formula-name">'.concat(e.excelFormulaName,'("your prompt")</span>'),o.appendChild(i),e.examplePrompt){var a=document.createElement("div");a.innerHTML="<strong>Example:</strong>";var c=document.createElement("div");c.style.position="relative",c.style.display="inline-block",c.style.width="100%";var s=document.createElement("span");s.className="example-prompt",s.textContent=e.examplePrompt,c.appendChild(s);var u=document.createElement("button");u.className="copy-button",u.title="Copy example",u.innerHTML='<i class="ms-Icon ms-Icon--Copy"></i>',u.onclick=function(t){t.stopPropagation(),navigator.clipboard.writeText(e.examplePrompt).then(function(){u.innerHTML='<i class="ms-Icon ms-Icon--CheckMark copy-success"></i>',setTimeout(function(){u.innerHTML='<i class="ms-Icon ms-Icon--Copy"></i>'},1500)}).catch(function(e){console.error("Could not copy text: ",e)})},c.appendChild(u),a.appendChild(c),o.appendChild(a)}if(t.appendChild(o),e.usageExamples&&e.usageExamples.length>0){var l=document.createElement("div");l.className="usage-examples-section";var p=document.createElement("h5");p.className="usage-heading",p.textContent="Usage Examples:",l.appendChild(p);var f=document.createElement("div");f.className="examples-list",e.usageExamples.forEach(function(e){var t=document.createElement("div");t.className="example-item";var n=document.createElement("div");n.className="example-topic",n.textContent=e.topic,t.appendChild(n);var r=document.createElement("div");r.className="example-prompt-container",r.style.position="relative";var o=document.createElement("div");o.className="example-prompt code",o.textContent=e.prompt,r.appendChild(o);var i=document.createElement("button");i.className="copy-button",i.title="Copy example",i.innerHTML='<i class="ms-Icon ms-Icon--Copy"></i>',i.onclick=function(t){t.stopPropagation(),navigator.clipboard.writeText(e.prompt).then(function(){i.innerHTML='<i class="ms-Icon ms-Icon--CheckMark copy-success"></i>',setTimeout(function(){i.innerHTML='<i class="ms-Icon ms-Icon--Copy"></i>'},1500)}).catch(function(e){console.error("Could not copy text: ",e)})},r.appendChild(i),t.appendChild(r),f.appendChild(t)}),l.appendChild(f),t.appendChild(l)}return t}(e);s.appendChild(t)}),e.appendChild(s)},o=0,i=Object.entries(t);o<i.length;o++)r()}}()}}function Y(e){var t=document.createElement("div");t.className="browser-warning",t.innerHTML='\n    <div class="warning-icon"><i class="ms-Icon ms-Icon--Warning"></i></div>\n    <div class="warning-message">'.concat(e,"</div>\n  ");var n=document.querySelector(".content-container")||document.body;n.insertBefore(t,n.firstChild)}function Q(e){var t=document.querySelector(".api-support-warning");if(t&&(t.style.display="inline-block",console.log("showing api support warning",e),e.length>0)){var n=t.firstElementChild,r=document.createElement("ul");e.forEach(function(e){var t=document.createElement("li");t.textContent=e,r.appendChild(t)}),n.appendChild(r)}}Office.onReady(function(){var e=F(_().m(function e(t){var n;return _().w(function(e){for(;;)switch(e.n){case 0:try{l("Office is ready - initializing Octagon taskpane"),P.initialize(),B(),M(),N()&&Y("Internet Explorer is not fully supported. For the best experience, please use Microsoft Edge, Chrome, or another modern browser."),(n=x()).length>0&&Q(n),l("Taskpane initialized")}catch(e){f("Error during taskpane initialization:",e)}case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}())}(),new URL(n(58394),n.b),new URL(n(35132),n.b)}();
//# sourceMappingURL=taskpane.js.map