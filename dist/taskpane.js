/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={58394:function(e,t,n){e.exports=n.p+"0f242e216c875d7cc5a4.css"},82953:function(e,t,n){e.exports=n.p+"assets/octagon-logo.png"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.m=e,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,function(){var e=function(e){return e.OctagonAgent="octagon-agent",e}({}),t=function(e){return e.MarketIntelligence="Market Intelligence",e}(t||{}),n=[{id:e.OctagonAgent,displayName:"Octagon Agent",excelFormulaName:"OCTAGON.AGENT",description:"Public and Private market intelligence agent that optimally routes requests to appropriate specialized agents",category:t.MarketIntelligence,usageExamples:[{topic:"Financial Metrics Analysis",prompt:'=OCTAGON.AGENT("Retrieve year-over-year growth in key income-statement items for AAPL, limited to 5 records and filtered by period FY.")'},{topic:"SEC Filing Analysis",prompt:'=OCTAGON.AGENT("Analyze the latest 10-K filing for AAPL and extract key financial metrics and risk factors.")'},{topic:"Stock Performance",prompt:'=OCTAGON.AGENT("Retrieve the daily closing prices for AAPL over the last 30 days.")'},{topic:"Earnings Call Insights",prompt:'=OCTAGON.AGENT("Analyze AAPL\'s latest earnings call transcript and extract key insights about future guidance.")'},{topic:"Company Overview",prompt:'=OCTAGON.AGENT("Provide a comprehensive overview of Stripe, including its business model and key metrics.")'},{topic:"Funding History",prompt:'=OCTAGON.AGENT("Retrieve the funding history for Stripe, including all rounds and investors.")'},{topic:"M&A Activity",prompt:'=OCTAGON.AGENT("List all M&A transactions involving Stripe in the last 2 years.")'},{topic:"Investor Profile",prompt:'=OCTAGON.AGENT("Provide a detailed profile of Sequoia Capital\'s investment strategy and portfolio.")'},{topic:"Debt Analysis",prompt:'=OCTAGON.AGENT("Analyze Stripe\'s debt financing history and current debt structure.")'},{topic:"Institutional Holdings",prompt:'=OCTAGON.AGENT("Retrieve the most recent Form 13F and related filings submitted by institutional investors.")'}]}];function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t,n){return(t=function(e){var t=function(e){if("object"!=r(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i=function(e){return e.DEBUG="DEBUG",e.INFO="INFO",e.WARN="WARN",e.ERROR="ERROR",e}({}),a=i.ERROR,c=o(o(o(o({},i.DEBUG,0),i.INFO,1),i.WARN,2),i.ERROR,3);function s(e,t,n){if(c[e]>=c[a]){var r=(new Date).toISOString(),o="[".concat(r,"] [").concat(e,"] ").concat(t);switch(e){case i.DEBUG:console.debug(o,n||"");break;case i.INFO:console.info(o,n||"");break;case i.WARN:console.warn(o,n||"");break;case i.ERROR:console.error(o,n||"")}}}var u=function(e,t){return s(i.DEBUG,e,t)},l=function(e,t){return s(i.INFO,e,t)},p=function(e,t){return s(i.WARN,e,t)},f=function(e,t){return s(i.ERROR,e,t)},d={raw:{format:{type:"text"}},table:{format:{type:"json_schema",strict:!0,name:"TableFormat",schema:{properties:{data:{description:"Nested list of values for multiple spreadsheet cells. Outer list represents rows, inner list represents columns. Each element in the inner list is a cell value.",items:{items:{anyOf:[{type:"number"},{type:"string"}]},type:"array"},type:"array"}},required:["data"],title:"ExcelFormat",type:"object",additionalProperties:!1}}},cell:{format:{type:"json_schema",strict:!0,name:"SingleCellFormat",schema:{properties:{data:{anyOf:[{type:"number"},{type:"string"}],description:"Single value of a spreadsheet cell",title:"Data"}},required:["data"],title:"ExcelCell",type:"object",additionalProperties:!1}}}};function m(e){var t=d[e];if(!t)throw f("Invalid format: ".concat(e)),new CustomFunctions.Error(CustomFunctions.ErrorCode.invalidValue,'Invalid format. Please use "raw", "table", or "cell"');return t}function y(e,t){var n=[["No response content"]];try{var r;if("table"==t)return null!==(r=JSON.parse(e).data)&&void 0!==r?r:n;if("cell"==t){var o=JSON.parse(e).data;return void 0!==o?[[o]]:n}return[[e]]}catch(r){return f("Error parsing text format:",{error:r,content:e,format:t}),n}}function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function h(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return g(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function b(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof c?r:c,u=Object.create(s.prototype);return E(u,"_invoke",function(n,r,o){var i,c,s,u=0,l=o||[],p=!1,f={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return i=t,c=0,s=e,f.n=n,a}};function d(n,r){for(c=n,s=r,t=0;!p&&u&&!o&&t<l.length;t++){var o,i=l[t],d=f.p,m=i[2];n>3?(o=m===r)&&(s=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,f.v=r,f.n=i[1]):d<m&&(o=n<3||i[0]>r||r>m)&&(i[4]=n,i[5]=r,f.n=m,c=0))}if(o||n>1)return a;throw p=!0,r}return function(o,l,m){if(u>1)throw TypeError("Generator is already running");for(p&&1===l&&d(l,m),c=l,s=m;(t=c<2?e:s)||!p;){i||(c?c<3?(c>1&&(f.n=-1),d(c,s)):f.n=s:f.v=s);try{if(u=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(p=f.n<0)?s:n.call(r,f))!==a)break}catch(t){i=e,c=1,s=t}finally{u=1}}return{value:t,done:p}}}(n,o,i),!0),u}var a={};function c(){}function s(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(E(t={},r,function(){return this}),t),p=u.prototype=c.prototype=Object.create(l);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,E(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return s.prototype=u,E(p,"constructor",u),E(u,"constructor",s),s.displayName="GeneratorFunction",E(u,o,"GeneratorFunction"),E(p),E(p,o,"Generator"),E(p,r,function(){return this}),E(p,"toString",function(){return"[object Generator]"}),(b=function(){return{w:i,m:f}})()}function E(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}E=function(e,t,n,r){function i(t,n){E(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},E(e,t,n,r)}function w(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function A(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){w(i,r,o,a,c,"next",e)}function c(e){w(i,r,o,a,c,"throw",e)}a(void 0)})}}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,O(r.key),r)}}function O(e){var t=function(e){if("object"!=v(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=v(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==v(t)?t:t+""}var I="octagon_api_key",x=function(){return t=function e(){var t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"https://api-gateway.octagonagents.com";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=this,(n=O(n="apiKey"))in t?Object.defineProperty(t,n,{value:null,enumerable:!0,configurable:!0,writable:!0}):t[n]=null,this.apiUrl=r},n=[{key:"setApiKey",value:(E=A(b().m(function e(t){var n,r;return b().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=t.trim()||null,this.apiKey=n,n){e.n=2;break}return p("Attempted to set an empty API key; clearing stored key instead"),e.n=1,this.clearApiKey();case 1:return e.a(2);case 2:return e.p=2,e.n=3,OfficeRuntime.storage.setItem(I,n);case 3:u("API key saved to OfficeRuntime.storage"),e.n=5;break;case 4:e.p=4,r=e.v,f("Failed to save API key to OfficeRuntime.storage",r);case 5:return e.a(2)}},e,this,[[2,4]])})),function(e){return E.apply(this,arguments)})},{key:"callAgent",value:(g=A(b().m(function e(t,n,r){var o;return b().w(function(e){for(;;)switch(e.n){case 0:if(u("callAgent invoked with model: ".concat(t,", prompt: ").concat(n.substring(0,50),"...")),n&&""!==n.trim()){e.n=1;break}throw new Error("Please provide a valid prompt");case 1:return e.n=2,this.isAuthenticated();case 2:if(e.v){e.n=3;break}throw f("API request failed: Not authenticated"),new Error("Not authenticated. Please set your API key first.");case 3:return e.n=4,this.createResponse({model:t,input:n,text:m(r)});case 4:return o=e.v,e.a(2,y(o.content||"No response content",r))}},e,this)})),function(e,t,n){return g.apply(this,arguments)})},{key:"loadApiKey",value:(v=A(b().m(function e(){var t;return b().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.getStoredApiKey();case 1:if(!(t=e.v)){e.n=2;break}return this.apiKey=t,e.a(2);case 2:this.apiKey=null;case 3:return e.a(2)}},e,this)})),function(){return v.apply(this,arguments)})},{key:"isAuthenticated",value:(d=A(b().m(function e(){return b().w(function(e){for(;;)switch(e.n){case 0:return l("isAuthenticated invoked - synchronizing API key from storage"),e.n=1,this.loadApiKey();case 1:return e.a(2,!!this.apiKey)}},e,this)})),function(){return d.apply(this,arguments)})},{key:"clearApiKey",value:(s=A(b().m(function e(){var t;return b().w(function(e){for(;;)switch(e.p=e.n){case 0:return this.apiKey=null,e.p=1,e.n=2,OfficeRuntime.storage.removeItem(I);case 2:l("API key cleared from OfficeRuntime.storage"),e.n=4;break;case 3:e.p=3,t=e.v,f("Failed to clear API key from OfficeRuntime.storage",t);case 4:return e.a(2)}},e,this,[[1,3]])})),function(){return s.apply(this,arguments)})},{key:"getStoredApiKey",value:(c=A(b().m(function e(){var t,n;return b().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,OfficeRuntime.storage.getItem(I);case 1:if("string"!=typeof(t=e.v)){e.n=2;break}return e.a(2,t);case 2:e.n=4;break;case 3:e.p=3,n=e.v,f("Failed to read API key from OfficeRuntime.storage",n);case 4:return e.a(2,null)}},e,null,[[0,3]])})),function(){return c.apply(this,arguments)})},{key:"createResponse",value:(a=A(b().m(function e(t,n){var r,o,i,a;return b().w(function(e){for(;;)switch(e.n){case 0:if(r=new URL("/v1/responses",this.apiUrl),o=null!=n?n:this.apiKey){e.n=1;break}throw new Error("No API key provided");case 1:return i=new Headers({"Content-Type":"application/json",Authorization:"Bearer ".concat(o)}),e.n=2,fetch(r,{method:"POST",headers:i,body:JSON.stringify(t)});case 2:if((a=e.v).ok){e.n=3;break}return e.n=3,this.handleApiError(a);case 3:return e.n=4,this.parseAgentResponse(a);case 4:return e.a(2,e.v)}},e,this)})),function(e,t){return a.apply(this,arguments)})},{key:"parseAgentResponse",value:(i=A(b().m(function e(t){var n,r,o,i,a,c,s,u,l,d,m;return b().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,t.json();case 1:if((n=e.v).output&&Array.isArray(n.output)){e.n=2;break}return p("Unexpected response format: missing output array",n),e.a(2,{content:"",id:null==n?void 0:n.id,model:null==n?void 0:n.model});case 2:r="",o=h(n.output),e.p=3,o.s();case 4:if((i=o.n()).done){e.n=15;break}if("message"===(a=i.value).type){e.n=5;break}return e.a(3,14);case 5:if(a.content&&Array.isArray(a.content)){e.n=6;break}return e.a(3,14);case 6:c=h(a.content),e.p=7,c.s();case 8:if((s=c.n()).done){e.n=11;break}if("output_text"===(u=s.value).type){e.n=9;break}return e.a(3,10);case 9:r+=u.text;case 10:e.n=8;break;case 11:e.n=13;break;case 12:e.p=12,l=e.v,c.e(l);case 13:return e.p=13,c.f(),e.f(13);case 14:e.n=4;break;case 15:e.n=17;break;case 16:e.p=16,d=e.v,o.e(d);case 17:return e.p=17,o.f(),e.f(17);case 18:return e.a(2,{content:r,id:n.id,model:n.model});case 19:throw e.p=19,m=e.v,f("Error processing agent response:",m),new Error("Failed to process agent response");case 20:return e.a(2)}},e,null,[[7,12,13,14],[3,16,17,18],[0,19]])})),function(e){return i.apply(this,arguments)})},{key:"testConnection",value:(o=A(b().m(function t(n){var r,o;return b().w(function(t){for(;;)switch(t.p=t.n){case 0:return r={model:e.OctagonAgent,input:"Test connection",max_tokens:10},t.p=1,t.n=2,this.createResponse(r,n);case 2:return t.a(2,!0);case 3:return t.p=3,o=t.v,f("Test connection threw an exception",o),t.a(2,!1)}},t,this,[[1,3]])})),function(e){return o.apply(this,arguments)})},{key:"handleApiError",value:(r=A(b().m(function e(t){var n,r,o,i,a;return b().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,t.json();case 1:o=e.v,e.n=3;break;case 2:e.p=2,e.v,o={detail:"Unknown error"};case 3:throw i=t.status,a=null!==(n=null===(r=o)||void 0===r?void 0:r.detail)&&void 0!==n?n:"Unknown error",f("Agent request failed",{status:i,message:a}),new Error("HTTP ".concat(i,": ").concat(a));case 4:return e.a(2)}},e,null,[[0,2]])})),function(e){return r.apply(this,arguments)})}],n&&k(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,r,o,i,a,c,s,d,v,g,E}();function C(){try{var e=window.navigator.userAgent,t=e.indexOf("MSIE "),n=e.indexOf("Trident/");return t>0||n>0}catch(e){return f("Error detecting browser:",e),!1}}function P(){var e=[];try{Office.context.requirements.isSetSupported("SharedRuntime","1.1")||e.push("This add-in requires SharedRuntime support. Please update to a newer version of Office."),Office.context.requirements.isSetSupported("ExcelApi","1.7")||e.push("Some Excel features require Excel API 1.7 or later. Please update to a newer version of Excel."),Office.context.requirements.isSetSupported("CustomFunctions","1.1")||e.push("Custom functions require Excel support for CustomFunctions 1.1 or later."),function(e){try{var t=Office.context.platform,n=Office.context.host;l("Running on platform: ".concat(t,", host: ").concat(n)),t===Office.PlatformType.PC||t===Office.PlatformType.Mac||t===Office.PlatformType.OfficeOnline&&e.push("Excel Online may have limitations with long-running functions. Consider using Excel desktop for complex operations."),n!==Office.HostType.Excel&&e.push("This add-in is designed for Excel and may not function correctly in other Office applications.")}catch(e){f("Error detecting platform:",e)}}(e)}catch(t){f("Error checking API support:",t),e.push("Error checking API compatibility. Some features may not work as expected.")}return e}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function S(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var s=r&&r.prototype instanceof c?r:c,u=Object.create(s.prototype);return N(u,"_invoke",function(n,r,o){var i,c,s,u=0,l=o||[],p=!1,f={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return i=t,c=0,s=e,f.n=n,a}};function d(n,r){for(c=n,s=r,t=0;!p&&u&&!o&&t<l.length;t++){var o,i=l[t],d=f.p,m=i[2];n>3?(o=m===r)&&(s=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,f.v=r,f.n=i[1]):d<m&&(o=n<3||i[0]>r||r>m)&&(i[4]=n,i[5]=r,f.n=m,c=0))}if(o||n>1)return a;throw p=!0,r}return function(o,l,m){if(u>1)throw TypeError("Generator is already running");for(p&&1===l&&d(l,m),c=l,s=m;(t=c<2?e:s)||!p;){i||(c?c<3?(c>1&&(f.n=-1),d(c,s)):f.n=s:f.v=s);try{if(u=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(p=f.n<0)?s:n.call(r,f))!==a)break}catch(t){i=e,c=1,s=t}finally{u=1}}return{value:t,done:p}}}(n,o,i),!0),u}var a={};function c(){}function s(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(N(t={},r,function(){return this}),t),p=u.prototype=c.prototype=Object.create(l);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,N(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return s.prototype=u,N(p,"constructor",u),N(u,"constructor",s),s.displayName="GeneratorFunction",N(u,o,"GeneratorFunction"),N(p),N(p,o,"Generator"),N(p,r,function(){return this}),N(p,"toString",function(){return"[object Generator]"}),(S=function(){return{w:i,m:f}})()}function N(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}N=function(e,t,n,r){function i(t,n){N(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},N(e,t,n,r)}function R(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function j(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){R(i,r,o,a,c,"next",e)}function c(e){R(i,r,o,a,c,"throw",e)}a(void 0)})}}var G=new x;function F(){var e=document.getElementById("submit-button");e&&e.addEventListener("click",U);var t=document.getElementById("test-connection-button");t&&t.addEventListener("click",H);var n=document.getElementById("back-to-login-button");n&&n.addEventListener("click",z);var r=document.getElementById("api-key-input");r&&(r.addEventListener("keydown",function(e){"Enter"===e.key&&U()}),r.addEventListener("input",function(){J(),B()})),B()}function B(){var e,t=document.getElementById("api-key-input"),n=document.getElementById("submit-button"),r=document.getElementById("test-connection-button"),o=(null==t||null===(e=t.value)||void 0===e?void 0:e.trim().length)>0;n&&(o?n.removeAttribute("disabled"):n.setAttribute("disabled","true")),r&&(o?r.removeAttribute("disabled"):r.setAttribute("disabled","true"))}function L(){var e=document.getElementById("auth-view"),t=document.getElementById("agents-view");e&&t&&(e.style.display="block",e.classList.add("fade-in"),t.style.display="none")}function M(){return K.apply(this,arguments)}function K(){return(K=j(S().m(function e(){return S().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,G.isAuthenticated();case 1:e.v?(l("Authentication successful"),setTimeout(function(){return Y()},500)):L();case 2:return e.a(2)}},e)}))).apply(this,arguments)}function U(){return _.apply(this,arguments)}function _(){return(_=j(S().m(function e(){var t,n,r,o;return S().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,n=document.getElementById("api-key-input"),r=null==n||null===(t=n.value)||void 0===t?void 0:t.trim()){e.n=1;break}return W("Please enter an API Key."),e.a(2);case 1:return e.n=2,G.setApiKey(r);case 2:J(),$("API Key saved successfully!"),setTimeout(function(){n.value="",B(),Y()},800),e.n=4;break;case 3:e.p=3,o=e.v,W("An error occurred while saving the API key. Please try again."),f("Error saving API key:",o);case 4:return e.a(2)}},e,null,[[0,3]])}))).apply(this,arguments)}function H(){return q.apply(this,arguments)}function q(){return(q=j(S().m(function e(){var t,n,r,o,i;return S().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,n=document.getElementById("api-key-input"),r=null==n||null===(t=n.value)||void 0===t?void 0:t.trim(),n&&"none"!==n.style.display&&r){e.n=1;break}return W("Please enter an API Key."),e.a(2);case 1:return J(),V(!0),e.n=2,G.testConnection(r);case 2:o=e.v,V(!1),o?$("Connection successful! API Key verified."):W("Invalid API key. Please check and try again."),e.n=4;break;case 3:e.p=3,i=e.v,V(!1),W("An error occurred. Please try again."),f("Authentication error:",i);case 4:return e.a(2)}},e,null,[[0,3]])}))).apply(this,arguments)}function z(){return D.apply(this,arguments)}function D(){return(D=j(S().m(function e(){return S().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,G.clearApiKey();case 1:l("API Key cleared"),setTimeout(function(){return L()},500);case 2:return e.a(2)}},e)}))).apply(this,arguments)}function W(e){var t=document.getElementById("auth-error");t&&(t.textContent=e,t.style.display="block")}function $(e){var t=document.getElementById("auth-error");t&&(t.textContent=e,t.style.color="green",t.style.display="block")}function J(){var e=document.getElementById("auth-error");e&&(e.textContent="",e.style.display="none",e.style.color="#a80000")}function V(e){var t=document.getElementById("submit-button"),n=document.getElementById("test-connection-button"),r=document.getElementById("auth-spinner");r&&(e?(t&&t.setAttribute("disabled","true"),n&&n.setAttribute("disabled","true"),r.style.display="block"):(t&&t.removeAttribute("disabled"),n&&n.removeAttribute("disabled"),r.style.display="none"))}function Y(){var e=document.getElementById("auth-view"),t=document.getElementById("agents-view");if(e&&t){e.style.display="none",t.style.display="block",t.classList.add("fade-in");var r=document.getElementById("back-to-auth-button-header");r&&(r.style.display="none"),function(){var e=document.getElementById("agent-categories-container");if(e){e.innerHTML="";for(var t=function(){var e={};return n.forEach(function(t){e[t.category]||(e[t.category]=[]),e[t.category].push(t)}),e}(),r=function(){var t,n,r=(t=i[o],n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],s=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);s=!0);}catch(e){u=!0,o=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(t,n)||function(e,t){if(e){if("string"==typeof e)return T(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?T(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=r[0],c=r[1],s=document.createElement("div");s.className="agent-category";var u=document.createElement("h3");u.className="category-title",u.textContent=a,s.appendChild(u),c.forEach(function(e){var t=function(e){var t=document.createElement("div");t.className="agent-card";var n=document.createElement("h4");n.className="agent-title",n.textContent=e.displayName,t.appendChild(n);var r=document.createElement("p");r.className="agent-description",r.textContent=e.description,t.appendChild(r);var o=document.createElement("div");o.className="agent-meta";var i=document.createElement("div");if(i.innerHTML='<strong>Excel Formula:</strong> <span class="formula-name">'.concat(e.excelFormulaName,'("your prompt")</span>'),o.appendChild(i),e.examplePrompt){var a=document.createElement("div");a.innerHTML="<strong>Example:</strong>";var c=document.createElement("div");c.style.position="relative",c.style.display="inline-block",c.style.width="100%";var s=document.createElement("span");s.className="example-prompt",s.textContent=e.examplePrompt,c.appendChild(s);var u=document.createElement("button");u.className="copy-button",u.title="Copy example",u.innerHTML='<i class="ms-Icon ms-Icon--Copy"></i>',u.onclick=function(t){t.stopPropagation(),navigator.clipboard.writeText(e.examplePrompt).then(function(){u.innerHTML='<i class="ms-Icon ms-Icon--CheckMark copy-success"></i>',setTimeout(function(){u.innerHTML='<i class="ms-Icon ms-Icon--Copy"></i>'},1500)}).catch(function(e){f("Could not copy text: ",e)})},c.appendChild(u),a.appendChild(c),o.appendChild(a)}if(t.appendChild(o),e.usageExamples&&e.usageExamples.length>0){var l=document.createElement("div");l.className="usage-examples-section";var p=document.createElement("h5");p.className="usage-heading",p.textContent="Usage Examples:",l.appendChild(p);var d=document.createElement("div");d.className="examples-list",e.usageExamples.forEach(function(e){var t=document.createElement("div");t.className="example-item";var n=document.createElement("div");n.className="example-topic",n.textContent=e.topic,t.appendChild(n);var r=document.createElement("div");r.className="example-prompt-container",r.style.position="relative";var o=document.createElement("div");o.className="example-prompt code",o.textContent=e.prompt,r.appendChild(o);var i=document.createElement("button");i.className="copy-button",i.title="Copy example",i.innerHTML='<i class="ms-Icon ms-Icon--Copy"></i>',i.onclick=function(t){t.stopPropagation(),navigator.clipboard.writeText(e.prompt).then(function(){i.innerHTML='<i class="ms-Icon ms-Icon--CheckMark copy-success"></i>',setTimeout(function(){i.innerHTML='<i class="ms-Icon ms-Icon--Copy"></i>'},1500)}).catch(function(e){f("Could not copy text: ",e)})},r.appendChild(i),t.appendChild(r),d.appendChild(t)}),l.appendChild(d),t.appendChild(l)}return t}(e);s.appendChild(t)}),e.appendChild(s)},o=0,i=Object.entries(t);o<i.length;o++)r()}}()}}function Q(e){var t=document.createElement("div");t.className="browser-warning",t.innerHTML='\n    <div class="warning-icon"><i class="ms-Icon ms-Icon--Warning"></i></div>\n    <div class="warning-message">'.concat(e,"</div>\n  ");var n=document.querySelector(".content-container")||document.body;n.insertBefore(t,n.firstChild)}function X(e){var t=document.querySelector(".api-support-warning");if(t&&(t.style.display="inline-block",e.length>0)){var n=t.firstElementChild,r=document.createElement("ul");e.forEach(function(e){var t=document.createElement("li");t.textContent=e,r.appendChild(t)}),n.appendChild(r)}}Office.onReady(j(S().m(function e(){var t,n;return S().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,l("Office is ready - initializing Octagon taskpane"),F(),e.n=1,M();case 1:C()&&Q("Internet Explorer is not fully supported. For the best experience, please use Microsoft Edge, Chrome, or another modern browser."),(t=P()).length>0&&X(t),l("Taskpane initialized"),e.n=3;break;case 2:e.p=2,n=e.v,f("Error during taskpane initialization:",n);case 3:return e.a(2)}},e,null,[[0,2]])})))}(),new URL(n(58394),n.b),new URL(n(82953),n.b)}();
//# sourceMappingURL=taskpane.js.map