/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={58394:function(e,t,n){e.exports=n.p+"fd9c19fa10b836b43575.css"},82953:function(e,t,n){e.exports=n.p+"assets/octagon-logo.png"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.m=e,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(t,n,r){return(n=function(t){var n=function(t){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}var n=function(e){return e.DEBUG="DEBUG",e.INFO="INFO",e.WARN="WARN",e.ERROR="ERROR",e}({}),r=n.ERROR,o=t(t(t(t({},n.DEBUG,0),n.INFO,1),n.WARN,2),n.ERROR,3);function i(e,t,i){if(o[e]>=o[r]){var a=(new Date).toISOString(),c="[".concat(a,"] [").concat(e,"] ").concat(t);switch(e){case n.DEBUG:console.debug(c,i||"");break;case n.INFO:console.info(c,i||"");break;case n.WARN:console.warn(c,i||"");break;case n.ERROR:console.error(c,i||"")}}}var a=function(e,t){return i(n.DEBUG,e,t)},c=function(e,t){return i(n.INFO,e,t)},u=function(e,t){return i(n.WARN,e,t)},s=function(e,t){return i(n.ERROR,e,t)},l={raw:{format:{type:"text"}},table:{format:{type:"json_schema",strict:!0,name:"TableFormat",schema:{properties:{data:{description:"Nested list of values for multiple spreadsheet cells. Outer list represents rows, inner list represents columns. Each element in the inner list is a cell value.",items:{items:{anyOf:[{type:"number"},{type:"string"}]},type:"array"},type:"array"}},required:["data"],title:"ExcelFormat",type:"object",additionalProperties:!1}}},cell:{format:{type:"json_schema",strict:!0,name:"SingleCellFormat",schema:{properties:{data:{anyOf:[{type:"number"},{type:"string"}],description:"Single value of a spreadsheet cell",title:"Data"}},required:["data"],title:"ExcelCell",type:"object",additionalProperties:!1}}}};function p(e){var t=l[e];if(!t)throw s("Invalid format: ".concat(e)),new CustomFunctions.Error(CustomFunctions.ErrorCode.invalidValue,'Invalid format. Please use "raw", "table", or "cell"');return t}function f(e,t){var n=[["No response content"]];try{var r;if("table"==t)return null!==(r=JSON.parse(e).data)&&void 0!==r?r:n;if("cell"==t){var o=JSON.parse(e).data;return void 0!==o?[[o]]:n}return[[e]]}catch(r){return s("Error parsing text format:",{error:r,content:e,format:t}),n}}var d=function(e){return e.OctagonAgent="octagon-agent",e}({});function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function m(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return v(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function h(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return b(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],p=!1,f={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return i=t,c=0,u=e,f.n=n,a}};function d(n,r){for(c=n,u=r,t=0;!p&&s&&!o&&t<l.length;t++){var o,i=l[t],d=f.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,f.v=r,f.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,f.n=y,c=0))}if(o||n>1)return a;throw p=!0,r}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(p&&1===l&&d(l,y),c=l,u=y;(t=c<2?e:u)||!p;){i||(c?c<3?(c>1&&(f.n=-1),d(c,u)):f.n=u:f.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(p=f.n<0)?u:n.call(r,f))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:p}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(b(t={},r,function(){return this}),t),p=s.prototype=c.prototype=Object.create(l);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,b(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return u.prototype=s,b(p,"constructor",s),b(s,"constructor",u),u.displayName="GeneratorFunction",b(s,o,"GeneratorFunction"),b(p),b(p,o,"Generator"),b(p,r,function(){return this}),b(p,"toString",function(){return"[object Generator]"}),(h=function(){return{w:i,m:f}})()}function b(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}b=function(e,t,n,r){function i(t,n){b(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},b(e,t,n,r)}function g(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function w(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){g(i,r,o,a,c,"next",e)}function c(e){g(i,r,o,a,c,"throw",e)}a(void 0)})}}function A(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,E(r.key),r)}}function E(e){var t=function(e){if("object"!=y(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==y(t)?t:t+""}var k="octagon_api_key",O=function(){return e=function e(){var t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"https://api-gateway.octagonagents.com";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=this,(n=E(n="apiKey"))in t?Object.defineProperty(t,n,{value:null,enumerable:!0,configurable:!0,writable:!0}):t[n]=null,this.apiUrl=r},t=[{key:"setApiKey",value:(O=w(h().m(function e(t){var n,r;return h().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=t.trim()||null,this.apiKey=n,n){e.n=2;break}return u("Attempted to set an empty API key; clearing stored key instead"),e.n=1,this.clearApiKey();case 1:return e.a(2);case 2:return e.p=2,e.n=3,OfficeRuntime.storage.setItem(k,n);case 3:a("API key saved to OfficeRuntime.storage"),e.n=5;break;case 4:e.p=4,r=e.v,s("Failed to save API key to OfficeRuntime.storage",r);case 5:return e.a(2)}},e,this,[[2,4]])})),function(e){return O.apply(this,arguments)})},{key:"callAgent",value:(g=w(h().m(function e(t,n,r){var o;return h().w(function(e){for(;;)switch(e.n){case 0:if(a("callAgent invoked with model: ".concat(t,", prompt: ").concat(n.substring(0,50),"...")),n&&""!==n.trim()){e.n=1;break}throw new Error("Please provide a valid prompt");case 1:return e.n=2,this.isAuthenticated();case 2:if(e.v){e.n=3;break}throw s("API request failed: Not authenticated"),new Error("Not authenticated. Please set your API key first.");case 3:return e.n=4,this.createResponse({model:t,input:n,text:p(r)});case 4:return o=e.v,e.a(2,f(o.content||"No response content",r))}},e,this)})),function(e,t,n){return g.apply(this,arguments)})},{key:"loadApiKey",value:(b=w(h().m(function e(){var t;return h().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.getStoredApiKey();case 1:if(!(t=e.v)){e.n=2;break}return this.apiKey=t,e.a(2);case 2:this.apiKey=null;case 3:return e.a(2)}},e,this)})),function(){return b.apply(this,arguments)})},{key:"isAuthenticated",value:(v=w(h().m(function e(){return h().w(function(e){for(;;)switch(e.n){case 0:return c("isAuthenticated invoked - synchronizing API key from storage"),e.n=1,this.loadApiKey();case 1:return e.a(2,!!this.apiKey)}},e,this)})),function(){return v.apply(this,arguments)})},{key:"clearApiKey",value:(y=w(h().m(function e(){var t;return h().w(function(e){for(;;)switch(e.p=e.n){case 0:return this.apiKey=null,e.p=1,e.n=2,OfficeRuntime.storage.removeItem(k);case 2:c("API key cleared from OfficeRuntime.storage"),e.n=4;break;case 3:e.p=3,t=e.v,s("Failed to clear API key from OfficeRuntime.storage",t);case 4:return e.a(2)}},e,this,[[1,3]])})),function(){return y.apply(this,arguments)})},{key:"getStoredApiKey",value:(l=w(h().m(function e(){var t,n;return h().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,OfficeRuntime.storage.getItem(k);case 1:if("string"!=typeof(t=e.v)){e.n=2;break}return e.a(2,t);case 2:e.n=4;break;case 3:e.p=3,n=e.v,s("Failed to read API key from OfficeRuntime.storage",n);case 4:return e.a(2,null)}},e,null,[[0,3]])})),function(){return l.apply(this,arguments)})},{key:"createResponse",value:(i=w(h().m(function e(t,n){var r,o,i,a;return h().w(function(e){for(;;)switch(e.n){case 0:if(r=new URL("/v1/responses",this.apiUrl),o=null!=n?n:this.apiKey){e.n=1;break}throw new Error("No API key provided");case 1:return i=new Headers({"Content-Type":"application/json",Authorization:"Bearer ".concat(o)}),e.n=2,fetch(r,{method:"POST",headers:i,body:JSON.stringify(t)});case 2:if((a=e.v).ok){e.n=3;break}return e.n=3,this.handleApiError(a);case 3:return e.n=4,this.parseAgentResponse(a);case 4:return e.a(2,e.v)}},e,this)})),function(e,t){return i.apply(this,arguments)})},{key:"parseAgentResponse",value:(o=w(h().m(function e(t){var n,r,o,i,a,c,l,p,f,d,y;return h().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,t.json();case 1:if((n=e.v).output&&Array.isArray(n.output)){e.n=2;break}return u("Unexpected response format: missing output array",n),e.a(2,{content:"",id:null==n?void 0:n.id,model:null==n?void 0:n.model});case 2:r="",o=m(n.output),e.p=3,o.s();case 4:if((i=o.n()).done){e.n=15;break}if("message"===(a=i.value).type){e.n=5;break}return e.a(3,14);case 5:if(a.content&&Array.isArray(a.content)){e.n=6;break}return e.a(3,14);case 6:c=m(a.content),e.p=7,c.s();case 8:if((l=c.n()).done){e.n=11;break}if("output_text"===(p=l.value).type){e.n=9;break}return e.a(3,10);case 9:r+=p.text;case 10:e.n=8;break;case 11:e.n=13;break;case 12:e.p=12,f=e.v,c.e(f);case 13:return e.p=13,c.f(),e.f(13);case 14:e.n=4;break;case 15:e.n=17;break;case 16:e.p=16,d=e.v,o.e(d);case 17:return e.p=17,o.f(),e.f(17);case 18:return e.a(2,{content:r,id:n.id,model:n.model});case 19:throw e.p=19,y=e.v,s("Error processing agent response:",y),new Error("Failed to process agent response");case 20:return e.a(2)}},e,null,[[7,12,13,14],[3,16,17,18],[0,19]])})),function(e){return o.apply(this,arguments)})},{key:"testConnection",value:(r=w(h().m(function e(t){var n,r;return h().w(function(e){for(;;)switch(e.p=e.n){case 0:return n={model:d.OctagonAgent,input:"Test connection",max_tokens:10},e.p=1,e.n=2,this.createResponse(n,t);case 2:return e.a(2,!0);case 3:return e.p=3,r=e.v,s("Test connection threw an exception",r),e.a(2,!1)}},e,this,[[1,3]])})),function(e){return r.apply(this,arguments)})},{key:"handleApiError",value:(n=w(h().m(function e(t){var n,r,o,i,a;return h().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,t.json();case 1:o=e.v,e.n=3;break;case 2:e.p=2,e.v,o={detail:"Unknown error"};case 3:throw i=t.status,a=null!==(n=null===(r=o)||void 0===r?void 0:r.detail)&&void 0!==n?n:"Unknown error",s("Agent request failed",{status:i,message:a}),new Error("HTTP ".concat(i,": ").concat(a));case 4:return e.a(2)}},e,null,[[0,2]])})),function(e){return n.apply(this,arguments)})}],t&&A(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,o,i,l,y,v,b,g,O}();function I(){try{var e=window.navigator.userAgent,t=e.indexOf("MSIE "),n=e.indexOf("Trident/");return t>0||n>0}catch(e){return s("Error detecting browser:",e),!1}}function P(){var e=[];try{Office.context.requirements.isSetSupported("SharedRuntime","1.1")||e.push("This add-in requires SharedRuntime support. Please update to a newer version of Office."),Office.context.requirements.isSetSupported("ExcelApi","1.7")||e.push("Some Excel features require Excel API 1.7 or later. Please update to a newer version of Excel."),Office.context.requirements.isSetSupported("CustomFunctions","1.1")||e.push("Custom functions require Excel support for CustomFunctions 1.1 or later."),function(e){try{var t=Office.context.platform,n=Office.context.host;c("Running on platform: ".concat(t,", host: ").concat(n)),t===Office.PlatformType.PC||t===Office.PlatformType.Mac||t===Office.PlatformType.OfficeOnline&&e.push("Excel Online may have limitations with long-running functions. Consider using Excel desktop for complex operations."),n!==Office.HostType.Excel&&e.push("This add-in is designed for Excel and may not function correctly in other Office applications.")}catch(e){s("Error detecting platform:",e)}}(e)}catch(t){s("Error checking API support:",t),e.push("Error checking API compatibility. Some features may not work as expected.")}return e}var T=function(e){return e.MarketIntelligence="Market Intelligence",e}(T||{}),S=[{id:d.OctagonAgent,displayName:"Octagon Agent",excelFormulaName:"OCTAGON.AGENT",description:"Public and Private market intelligence agent that optimally routes requests to appropriate specialized agents",category:T.MarketIntelligence,usageExamples:[{topic:"Financial Metrics Analysis",prompt:'=OCTAGON.AGENT("Retrieve year-over-year growth in key income-statement items for AAPL, limited to 5 records and filtered by period FY.")'},{topic:"SEC Filing Analysis",prompt:'=OCTAGON.AGENT("Analyze the latest 10-K filing for AAPL and extract key financial metrics and risk factors.", "raw")'},{topic:"Stock Performance",prompt:'=OCTAGON.AGENT("Retrieve the daily closing prices for AAPL over the last 30 days.")'},{topic:"Earnings Call Insights",prompt:'=OCTAGON.AGENT("In one concise sentence, summarize AAPL\'s latest earnings call with a focus on revenue growth and future guidance.", "cell")'},{topic:"Company Overview",prompt:'=OCTAGON.AGENT("Provide a comprehensive overview of Stripe, including its business model and key metrics.", "raw")'},{topic:"Funding History",prompt:'=OCTAGON.AGENT("Create a table of Stripe\'s funding history with columns Round, Date, AmountUSD, LeadInvestor, OtherInvestors, and PostMoneyValuation.", "table")'},{topic:"M&A Activity",prompt:'=OCTAGON.AGENT("List all M&A transactions involving Stripe in the last 2 years.")'},{topic:"Investor Profile",prompt:'=OCTAGON.AGENT("Provide a detailed profile of Sequoia Capital\'s investment strategy and portfolio.", "raw")'},{topic:"Debt Analysis",prompt:'=OCTAGON.AGENT("Analyze Stripe\'s debt financing history and current debt structure.", "raw")'},{topic:"Institutional Holdings",prompt:'=OCTAGON.AGENT("Retrieve the most recent Form 13F and related filings submitted by institutional investors.", "raw")'}]}].reduce(function(e,t){return e[t.category]||(e[t.category]=[]),e[t.category].push(t),e},{});function x(e,t){e.usageExamples.forEach(function(e){var n=document.createElement("div");n.className="example-item";var r=document.createElement("div");r.className="example-topic",r.textContent=e.topic,n.appendChild(r);var o=document.createElement("div");o.className="example-prompt-container",o.style.position="relative";var i=document.createElement("div");i.className="example-prompt code",i.textContent=e.prompt,o.appendChild(i);var a=document.createElement("button");a.className="copy-button",a.title="Copy example",a.innerHTML='<i class="ms-Icon ms-Icon--Copy"></i>',a.onclick=function(t){t.stopPropagation(),navigator.clipboard.writeText(e.prompt).then(function(){a.innerHTML='<i class="ms-Icon ms-Icon--CheckMark copy-success"></i>',setTimeout(function(){a.innerHTML='<i class="ms-Icon ms-Icon--Copy"></i>'},1500)}).catch(function(e){s("Could not copy text: ",e)})},o.appendChild(a),n.appendChild(o),t.appendChild(n)})}var C=function(){var e=document.createDocumentFragment(),t=document.createElement("div");t.className="examples-list",e.appendChild(t);for(var n=0,r=Object.values(S);n<r.length;n++)r[n].forEach(function(e){x(e,t)});return e}();function N(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return R(s,"_invoke",function(n,r,o){var i,c,u,s=0,l=o||[],p=!1,f={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return i=t,c=0,u=e,f.n=n,a}};function d(n,r){for(c=n,u=r,t=0;!p&&s&&!o&&t<l.length;t++){var o,i=l[t],d=f.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,f.v=r,f.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,f.n=y,c=0))}if(o||n>1)return a;throw p=!0,r}return function(o,l,y){if(s>1)throw TypeError("Generator is already running");for(p&&1===l&&d(l,y),c=l,u=y;(t=c<2?e:u)||!p;){i||(c?c<3?(c>1&&(f.n=-1),d(c,u)):f.n=u:f.v=u);try{if(s=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=e}else if((t=(p=f.n<0)?u:n.call(r,f))!==a)break}catch(t){i=e,c=1,u=t}finally{s=1}}return{value:t,done:p}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(R(t={},r,function(){return this}),t),p=s.prototype=c.prototype=Object.create(l);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,R(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return u.prototype=s,R(p,"constructor",s),R(s,"constructor",u),u.displayName="GeneratorFunction",R(s,o,"GeneratorFunction"),R(p),R(p,o,"Generator"),R(p,r,function(){return this}),R(p,"toString",function(){return"[object Generator]"}),(N=function(){return{w:i,m:f}})()}function R(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}R=function(e,t,n,r){function i(t,n){R(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},R(e,t,n,r)}function j(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function G(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){j(i,r,o,a,c,"next",e)}function c(e){j(i,r,o,a,c,"throw",e)}a(void 0)})}}var F=new O;function B(){var e=document.getElementById("submit-button");e&&e.addEventListener("click",M);var t=document.getElementById("test-connection-button");t&&t.addEventListener("click",D);var n=document.getElementById("back-to-login-button");n&&n.addEventListener("click",H);var r=document.getElementById("api-key-input");r&&(r.addEventListener("keydown",function(e){"Enter"===e.key&&M()}),r.addEventListener("input",function(){V(),K()})),K()}function K(){var e,t=document.getElementById("api-key-input"),n=document.getElementById("submit-button"),r=document.getElementById("test-connection-button"),o=(null==t||null===(e=t.value)||void 0===e?void 0:e.trim().length)>0;n&&(o?n.removeAttribute("disabled"):n.setAttribute("disabled","true")),r&&(o?r.removeAttribute("disabled"):r.setAttribute("disabled","true"))}function L(){var e=document.getElementById("auth-view"),t=document.getElementById("agents-view");e&&t&&(e.style.display="block",e.classList.add("fade-in"),t.style.display="none")}function _(){return U.apply(this,arguments)}function U(){return(U=G(N().m(function e(){return N().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,F.isAuthenticated();case 1:e.v?(c("Authentication successful"),setTimeout(function(){return Q()},500)):L();case 2:return e.a(2)}},e)}))).apply(this,arguments)}function M(){return q.apply(this,arguments)}function q(){return(q=G(N().m(function e(){var t,n,r,o;return N().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,n=document.getElementById("api-key-input"),r=null==n||null===(t=n.value)||void 0===t?void 0:t.trim()){e.n=1;break}return $("Please enter an API Key."),e.a(2);case 1:return e.n=2,F.setApiKey(r);case 2:V(),J("API Key saved successfully!"),setTimeout(function(){n.value="",K(),Q()},800),e.n=4;break;case 3:e.p=3,o=e.v,$("An error occurred while saving the API key. Please try again."),s("Error saving API key:",o);case 4:return e.a(2)}},e,null,[[0,3]])}))).apply(this,arguments)}function D(){return z.apply(this,arguments)}function z(){return(z=G(N().m(function e(){var t,n,r,o,i;return N().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,n=document.getElementById("api-key-input"),r=null==n||null===(t=n.value)||void 0===t?void 0:t.trim(),n&&"none"!==n.style.display&&r){e.n=1;break}return $("Please enter an API Key."),e.a(2);case 1:return V(),Y(!0),e.n=2,F.testConnection(r);case 2:o=e.v,Y(!1),o?J("Connection successful! API Key verified."):$("Invalid API key. Please check and try again."),e.n=4;break;case 3:e.p=3,i=e.v,Y(!1),$("An error occurred. Please try again."),s("Authentication error:",i);case 4:return e.a(2)}},e,null,[[0,3]])}))).apply(this,arguments)}function H(){return W.apply(this,arguments)}function W(){return(W=G(N().m(function e(){return N().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,F.clearApiKey();case 1:c("API Key cleared"),setTimeout(function(){return L()},500);case 2:return e.a(2)}},e)}))).apply(this,arguments)}function $(e){var t=document.getElementById("auth-error");t&&(t.textContent=e,t.style.display="block")}function J(e){var t=document.getElementById("auth-error");t&&(t.textContent=e,t.style.color="green",t.style.display="block")}function V(){var e=document.getElementById("auth-error");e&&(e.textContent="",e.style.display="none",e.style.color="#a80000")}function Y(e){var t=document.getElementById("submit-button"),n=document.getElementById("test-connection-button"),r=document.getElementById("auth-spinner");r&&(e?(t&&t.setAttribute("disabled","true"),n&&n.setAttribute("disabled","true"),r.style.display="block"):(t&&t.removeAttribute("disabled"),n&&n.removeAttribute("disabled"),r.style.display="none"))}function Q(){var e,t=document.getElementById("auth-view"),n=document.getElementById("agents-view");if(t&&n){t.style.display="none",n.style.display="block",n.classList.add("fade-in");var r=document.getElementById("back-to-auth-button-header");r&&(r.style.display="none"),e=document.getElementById("agent-card"),console.info("agentCard",e),e&&e.appendChild(C)}}function X(e){var t=document.createElement("div");t.className="browser-warning",t.innerHTML='\n    <div class="warning-icon"><i class="ms-Icon ms-Icon--Warning"></i></div>\n    <div class="warning-message">'.concat(e,"</div>\n  ");var n=document.querySelector(".content-container")||document.body;n.insertBefore(t,n.firstChild)}function Z(e){var t=document.querySelector(".api-support-warning");if(t&&(t.style.display="inline-block",e.length>0)){var n=t.firstElementChild,r=document.createElement("ul");e.forEach(function(e){var t=document.createElement("li");t.textContent=e,r.appendChild(t)}),n.appendChild(r)}}Office.onReady(G(N().m(function e(){var t,n;return N().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,c("Office is ready - initializing Octagon taskpane"),B(),e.n=1,_();case 1:I()&&X("Internet Explorer is not fully supported. For the best experience, please use Microsoft Edge, Chrome, or another modern browser."),(t=P()).length>0&&Z(t),c("Taskpane initialized"),e.n=3;break;case 2:e.p=2,n=e.v,s("Error during taskpane initialization:",n);case 3:return e.a(2)}},e,null,[[0,2]])})))}(),new URL(n(58394),n.b),new URL(n(82953),n.b)}();
//# sourceMappingURL=taskpane.js.map