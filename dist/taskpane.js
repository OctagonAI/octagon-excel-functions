/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={35132:function(e,t,n){e.exports=n.p+"assets/icon-80.png"},58394:function(e,t,n){e.exports=n.p+"5827f2937e1a6e8be6fe.css"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.m=e,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(t,n,r){return(n=function(t){var n=function(t){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}var n=function(e){return e.DEBUG="DEBUG",e.INFO="INFO",e.WARN="WARN",e.ERROR="ERROR",e}({}),r=n.ERROR,o=t(t(t(t({},n.DEBUG,0),n.INFO,1),n.WARN,2),n.ERROR,3);function a(e,t,a){if(o[e]>=o[r]){var i=(new Date).toISOString(),c="[".concat(i,"] [").concat(e,"] ").concat(t);switch(e){case n.DEBUG:console.debug(c,a||"");break;case n.INFO:console.info(c,a||"");break;case n.WARN:console.warn(c,a||"");break;case n.ERROR:console.error(c,a||"")}}}var i=function(e,t){return a(n.DEBUG,e,t)},c=function(e,t){return a(n.INFO,e,t)},s=function(e,t){return a(n.WARN,e,t)},u=function(e,t){return a(n.ERROR,e,t)};function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function d(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return p(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function m(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var s=r&&r.prototype instanceof c?r:c,u=Object.create(s.prototype);return y(u,"_invoke",function(n,r,o){var a,c,s,u=0,l=o||[],d=!1,p={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return a=t,c=0,s=e,p.n=n,i}};function m(n,r){for(c=n,s=r,t=0;!d&&u&&!o&&t<l.length;t++){var o,a=l[t],m=p.p,y=a[2];n>3?(o=y===r)&&(s=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=m&&((o=n<2&&m<a[1])?(c=0,p.v=r,p.n=a[1]):m<y&&(o=n<3||a[0]>r||r>y)&&(a[4]=n,a[5]=r,p.n=y,c=0))}if(o||n>1)return i;throw d=!0,r}return function(o,l,y){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&m(l,y),c=l,s=y;(t=c<2?e:s)||!d;){a||(c?c<3?(c>1&&(p.n=-1),m(c,s)):p.n=s:p.v=s);try{if(u=2,a){if(c||(o="next"),t=a[o]){if(!(t=t.call(a,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,c<2&&(c=0)}else 1===c&&(t=a.return)&&t.call(a),c<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=e}else if((t=(d=p.n<0)?s:n.call(r,p))!==i)break}catch(t){a=e,c=1,s=t}finally{u=1}}return{value:t,done:d}}}(n,o,a),!0),u}var i={};function c(){}function s(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(y(t={},r,function(){return this}),t),d=u.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,y(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return s.prototype=u,y(d,"constructor",u),y(u,"constructor",s),s.displayName="GeneratorFunction",y(u,o,"GeneratorFunction"),y(d),y(d,o,"Generator"),y(d,r,function(){return this}),y(d,"toString",function(){return"[object Generator]"}),(m=function(){return{w:a,m:p}})()}function y(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}y=function(e,t,n,r){function a(t,n){y(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},y(e,t,n,r)}function f(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function v(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){f(a,r,o,i,c,"next",e)}function c(e){f(a,r,o,i,c,"throw",e)}i(void 0)})}}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,b(r.key),r)}}function g(e,t,n){return(t=b(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e){var t=function(e){if("object"!=l(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==l(t)?t:t+""}var k="octagon_api_key",A="CachedSessionSettings",E=function(){return e=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"https://api-gateway.octagonagents.com/v1";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),g(this,"apiKey",null),g(this,"isOfficeInitialized",!1),this.apiUrl=t,c("OctagonApiService created with API URL: ".concat(this.apiUrl))},t=[{key:"initialize",value:function(){this.isOfficeInitialized=!0,this.loadApiKey(),c("OctagonApiService fully initialized. API key status: ".concat(this.isAuthenticated()?"Available":"Not available"))}},{key:"checkForStoredApiKey",value:function(){try{var e=sessionStorage.getItem(A);if(e){var t=JSON.parse(e);if(t&&t.octagon_api_key)return c("Found API key in CachedSessionSettings"),!0}if(sessionStorage.getItem(k))return c("Found API key in direct SessionStorage"),!0}catch(e){u("Error checking for stored API key",e)}return!1}},{key:"setApiKey",value:function(e){this.apiKey=e,this.saveApiKey(e)}},{key:"saveApiKey",value:function(e){try{sessionStorage.setItem(k,e);try{var t=sessionStorage.getItem(A);if(t){var n=JSON.parse(t);n.octagon_api_key=e,sessionStorage.setItem(A,JSON.stringify(n))}else{var r={octagon_api_key:e};sessionStorage.setItem(A,JSON.stringify(r))}}catch(e){s("Failed to save to CachedSessionSettings",e)}c("API key saved to SessionStorage")}catch(e){u("Failed to save API key to SessionStorage",e)}}},{key:"callAgent",value:(l=v(m().m(function e(t,n){var r,o;return m().w(function(e){for(;;)switch(e.n){case 0:return c("callAgent invoked with agent: ".concat(t,", prompt: ").concat(n.substring(0,50),"...")),i("callAgent request data:",r={model:t,input:n,stream:!0}),e.n=1,this.apiRequest("/responses","POST",r,!0);case 1:if((o=e.v).success){e.n=2;break}return e.a(2,o);case 2:return e.a(2,o)}},e,this)})),function(e,t){return l.apply(this,arguments)})},{key:"loadApiKey",value:function(){c("Attempting to load API key from SessionStorage");try{var e=sessionStorage.getItem(A);if(e)try{var t=JSON.parse(e);if(t&&t.octagon_api_key)return this.apiKey=t.octagon_api_key,void c("API key loaded from CachedSessionSettings")}catch(e){s("Failed to parse CachedSessionSettings",e)}var n=sessionStorage.getItem(k);if(n)return this.apiKey=n,void c("API key loaded from direct SessionStorage")}catch(e){u("Failed to load API key from SessionStorage",e)}c("No API key found in SessionStorage")}},{key:"isAuthenticated",value:function(){return this.apiKey||this.loadApiKey(),!!this.apiKey&&""!==this.apiKey.trim()}},{key:"clearApiKey",value:function(){this.apiKey=null;try{sessionStorage.removeItem(k);var e=sessionStorage.getItem(A);if(e)try{var t=JSON.parse(e);t&&(delete t.octagon_api_key,sessionStorage.setItem(A,JSON.stringify(t)))}catch(e){s("Failed to parse CachedSessionSettings for clearing",e)}c("API key cleared from all SessionStorage locations")}catch(e){u("Failed to clear API key from SessionStorage",e)}}},{key:"apiRequest",value:(a=v(m().m(function e(t){var n,r,o,a,s,l,d,p,y,f=arguments;return m().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=f.length>1&&void 0!==f[1]?f[1]:"POST",r=f.length>2?f[2]:void 0,this.isAuthenticated()){e.n=1;break}return u("API request failed: Not authenticated"),e.a(2,{success:!1,error:"Not authenticated. Please set your API key first."});case 1:return o="".concat(this.apiUrl).concat(t),e.p=2,c("Making ".concat(n," request to ").concat(o),r),a=new Headers({"Content-Type":"application/json",Authorization:"Bearer ".concat(this.apiKey)}),i("Request headers:",{contentType:a.get("Content-Type"),authorization:this.apiKey?"Bearer ".concat(this.apiKey.substring(0,5),"..."):"None"}),s=r?JSON.stringify(r):void 0,i("Request body:",s),e.n=3,fetch(o,{method:n,headers:a,body:s});case 3:if(l=e.v,c("Response status: ".concat(l.status," ").concat(l.statusText)),l.ok){e.n=5;break}return e.n=4,l.text();case 4:return d=e.v,u("API request failed: ".concat(l.status," ").concat(l.statusText),d),e.a(2,{success:!1,error:"Request failed (".concat(l.status,"): ").concat(d||l.statusText)});case 5:return e.n=6,this.handleStreamedResponse(l);case 6:return p=e.v,e.a(2,p);case 7:return e.p=7,y=e.v,u("API request failed with exception",y),e.a(2,{success:!1,error:y instanceof Error?y.message:"Unknown error occurred"})}},e,this,[[2,7]])})),function(e){return a.apply(this,arguments)})},{key:"handleStreamedResponse",value:(o=v(m().m(function e(t){var n,r,o,a,l,p,y,f,v,h,g,b,k,A,E,I,S,O,C,T,P,w,x,N,B;return m().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,p=null===(n=t.body)||void 0===n?void 0:n.getReader()){e.n=1;break}return u("Response stream could not be read"),e.a(2,{success:!1,error:"Response stream could not be read"});case 1:c("Processing streamed response"),y="",f=null,v=0;case 2:return e.p=3,e.n=4,p.read();case 4:if(h=e.v,g=h.done,b=h.value,!g){e.n=5;break}return e.a(3,17);case 5:k=(new TextDecoder).decode(b),i("Received stream chunk:",k.substring(0,100)+(k.length>100?"...":"")),A=k.split("\n"),E=d(A),e.p=6,E.s();case 7:if((I=E.n()).done){e.n=11;break}if(!(S=I.value).startsWith("data: ")){e.n=10;break}if("[DONE]"!==(O=S.substring(6)).trim()){e.n=8;break}return c("Stream completed [DONE] marker received"),e.a(3,10);case 8:e.p=8,T=JSON.parse(O),i("Parsed stream data type:",T.type),"response.completed"===T.type?(f=T.response,c("Final response received")):"response.output_text.delta"===T.type||"response.output_text.done"===T.type?T.delta?y+=T.delta:T.text&&(y=T.text):"response.content_part.done"===T.type&&null!==(C=T.part)&&void 0!==C&&C.text?y=T.part.text:T.response&&T.response.output&&(f=T.response),e.n=10;break;case 9:if(e.p=9,w=e.v,v++,s("Error parsing stream JSON (".concat(v,"): ").concat(w," - ").concat(O.substring(0,100))),!(v>5)){e.n=10;break}throw u("Too many JSON parse errors in stream, aborting"),new Error("Stream parsing failed: Too many JSON parse errors");case 10:e.n=7;break;case 11:e.n=13;break;case 12:e.p=12,x=e.v,E.e(x);case 13:return e.p=13,E.f(),e.f(13);case 14:e.n=16;break;case 15:throw e.p=15,N=e.v,u("Error processing stream chunk:",N),N;case 16:e.n=2;break;case 17:return P={content:y||"",id:(null===(r=f)||void 0===r?void 0:r.id)||"",model:(null===(o=f)||void 0===o?void 0:o.model)||"",created:(null===(a=f)||void 0===a?void 0:a.created_at)||Date.now(),output:(null===(l=f)||void 0===l?void 0:l.output)||[],rawResponse:f},c("Streamed response processed successfully"),i("Transformed response:",{contentLength:P.content.length,hasId:!!P.id,hasModel:!!P.model,outputItems:P.output.length}),e.a(2,{success:!0,data:P});case 18:return e.p=18,B=e.v,u("Error processing streamed response:",B),e.a(2,{success:!1,error:B instanceof Error?B.message:"Failed to process streamed response"})}},e,null,[[8,9],[6,12,13,14],[3,15],[0,18]])})),function(e){return o.apply(this,arguments)})},{key:"testConnection",value:(r=v(m().m(function e(){var t,n;return m().w(function(e){for(;;)switch(e.p=e.n){case 0:if(c("Testing API connection with stored key"),this.isAuthenticated()){e.n=1;break}return u("Test connection failed: No API key available"),e.a(2,{success:!1,error:"No API key available for testing"});case 1:return e.p=1,e.n=2,this.apiRequest("/responses","POST",{model:"octagon-agent",input:"Test connection",max_tokens:10},!0);case 2:return t=e.v,c("Test connection result: ".concat(t.success?"Success":"Failed")),t.success&&i("Test connection response format:",{hasContent:t.data&&void 0!==t.data.content,hasChoices:t.data&&Array.isArray(t.data.choices),responseKeys:t.data?Object.keys(t.data):[]}),e.a(2,t);case 3:return e.p=3,n=e.v,u("Test connection threw an exception",n),e.a(2,{success:!1,error:n instanceof Error?n.message:"Unknown error during connection test"})}},e,this,[[1,3]])})),function(){return r.apply(this,arguments)})},{key:"ResponseEndpoint",value:(n=v(m().m(function e(t,n){var r,o=arguments;return m().w(function(e){for(;;)if(0===e.n)return r=!(o.length>2&&void 0!==o[2])||o[2],c("Making stream responses endpoint request",{query:t.substring(0,100)+"...",model:n,stream:r}),e.a(2,this.apiRequest("/responses","POST",{model:n,input:t,stream:r},r))},e,this)})),function(e,t){return n.apply(this,arguments)})}],t&&h(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,o,a,l}(),I=new E,S=[{id:"octagon-agent",displayName:"Octagon Agent",excelFormulaName:"OCTAGON.OCTAGON_AGENT",description:"Public and Private market intelligence agent that optimally routes requests to appropriate specialized agents",category:function(e){return e.MarketIntelligence="Market Intelligence",e.DeepResearch="Deep Research",e}({}).MarketIntelligence,usageExamples:[{topic:"Financial Metrics Analysis",prompt:'=OCTAGON.OCTAGON_AGENT("Retrieve year-over-year growth in key income-statement items for AAPL, limited to 5 records and filtered by period FY.")'},{topic:"SEC Filing Analysis",prompt:'=OCTAGON.OCTAGON_AGENT("Analyze the latest 10-K filing for AAPL and extract key financial metrics and risk factors.")'},{topic:"Stock Performance",prompt:'=OCTAGON.OCTAGON_AGENT("Retrieve the daily closing prices for AAPL over the last 30 days.")'},{topic:"Earnings Call Insights",prompt:'=OCTAGON.OCTAGON_AGENT("Analyze AAPL\'s latest earnings call transcript and extract key insights about future guidance.")'},{topic:"Company Overview",prompt:'=OCTAGON.OCTAGON_AGENT("Provide a comprehensive overview of Stripe, including its business model and key metrics.")'},{topic:"Funding History",prompt:'=OCTAGON.OCTAGON_AGENT("Retrieve the funding history for Stripe, including all rounds and investors.")'},{topic:"M&A Activity",prompt:'=OCTAGON.OCTAGON_AGENT("List all M&A transactions involving Stripe in the last 2 years.")'},{topic:"Investor Profile",prompt:'=OCTAGON.OCTAGON_AGENT("Provide a detailed profile of Sequoia Capital\'s investment strategy and portfolio.")'},{topic:"Debt Analysis",prompt:'=OCTAGON.OCTAGON_AGENT("Analyze Stripe\'s debt financing history and current debt structure.")'},{topic:"Institutional Holdings",prompt:'=OCTAGON.OCTAGON_AGENT("Retrieve the most recent Form 13F and related filings submitted by institutional investors.")'}]}];function O(){try{var e=window.navigator.userAgent,t=e.indexOf("MSIE "),n=e.indexOf("Trident/");return t>0||n>0}catch(e){return u("Error detecting browser:",e),!1}}function C(){var e=[];try{Office.context.requirements.isSetSupported("SharedRuntime","1.1")||e.push("This add-in requires SharedRuntime support. Please update to a newer version of Office."),Office.context.requirements.isSetSupported("ExcelApi","1.7")||e.push("Some Excel features require Excel API 1.7 or later. Please update to a newer version of Excel."),Office.context.requirements.isSetSupported("CustomFunctions","1.1")||e.push("Custom functions require Excel support for CustomFunctions 1.1 or later."),function(e){try{var t=Office.context.platform,n=Office.context.host;c("Running on platform: ".concat(t,", host: ").concat(n)),t===Office.PlatformType.PC||t===Office.PlatformType.Mac||t===Office.PlatformType.OfficeOnline&&e.push("Excel Online may have limitations with long-running functions. Consider using Excel desktop for complex operations."),n!==Office.HostType.Excel&&e.push("This add-in is designed for Excel and may not function correctly in other Office applications.")}catch(e){u("Error detecting platform:",e)}}(e)}catch(t){u("Error checking API support:",t),e.push("Error checking API compatibility. Some features may not work as expected.")}return e}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function P(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var s=r&&r.prototype instanceof c?r:c,u=Object.create(s.prototype);return w(u,"_invoke",function(n,r,o){var a,c,s,u=0,l=o||[],d=!1,p={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return a=t,c=0,s=e,p.n=n,i}};function m(n,r){for(c=n,s=r,t=0;!d&&u&&!o&&t<l.length;t++){var o,a=l[t],m=p.p,y=a[2];n>3?(o=y===r)&&(s=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=m&&((o=n<2&&m<a[1])?(c=0,p.v=r,p.n=a[1]):m<y&&(o=n<3||a[0]>r||r>y)&&(a[4]=n,a[5]=r,p.n=y,c=0))}if(o||n>1)return i;throw d=!0,r}return function(o,l,y){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&m(l,y),c=l,s=y;(t=c<2?e:s)||!d;){a||(c?c<3?(c>1&&(p.n=-1),m(c,s)):p.n=s:p.v=s);try{if(u=2,a){if(c||(o="next"),t=a[o]){if(!(t=t.call(a,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,c<2&&(c=0)}else 1===c&&(t=a.return)&&t.call(a),c<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=e}else if((t=(d=p.n<0)?s:n.call(r,p))!==i)break}catch(t){a=e,c=1,s=t}finally{u=1}}return{value:t,done:d}}}(n,o,a),!0),u}var i={};function c(){}function s(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(w(t={},r,function(){return this}),t),d=u.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,w(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return s.prototype=u,w(d,"constructor",u),w(u,"constructor",s),s.displayName="GeneratorFunction",w(u,o,"GeneratorFunction"),w(d),w(d,o,"Generator"),w(d,r,function(){return this}),w(d,"toString",function(){return"[object Generator]"}),(P=function(){return{w:a,m:p}})()}function w(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}w=function(e,t,n,r){function a(t,n){w(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},w(e,t,n,r)}function x(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function N(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){x(a,r,o,i,c,"next",e)}function c(e){x(a,r,o,i,c,"throw",e)}i(void 0)})}}var B=I,R=!1,G=!1;function L(){var e=document.getElementById("submit-button");e&&e.addEventListener("click",j);var t=document.getElementById("test-connection-button");t&&t.addEventListener("click",q);var n=document.getElementById("clear-api-keys-button");n&&n.addEventListener("click",H);var r=document.getElementById("continue-to-menu-button");r&&r.addEventListener("click",$);var o=document.getElementById("api-key-input");o&&(o.addEventListener("keypress",function(e){"Enter"===e.key&&j()}),o.addEventListener("input",function(){_()})),_()}function _(){var e,t=document.getElementById("api-key-input"),n=document.getElementById("submit-button"),r=document.getElementById("test-connection-button"),o=(null==t||null===(e=t.value)||void 0===e?void 0:e.trim().length)>0;n&&(o?n.removeAttribute("disabled"):n.setAttribute("disabled","true")),r&&(o?r.removeAttribute("disabled"):r.setAttribute("disabled","true"))}function K(){var e=document.getElementById("auth-view"),t=document.getElementById("agents-view");e&&t&&(e.style.display="block",e.classList.add("fade-in"),t.style.display="none"),R||(R=!0,setTimeout(function(){!function(){var e=B.checkForStoredApiKey(),t=document.getElementById("api-key-status-message"),n=document.getElementById("continue-to-menu-container"),r=document.getElementById("api-key-input-container"),o=document.getElementById("clear-api-keys-button"),a=document.querySelector(".auth-container h3.ms-font-l"),i=document.querySelector(".auth-container p.ms-font-m");if(e){if(c("API Key detected from previous sessions"),t&&(t.style.display="none"),a&&(a.textContent="API Key Detected"),i&&(i.textContent="Your API key has been detected. You can proceed to the main menu or verify your connection."),n){n.style.display="flex",n.innerHTML="";var s=document.createElement("button");s.id="continue-to-menu-button",s.className="ms-Button ms-Button--icon continue-to-menu-button",s.innerHTML='\n        <span class="ms-Button-label">Main Menu</span>\n        <span class="ms-Button-icon">\n          <i class="ms-Icon ms-Icon--ChevronRight"></i>\n        </span>\n      ',s.addEventListener("click",$),n.appendChild(s)}r&&(r.style.display="none"),o&&(o.style.display="inline-block"),M(!0),G||(G=!0,setTimeout(function(){$()},1e3))}else t&&(t.textContent="No API Key detected. Please provide an API Key to continue.",t.style.display="block"),a&&(a.textContent="Authentication Required"),i&&(i.textContent="Please enter your Octagon API key to continue:"),n&&(n.style.display="none"),r&&(r.style.display="block"),o&&(o.style.display="none"),M(!1)}(),R=!1},0))}function M(e){var t=document.getElementById("submit-button"),n=document.getElementById("test-connection-button");t&&(t.style.display=e?"none":"inline-block"),n&&(n.innerHTML='<span class="ms-Button-label">Test Connection</span>')}function j(){try{var e,t=document.getElementById("api-key-input"),n=null==t||null===(e=t.value)||void 0===e?void 0:e.trim();if(!n)return void z("Please enter an API Key.");B.setApiKey(n),W(),J("API Key saved successfully!");var r=document.querySelector(".auth-container h3.ms-font-l"),o=document.querySelector(".auth-container p.ms-font-m");r&&(r.textContent="API Key Detected"),o&&(o.textContent="Your API key has been saved. You can proceed to the main menu or verify your connection.");var a=document.getElementById("api-key-input-container");a&&(a.style.display="none");var i=document.getElementById("continue-to-menu-container");if(i){i.style.display="flex",i.innerHTML="";var c=document.createElement("button");c.id="continue-to-menu-button",c.className="ms-Button ms-Button--icon continue-to-menu-button",c.innerHTML='\n        <span class="ms-Button-label">Main Menu</span>\n        <span class="ms-Button-icon">\n          <i class="ms-Icon ms-Icon--ChevronRight"></i>\n        </span>\n      ',c.addEventListener("click",$),i.appendChild(c)}var s=document.getElementById("api-key-status-message");s&&(s.style.display="none");var l=document.getElementById("clear-api-keys-button");l&&(l.style.display="inline-block"),M(!0),setTimeout(function(){$()},800)}catch(e){z("An error occurred while saving the API key. Please try again."),u("Error saving API key:",e)}}function q(){return F.apply(this,arguments)}function F(){return(F=N(P().m(function e(){var t,n,r,o,a,i,c,s,l,d,p,m,y,f,v;return P().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,n=document.getElementById("api-key-input"),r=null==n||null===(t=n.value)||void 0===t?void 0:t.trim(),n&&"none"!==n.style.display&&r){e.n=2;break}if(B.checkForStoredApiKey()){e.n=1;break}return z("No API Key available. Please enter an API Key."),e.a(2);case 1:e.n=3;break;case 2:B.setApiKey(r);case 3:return Y(!0),e.n=4,U();case 4:o=e.v,Y(!1),o?(W(),J("Connection successful! API Key verified."),a=document.querySelector(".auth-container h3.ms-font-l"),i=document.querySelector(".auth-container p.ms-font-m"),a&&(a.textContent="API Key Detected"),i&&(i.textContent="Your API key has been detected. You can proceed to the main menu or verify your connection."),(c=document.getElementById("api-key-input-container"))&&(c.style.display="none"),(s=document.getElementById("continue-to-menu-container"))&&(s.style.display="flex",s.innerHTML="",(l=document.createElement("button")).id="continue-to-menu-button",l.className="ms-Button ms-Button--icon continue-to-menu-button",l.innerHTML='\n          <span class="ms-Button-label">Main Menu</span>\n          <span class="ms-Button-icon">\n            <i class="ms-Icon ms-Icon--ChevronRight"></i>\n          </span>\n        ',l.addEventListener("click",$),s.appendChild(l)),(d=document.getElementById("api-key-status-message"))&&(d.style.display="none"),(p=document.getElementById("clear-api-keys-button"))&&(p.style.display="inline-block"),M(!0),setTimeout(function(){$()},1e3)):(z("Invalid API key. Please check and try again."),B.clearApiKey(),m=document.querySelector(".auth-container h3.ms-font-l"),y=document.querySelector(".auth-container p.ms-font-m"),m&&(m.textContent="Authentication Required"),y&&(y.textContent="Please enter your Octagon API key to continue:"),(f=document.getElementById("api-key-input-container"))&&(f.style.display="block"),M(!1)),e.n=6;break;case 5:e.p=5,v=e.v,Y(!1),z("An error occurred. Please try again."),u("Authentication error:",v);case 6:return e.a(2)}},e,null,[[0,5]])}))).apply(this,arguments)}function H(){B.clearApiKey(),G=!1;var e=document.getElementById("api-key-input");e&&(e.value="");var t=document.querySelector(".auth-container h3.ms-font-l"),n=document.querySelector(".auth-container p.ms-font-m");t&&(t.textContent="Authentication Required"),n&&(n.textContent="Please enter your Octagon API key to continue:");var r=document.getElementById("api-key-input-container");r&&(r.style.display="block");var o=document.getElementById("continue-to-menu-container");o&&(o.style.display="none");var a=document.getElementById("clear-api-keys-button");a&&(a.style.display="none");var i=document.getElementById("api-key-status-message");i&&(i.textContent="Stored API Key has been cleared. Please provide a new API Key to continue.",i.style.display="block"),M(!1),_(),c("API Key cleared")}function U(){return D.apply(this,arguments)}function D(){return(D=N(P().m(function e(){var t,n;return P().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,c("Testing API connection"),e.n=1,B.testConnection();case 1:return t=e.v,c("API test response: ".concat(JSON.stringify(t))),e.a(2,t.success);case 2:return e.p=2,n=e.v,u("API test connection error:",n),e.a(2,!1)}},e,null,[[0,2]])}))).apply(this,arguments)}function z(e){var t=document.getElementById("auth-error");t&&(t.textContent=e,t.style.display="block")}function J(e){var t=document.getElementById("auth-error");t&&(t.textContent=e,t.style.color="green",t.style.display="block",setTimeout(function(){W()},3e3))}function W(){var e=document.getElementById("auth-error");e&&(e.textContent="",e.style.display="none",e.style.color="#a80000")}function Y(e){var t=document.getElementById("submit-button"),n=document.getElementById("test-connection-button"),r=document.getElementById("auth-spinner");r&&(e?(t&&t.setAttribute("disabled","true"),n&&n.setAttribute("disabled","true"),r.style.display="block"):(t&&t.removeAttribute("disabled"),n&&n.removeAttribute("disabled"),r.style.display="none"))}function $(){var e=document.getElementById("auth-view"),t=document.getElementById("agents-view");if(e&&t){e.style.display="none",t.style.display="block",t.classList.add("fade-in");var n=document.getElementById("back-to-auth-button-header");n&&(n.style.display="none"),function(){var e=document.getElementById("agent-categories-container");if(e){e.innerHTML="";for(var t=function(){var e={};return S.forEach(function(t){e[t.category]||(e[t.category]=[]),e[t.category].push(t)}),e}(),n=function(){var t,n,a=(t=o[r],n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],s=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);s=!0);}catch(e){u=!0,o=e}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(t,n)||function(e,t){if(e){if("string"==typeof e)return T(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?T(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=a[0],c=a[1],s=document.createElement("div");s.className="agent-category";var u=document.createElement("h3");u.className="category-title",u.textContent=i,s.appendChild(u),c.forEach(function(e){var t=function(e){var t=document.createElement("div");t.className="agent-card";var n=document.createElement("h4");n.className="agent-title",n.textContent=e.displayName,t.appendChild(n);var r=document.createElement("p");r.className="agent-description",r.textContent=e.description,t.appendChild(r);var o=document.createElement("div");o.className="agent-meta";var a=document.createElement("div");if(a.innerHTML='<strong>Excel Formula:</strong> <span class="formula-name">'.concat(e.excelFormulaName,'("your prompt")</span>'),o.appendChild(a),e.examplePrompt){var i=document.createElement("div");i.innerHTML="<strong>Example:</strong>";var c=document.createElement("div");c.style.position="relative",c.style.display="inline-block",c.style.width="100%";var s=document.createElement("span");s.className="example-prompt",s.textContent=e.examplePrompt,c.appendChild(s);var u=document.createElement("button");u.className="copy-button",u.title="Copy example",u.innerHTML='<i class="ms-Icon ms-Icon--Copy"></i>',u.onclick=function(t){t.stopPropagation(),navigator.clipboard.writeText(e.examplePrompt).then(function(){u.innerHTML='<i class="ms-Icon ms-Icon--CheckMark copy-success"></i>',setTimeout(function(){u.innerHTML='<i class="ms-Icon ms-Icon--Copy"></i>'},1500)}).catch(function(e){console.error("Could not copy text: ",e)})},c.appendChild(u),i.appendChild(c),o.appendChild(i)}if(t.appendChild(o),e.usageExamples&&e.usageExamples.length>0){var l=document.createElement("div");l.className="usage-examples-section";var d=document.createElement("h5");d.className="usage-heading",d.textContent="Usage Examples:",l.appendChild(d);var p=document.createElement("div");p.className="examples-list",e.usageExamples.forEach(function(e){var t=document.createElement("div");t.className="example-item";var n=document.createElement("div");n.className="example-topic",n.textContent=e.topic,t.appendChild(n);var r=document.createElement("div");r.className="example-prompt-container",r.style.position="relative";var o=document.createElement("div");o.className="example-prompt code",o.textContent=e.prompt,r.appendChild(o);var a=document.createElement("button");a.className="copy-button",a.title="Copy example",a.innerHTML='<i class="ms-Icon ms-Icon--Copy"></i>',a.onclick=function(t){t.stopPropagation(),navigator.clipboard.writeText(e.prompt).then(function(){a.innerHTML='<i class="ms-Icon ms-Icon--CheckMark copy-success"></i>',setTimeout(function(){a.innerHTML='<i class="ms-Icon ms-Icon--Copy"></i>'},1500)}).catch(function(e){console.error("Could not copy text: ",e)})},r.appendChild(a),t.appendChild(r),p.appendChild(t)}),l.appendChild(p),t.appendChild(l)}return t}(e);s.appendChild(t)}),e.appendChild(s)},r=0,o=Object.entries(t);r<o.length;r++)n();var a=document.createElement("div");a.className="back-button-container";var i=document.createElement("button");i.id="back-to-auth-button",i.className="ms-Button ms-Button--icon back-to-login-button",i.innerHTML='\n    <span class="ms-Button-icon">\n      <i class="ms-Icon ms-Icon--ChevronLeft"></i>\n    </span>\n    <span class="ms-Button-label">Back to Log In</span>\n  ',i.addEventListener("click",K),a.appendChild(i),e.appendChild(a)}}()}}function Q(e){var t=document.createElement("div");t.className="browser-warning",t.innerHTML='\n    <div class="warning-icon"><i class="ms-Icon ms-Icon--Warning"></i></div>\n    <div class="warning-message">'.concat(e,"</div>\n  ");var n=document.querySelector(".content-container")||document.body;n.insertBefore(t,n.firstChild)}function V(e){var t=document.createElement("div");t.className="api-support-warning";var n='\n    <div class="warning-icon"><i class="ms-Icon ms-Icon--Warning"></i></div>\n    <div class="warning-message">\n      <p>Some features may not work correctly in your current environment:</p>\n      <ul>\n  ';e.forEach(function(e){n+="<li>".concat(e,"</li>")}),n+="\n      </ul>\n    </div>\n  ",t.innerHTML=n;var r=document.querySelector(".content-container")||document.body,o=document.querySelector(".browser-warning");o?r.insertBefore(t,o.nextSibling):r.insertBefore(t,r.firstChild)}Office.onReady(function(){var e=N(P().m(function e(t){var n;return P().w(function(e){for(;;)switch(e.n){case 0:try{c("Office is ready - initializing Octagon taskpane"),B.initialize(),document.getElementById("sideload-msg").style.display="none",L(),K(),O()&&Q("Internet Explorer is not fully supported. For the best experience, please use Microsoft Edge, Chrome, or another modern browser."),(n=C()).length>0&&V(n),c("Taskpane initialized")}catch(e){u("Error during taskpane initialization:",e)}case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}())}(),new URL(n(58394),n.b),new URL(n(35132),n.b)}();
//# sourceMappingURL=taskpane.js.map